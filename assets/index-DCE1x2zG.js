(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function kS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xw={exports:{}},Ah={},Ew={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hl=Symbol.for("react.element"),bS=Symbol.for("react.portal"),AS=Symbol.for("react.fragment"),RS=Symbol.for("react.strict_mode"),PS=Symbol.for("react.profiler"),CS=Symbol.for("react.provider"),NS=Symbol.for("react.context"),DS=Symbol.for("react.forward_ref"),VS=Symbol.for("react.suspense"),MS=Symbol.for("react.memo"),OS=Symbol.for("react.lazy"),B0=Symbol.iterator;function LS(t){return t===null||typeof t!="object"?null:(t=B0&&t[B0]||t["@@iterator"],typeof t=="function"?t:null)}var Iw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Tw=Object.assign,Sw={};function ia(t,e,n){this.props=t,this.context=e,this.refs=Sw,this.updater=n||Iw}ia.prototype.isReactComponent={};ia.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ia.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kw(){}kw.prototype=ia.prototype;function sm(t,e,n){this.props=t,this.context=e,this.refs=Sw,this.updater=n||Iw}var om=sm.prototype=new kw;om.constructor=sm;Tw(om,ia.prototype);om.isPureReactComponent=!0;var $0=Array.isArray,bw=Object.prototype.hasOwnProperty,am={current:null},Aw={key:!0,ref:!0,__self:!0,__source:!0};function Rw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)bw.call(e,r)&&!Aw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Hl,type:t,key:s,ref:o,props:i,_owner:am.current}}function FS(t,e){return{$$typeof:Hl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hl}function jS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var q0=/\/+/g;function Td(t,e){return typeof t=="object"&&t!==null&&t.key!=null?jS(""+t.key):e.toString(36)}function tc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Hl:case bS:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Td(o,0):r,$0(i)?(n="",t!=null&&(n=t.replace(q0,"$&/")+"/"),tc(i,e,n,"",function(c){return c})):i!=null&&(lm(i)&&(i=FS(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(q0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",$0(t))for(var a=0;a<t.length;a++){s=t[a];var u=r+Td(s,a);o+=tc(s,e,n,u,i)}else if(u=LS(t),typeof u=="function")for(t=u.call(t),a=0;!(s=t.next()).done;)s=s.value,u=r+Td(s,a++),o+=tc(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ku(t,e,n){if(t==null)return t;var r=[],i=0;return tc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function zS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dn={current:null},nc={transition:null},US={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:nc,ReactCurrentOwner:am};function Pw(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:ku,forEach:function(t,e,n){ku(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ku(t,function(){e++}),e},toArray:function(t){return ku(t,function(e){return e})||[]},only:function(t){if(!lm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ae.Component=ia;Ae.Fragment=AS;Ae.Profiler=PS;Ae.PureComponent=sm;Ae.StrictMode=RS;Ae.Suspense=VS;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=US;Ae.act=Pw;Ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Tw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=am.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(u in e)bw.call(e,u)&&!Aw.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Hl,type:t.type,key:i,ref:s,props:r,_owner:o}};Ae.createContext=function(t){return t={$$typeof:NS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:CS,_context:t},t.Consumer=t};Ae.createElement=Rw;Ae.createFactory=function(t){var e=Rw.bind(null,t);return e.type=t,e};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(t){return{$$typeof:DS,render:t}};Ae.isValidElement=lm;Ae.lazy=function(t){return{$$typeof:OS,_payload:{_status:-1,_result:t},_init:zS}};Ae.memo=function(t,e){return{$$typeof:MS,type:t,compare:e===void 0?null:e}};Ae.startTransition=function(t){var e=nc.transition;nc.transition={};try{t()}finally{nc.transition=e}};Ae.unstable_act=Pw;Ae.useCallback=function(t,e){return dn.current.useCallback(t,e)};Ae.useContext=function(t){return dn.current.useContext(t)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(t){return dn.current.useDeferredValue(t)};Ae.useEffect=function(t,e){return dn.current.useEffect(t,e)};Ae.useId=function(){return dn.current.useId()};Ae.useImperativeHandle=function(t,e,n){return dn.current.useImperativeHandle(t,e,n)};Ae.useInsertionEffect=function(t,e){return dn.current.useInsertionEffect(t,e)};Ae.useLayoutEffect=function(t,e){return dn.current.useLayoutEffect(t,e)};Ae.useMemo=function(t,e){return dn.current.useMemo(t,e)};Ae.useReducer=function(t,e,n){return dn.current.useReducer(t,e,n)};Ae.useRef=function(t){return dn.current.useRef(t)};Ae.useState=function(t){return dn.current.useState(t)};Ae.useSyncExternalStore=function(t,e,n){return dn.current.useSyncExternalStore(t,e,n)};Ae.useTransition=function(){return dn.current.useTransition()};Ae.version="18.3.1";Ew.exports=Ae;var L=Ew.exports;const BS=kS(L);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $S=L,qS=Symbol.for("react.element"),GS=Symbol.for("react.fragment"),HS=Object.prototype.hasOwnProperty,KS=$S.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WS={key:!0,ref:!0,__self:!0,__source:!0};function Cw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)HS.call(e,r)&&!WS.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:qS,type:t,key:s,ref:o,props:i,_owner:KS.current}}Ah.Fragment=GS;Ah.jsx=Cw;Ah.jsxs=Cw;xw.exports=Ah;var v=xw.exports,If={},Nw={exports:{}},Vn={},Dw={exports:{}},Vw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,K){var W=B.length;B.push(K);e:for(;0<W;){var X=W-1>>>1,se=B[X];if(0<i(se,K))B[X]=K,B[W]=se,W=X;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var K=B[0],W=B.pop();if(W!==K){B[0]=W;e:for(var X=0,se=B.length,ye=se>>>1;X<ye;){var $=2*(X+1)-1,ne=B[$],de=$+1,ae=B[de];if(0>i(ne,W))de<se&&0>i(ae,ne)?(B[X]=ae,B[de]=W,X=de):(B[X]=ne,B[$]=W,X=$);else if(de<se&&0>i(ae,W))B[X]=ae,B[de]=W,X=de;else break e}}return K}function i(B,K){var W=B.sortIndex-K.sortIndex;return W!==0?W:B.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var u=[],c=[],h=1,f=null,m=3,g=!1,b=!1,I=!1,P=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(B){for(var K=n(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=B)r(c),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(c)}}function C(B){if(I=!1,T(B),!b)if(n(u)!==null)b=!0,H(F);else{var K=n(c);K!==null&&ee(C,K.startTime-B)}}function F(B,K){b=!1,I&&(I=!1,y(w),w=-1),g=!0;var W=m;try{for(T(K),f=n(u);f!==null&&(!(f.expirationTime>K)||B&&!R());){var X=f.callback;if(typeof X=="function"){f.callback=null,m=f.priorityLevel;var se=X(f.expirationTime<=K);K=t.unstable_now(),typeof se=="function"?f.callback=se:f===n(u)&&r(u),T(K)}else r(u);f=n(u)}if(f!==null)var ye=!0;else{var $=n(c);$!==null&&ee(C,$.startTime-K),ye=!1}return ye}finally{f=null,m=W,g=!1}}var j=!1,E=null,w=-1,k=5,A=-1;function R(){return!(t.unstable_now()-A<k)}function N(){if(E!==null){var B=t.unstable_now();A=B;var K=!0;try{K=E(!0,B)}finally{K?S():(j=!1,E=null)}}else j=!1}var S;if(typeof _=="function")S=function(){_(N)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Z=O.port2;O.port1.onmessage=N,S=function(){Z.postMessage(null)}}else S=function(){P(N,0)};function H(B){E=B,j||(j=!0,S())}function ee(B,K){w=P(function(){B(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){b||g||(b=!0,H(F))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(B){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var W=m;m=K;try{return B()}finally{m=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,K){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var W=m;m=B;try{return K()}finally{m=W}},t.unstable_scheduleCallback=function(B,K,W){var X=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?X+W:X):W=X,B){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=W+se,B={id:h++,callback:K,priorityLevel:B,startTime:W,expirationTime:se,sortIndex:-1},W>X?(B.sortIndex=W,e(c,B),n(u)===null&&B===n(c)&&(I?(y(w),w=-1):I=!0,ee(C,W-X))):(B.sortIndex=se,e(u,B),b||g||(b=!0,H(F))),B},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(B){var K=m;return function(){var W=m;m=K;try{return B.apply(this,arguments)}finally{m=W}}}})(Vw);Dw.exports=Vw;var QS=Dw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS=L,Cn=QS;function Y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mw=new Set,dl={};function Bs(t,e){Oo(t,e),Oo(t+"Capture",e)}function Oo(t,e){for(dl[t]=e,t=0;t<e.length;t++)Mw.add(e[t])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tf=Object.prototype.hasOwnProperty,XS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G0={},H0={};function JS(t){return Tf.call(H0,t)?!0:Tf.call(G0,t)?!1:XS.test(t)?H0[t]=!0:(G0[t]=!0,!1)}function ZS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ek(t,e,n,r){if(e===null||typeof e>"u"||ZS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ht[t]=new fn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ht[e]=new fn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ht[t]=new fn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ht[t]=new fn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ht[t]=new fn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ht[t]=new fn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ht[t]=new fn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ht[t]=new fn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ht[t]=new fn(t,5,!1,t.toLowerCase(),null,!1,!1)});var um=/[\-:]([a-z])/g;function cm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(um,cm);Ht[e]=new fn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(um,cm);Ht[e]=new fn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(um,cm);Ht[e]=new fn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ht[t]=new fn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ht[t]=new fn(t,1,!1,t.toLowerCase(),null,!0,!0)});function hm(t,e,n,r){var i=Ht.hasOwnProperty(e)?Ht[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ek(e,n,i,r)&&(n=null),r||i===null?JS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Jr=YS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bu=Symbol.for("react.element"),co=Symbol.for("react.portal"),ho=Symbol.for("react.fragment"),dm=Symbol.for("react.strict_mode"),Sf=Symbol.for("react.profiler"),Ow=Symbol.for("react.provider"),Lw=Symbol.for("react.context"),fm=Symbol.for("react.forward_ref"),kf=Symbol.for("react.suspense"),bf=Symbol.for("react.suspense_list"),pm=Symbol.for("react.memo"),ci=Symbol.for("react.lazy"),Fw=Symbol.for("react.offscreen"),K0=Symbol.iterator;function Ia(t){return t===null||typeof t!="object"?null:(t=K0&&t[K0]||t["@@iterator"],typeof t=="function"?t:null)}var ht=Object.assign,Sd;function Fa(t){if(Sd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Sd=e&&e[1]||""}return`
`+Sd+t}var kd=!1;function bd(t,e){if(!t||kd)return"";kd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=a);break}}}finally{kd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fa(t):""}function tk(t){switch(t.tag){case 5:return Fa(t.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return t=bd(t.type,!1),t;case 11:return t=bd(t.type.render,!1),t;case 1:return t=bd(t.type,!0),t;default:return""}}function Af(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ho:return"Fragment";case co:return"Portal";case Sf:return"Profiler";case dm:return"StrictMode";case kf:return"Suspense";case bf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Lw:return(t.displayName||"Context")+".Consumer";case Ow:return(t._context.displayName||"Context")+".Provider";case fm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pm:return e=t.displayName||null,e!==null?e:Af(t.type)||"Memo";case ci:e=t._payload,t=t._init;try{return Af(t(e))}catch{}}return null}function nk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Af(e);case 8:return e===dm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rk(t){var e=jw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Au(t){t._valueTracker||(t._valueTracker=rk(t))}function zw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=jw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Cc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Rf(t,e){var n=e.checked;return ht({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function W0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Mi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uw(t,e){e=e.checked,e!=null&&hm(t,"checked",e,!1)}function Pf(t,e){Uw(t,e);var n=Mi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Cf(t,e.type,n):e.hasOwnProperty("defaultValue")&&Cf(t,e.type,Mi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Q0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Cf(t,e,n){(e!=="number"||Cc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ja=Array.isArray;function To(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Mi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Nf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Y(91));return ht({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Y0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Y(92));if(ja(n)){if(1<n.length)throw Error(Y(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Mi(n)}}function Bw(t,e){var n=Mi(e.value),r=Mi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function X0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $w(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Df(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$w(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ru,qw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ru=Ru||document.createElement("div"),Ru.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ru.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ya={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ik=["Webkit","ms","Moz","O"];Object.keys(Ya).forEach(function(t){ik.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ya[e]=Ya[t]})});function Gw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ya.hasOwnProperty(t)&&Ya[t]?(""+e).trim():e+"px"}function Hw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Gw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var sk=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vf(t,e){if(e){if(sk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Y(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Y(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Y(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Y(62))}}function Mf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Of=null;function mm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Lf=null,So=null,ko=null;function J0(t){if(t=Ql(t)){if(typeof Lf!="function")throw Error(Y(280));var e=t.stateNode;e&&(e=Dh(e),Lf(t.stateNode,t.type,e))}}function Kw(t){So?ko?ko.push(t):ko=[t]:So=t}function Ww(){if(So){var t=So,e=ko;if(ko=So=null,J0(t),e)for(t=0;t<e.length;t++)J0(e[t])}}function Qw(t,e){return t(e)}function Yw(){}var Ad=!1;function Xw(t,e,n){if(Ad)return t(e,n);Ad=!0;try{return Qw(t,e,n)}finally{Ad=!1,(So!==null||ko!==null)&&(Yw(),Ww())}}function pl(t,e){var n=t.stateNode;if(n===null)return null;var r=Dh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Y(231,e,typeof n));return n}var Ff=!1;if(qr)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){Ff=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{Ff=!1}function ok(t,e,n,r,i,s,o,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(h){this.onError(h)}}var Xa=!1,Nc=null,Dc=!1,jf=null,ak={onError:function(t){Xa=!0,Nc=t}};function lk(t,e,n,r,i,s,o,a,u){Xa=!1,Nc=null,ok.apply(ak,arguments)}function uk(t,e,n,r,i,s,o,a,u){if(lk.apply(this,arguments),Xa){if(Xa){var c=Nc;Xa=!1,Nc=null}else throw Error(Y(198));Dc||(Dc=!0,jf=c)}}function $s(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Jw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Z0(t){if($s(t)!==t)throw Error(Y(188))}function ck(t){var e=t.alternate;if(!e){if(e=$s(t),e===null)throw Error(Y(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Z0(i),t;if(s===r)return Z0(i),e;s=s.sibling}throw Error(Y(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?t:e}function Zw(t){return t=ck(t),t!==null?e1(t):null}function e1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=e1(t);if(e!==null)return e;t=t.sibling}return null}var t1=Cn.unstable_scheduleCallback,ey=Cn.unstable_cancelCallback,hk=Cn.unstable_shouldYield,dk=Cn.unstable_requestPaint,Et=Cn.unstable_now,fk=Cn.unstable_getCurrentPriorityLevel,gm=Cn.unstable_ImmediatePriority,n1=Cn.unstable_UserBlockingPriority,Vc=Cn.unstable_NormalPriority,pk=Cn.unstable_LowPriority,r1=Cn.unstable_IdlePriority,Rh=null,fr=null;function mk(t){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(Rh,t,void 0,(t.current.flags&128)===128)}catch{}}var tr=Math.clz32?Math.clz32:vk,gk=Math.log,yk=Math.LN2;function vk(t){return t>>>=0,t===0?32:31-(gk(t)/yk|0)|0}var Pu=64,Cu=4194304;function za(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=za(a):(s&=o,s!==0&&(r=za(s)))}else o=n&~i,o!==0?r=za(o):s!==0&&(r=za(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-tr(e),i=1<<n,r|=t[n],e&=~i;return r}function _k(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-tr(s),a=1<<o,u=i[o];u===-1?(!(a&n)||a&r)&&(i[o]=_k(a,e)):u<=e&&(t.expiredLanes|=a),s&=~a}}function zf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function i1(){var t=Pu;return Pu<<=1,!(Pu&4194240)&&(Pu=64),t}function Rd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Kl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-tr(e),t[e]=n}function xk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-tr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function ym(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-tr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Be=0;function s1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var o1,vm,a1,l1,u1,Uf=!1,Nu=[],Ei=null,Ii=null,Ti=null,ml=new Map,gl=new Map,fi=[],Ek="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ty(t,e){switch(t){case"focusin":case"focusout":Ei=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":Ti=null;break;case"pointerover":case"pointerout":ml.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(e.pointerId)}}function Sa(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ql(e),e!==null&&vm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Ik(t,e,n,r,i){switch(e){case"focusin":return Ei=Sa(Ei,t,e,n,r,i),!0;case"dragenter":return Ii=Sa(Ii,t,e,n,r,i),!0;case"mouseover":return Ti=Sa(Ti,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ml.set(s,Sa(ml.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,gl.set(s,Sa(gl.get(s)||null,t,e,n,r,i)),!0}return!1}function c1(t){var e=ds(t.target);if(e!==null){var n=$s(e);if(n!==null){if(e=n.tag,e===13){if(e=Jw(n),e!==null){t.blockedOn=e,u1(t.priority,function(){a1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function rc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Bf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Of=r,n.target.dispatchEvent(r),Of=null}else return e=Ql(n),e!==null&&vm(e),t.blockedOn=n,!1;e.shift()}return!0}function ny(t,e,n){rc(t)&&n.delete(e)}function Tk(){Uf=!1,Ei!==null&&rc(Ei)&&(Ei=null),Ii!==null&&rc(Ii)&&(Ii=null),Ti!==null&&rc(Ti)&&(Ti=null),ml.forEach(ny),gl.forEach(ny)}function ka(t,e){t.blockedOn===e&&(t.blockedOn=null,Uf||(Uf=!0,Cn.unstable_scheduleCallback(Cn.unstable_NormalPriority,Tk)))}function yl(t){function e(i){return ka(i,t)}if(0<Nu.length){ka(Nu[0],t);for(var n=1;n<Nu.length;n++){var r=Nu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ei!==null&&ka(Ei,t),Ii!==null&&ka(Ii,t),Ti!==null&&ka(Ti,t),ml.forEach(e),gl.forEach(e),n=0;n<fi.length;n++)r=fi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<fi.length&&(n=fi[0],n.blockedOn===null);)c1(n),n.blockedOn===null&&fi.shift()}var bo=Jr.ReactCurrentBatchConfig,Oc=!0;function Sk(t,e,n,r){var i=Be,s=bo.transition;bo.transition=null;try{Be=1,_m(t,e,n,r)}finally{Be=i,bo.transition=s}}function kk(t,e,n,r){var i=Be,s=bo.transition;bo.transition=null;try{Be=4,_m(t,e,n,r)}finally{Be=i,bo.transition=s}}function _m(t,e,n,r){if(Oc){var i=Bf(t,e,n,r);if(i===null)jd(t,e,r,Lc,n),ty(t,r);else if(Ik(i,t,e,n,r))r.stopPropagation();else if(ty(t,r),e&4&&-1<Ek.indexOf(t)){for(;i!==null;){var s=Ql(i);if(s!==null&&o1(s),s=Bf(t,e,n,r),s===null&&jd(t,e,r,Lc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else jd(t,e,r,null,n)}}var Lc=null;function Bf(t,e,n,r){if(Lc=null,t=mm(r),t=ds(t),t!==null)if(e=$s(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Jw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Lc=t,null}function h1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fk()){case gm:return 1;case n1:return 4;case Vc:case pk:return 16;case r1:return 536870912;default:return 16}default:return 16}}var _i=null,wm=null,ic=null;function d1(){if(ic)return ic;var t,e=wm,n=e.length,r,i="value"in _i?_i.value:_i.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ic=i.slice(t,1<r?1-r:void 0)}function sc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Du(){return!0}function ry(){return!1}function Mn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Du:ry,this.isPropagationStopped=ry,this}return ht(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Du)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Du)},persist:function(){},isPersistent:Du}),e}var sa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xm=Mn(sa),Wl=ht({},sa,{view:0,detail:0}),bk=Mn(Wl),Pd,Cd,ba,Ph=ht({},Wl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Em,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ba&&(ba&&t.type==="mousemove"?(Pd=t.screenX-ba.screenX,Cd=t.screenY-ba.screenY):Cd=Pd=0,ba=t),Pd)},movementY:function(t){return"movementY"in t?t.movementY:Cd}}),iy=Mn(Ph),Ak=ht({},Ph,{dataTransfer:0}),Rk=Mn(Ak),Pk=ht({},Wl,{relatedTarget:0}),Nd=Mn(Pk),Ck=ht({},sa,{animationName:0,elapsedTime:0,pseudoElement:0}),Nk=Mn(Ck),Dk=ht({},sa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Vk=Mn(Dk),Mk=ht({},sa,{data:0}),sy=Mn(Mk),Ok={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Fk[t])?!!e[t]:!1}function Em(){return jk}var zk=ht({},Wl,{key:function(t){if(t.key){var e=Ok[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Lk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Em,charCode:function(t){return t.type==="keypress"?sc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Uk=Mn(zk),Bk=ht({},Ph,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oy=Mn(Bk),$k=ht({},Wl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Em}),qk=Mn($k),Gk=ht({},sa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hk=Mn(Gk),Kk=ht({},Ph,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Wk=Mn(Kk),Qk=[9,13,27,32],Im=qr&&"CompositionEvent"in window,Ja=null;qr&&"documentMode"in document&&(Ja=document.documentMode);var Yk=qr&&"TextEvent"in window&&!Ja,f1=qr&&(!Im||Ja&&8<Ja&&11>=Ja),ay=" ",ly=!1;function p1(t,e){switch(t){case"keyup":return Qk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function m1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fo=!1;function Xk(t,e){switch(t){case"compositionend":return m1(e);case"keypress":return e.which!==32?null:(ly=!0,ay);case"textInput":return t=e.data,t===ay&&ly?null:t;default:return null}}function Jk(t,e){if(fo)return t==="compositionend"||!Im&&p1(t,e)?(t=d1(),ic=wm=_i=null,fo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return f1&&e.locale!=="ko"?null:e.data;default:return null}}var Zk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Zk[t.type]:e==="textarea"}function g1(t,e,n,r){Kw(r),e=Fc(e,"onChange"),0<e.length&&(n=new xm("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Za=null,vl=null;function eb(t){b1(t,0)}function Ch(t){var e=go(t);if(zw(e))return t}function tb(t,e){if(t==="change")return e}var y1=!1;if(qr){var Dd;if(qr){var Vd="oninput"in document;if(!Vd){var cy=document.createElement("div");cy.setAttribute("oninput","return;"),Vd=typeof cy.oninput=="function"}Dd=Vd}else Dd=!1;y1=Dd&&(!document.documentMode||9<document.documentMode)}function hy(){Za&&(Za.detachEvent("onpropertychange",v1),vl=Za=null)}function v1(t){if(t.propertyName==="value"&&Ch(vl)){var e=[];g1(e,vl,t,mm(t)),Xw(eb,e)}}function nb(t,e,n){t==="focusin"?(hy(),Za=e,vl=n,Za.attachEvent("onpropertychange",v1)):t==="focusout"&&hy()}function rb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ch(vl)}function ib(t,e){if(t==="click")return Ch(e)}function sb(t,e){if(t==="input"||t==="change")return Ch(e)}function ob(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sr=typeof Object.is=="function"?Object.is:ob;function _l(t,e){if(sr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Tf.call(e,i)||!sr(t[i],e[i]))return!1}return!0}function dy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fy(t,e){var n=dy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dy(n)}}function _1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function w1(){for(var t=window,e=Cc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cc(t.document)}return e}function Tm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ab(t){var e=w1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_1(n.ownerDocument.documentElement,n)){if(r!==null&&Tm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=fy(n,s);var o=fy(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lb=qr&&"documentMode"in document&&11>=document.documentMode,po=null,$f=null,el=null,qf=!1;function py(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qf||po==null||po!==Cc(r)||(r=po,"selectionStart"in r&&Tm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),el&&_l(el,r)||(el=r,r=Fc($f,"onSelect"),0<r.length&&(e=new xm("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=po)))}function Vu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var mo={animationend:Vu("Animation","AnimationEnd"),animationiteration:Vu("Animation","AnimationIteration"),animationstart:Vu("Animation","AnimationStart"),transitionend:Vu("Transition","TransitionEnd")},Md={},x1={};qr&&(x1=document.createElement("div").style,"AnimationEvent"in window||(delete mo.animationend.animation,delete mo.animationiteration.animation,delete mo.animationstart.animation),"TransitionEvent"in window||delete mo.transitionend.transition);function Nh(t){if(Md[t])return Md[t];if(!mo[t])return t;var e=mo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in x1)return Md[t]=e[n];return t}var E1=Nh("animationend"),I1=Nh("animationiteration"),T1=Nh("animationstart"),S1=Nh("transitionend"),k1=new Map,my="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bi(t,e){k1.set(t,e),Bs(e,[t])}for(var Od=0;Od<my.length;Od++){var Ld=my[Od],ub=Ld.toLowerCase(),cb=Ld[0].toUpperCase()+Ld.slice(1);Bi(ub,"on"+cb)}Bi(E1,"onAnimationEnd");Bi(I1,"onAnimationIteration");Bi(T1,"onAnimationStart");Bi("dblclick","onDoubleClick");Bi("focusin","onFocus");Bi("focusout","onBlur");Bi(S1,"onTransitionEnd");Oo("onMouseEnter",["mouseout","mouseover"]);Oo("onMouseLeave",["mouseout","mouseover"]);Oo("onPointerEnter",["pointerout","pointerover"]);Oo("onPointerLeave",["pointerout","pointerover"]);Bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ua));function gy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,uk(r,e,void 0,t),t.currentTarget=null}function b1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==s&&i.isPropagationStopped())break e;gy(i,a,c),s=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,c=a.currentTarget,a=a.listener,u!==s&&i.isPropagationStopped())break e;gy(i,a,c),s=u}}}if(Dc)throw t=jf,Dc=!1,jf=null,t}function Ze(t,e){var n=e[Qf];n===void 0&&(n=e[Qf]=new Set);var r=t+"__bubble";n.has(r)||(A1(e,t,2,!1),n.add(r))}function Fd(t,e,n){var r=0;e&&(r|=4),A1(n,t,r,e)}var Mu="_reactListening"+Math.random().toString(36).slice(2);function wl(t){if(!t[Mu]){t[Mu]=!0,Mw.forEach(function(n){n!=="selectionchange"&&(hb.has(n)||Fd(n,!1,t),Fd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Mu]||(e[Mu]=!0,Fd("selectionchange",!1,e))}}function A1(t,e,n,r){switch(h1(e)){case 1:var i=Sk;break;case 4:i=kk;break;default:i=_m}n=i.bind(null,e,n,t),i=void 0,!Ff||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function jd(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ds(a),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Xw(function(){var c=s,h=mm(n),f=[];e:{var m=k1.get(t);if(m!==void 0){var g=xm,b=t;switch(t){case"keypress":if(sc(n)===0)break e;case"keydown":case"keyup":g=Uk;break;case"focusin":b="focus",g=Nd;break;case"focusout":b="blur",g=Nd;break;case"beforeblur":case"afterblur":g=Nd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=iy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Rk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=qk;break;case E1:case I1:case T1:g=Nk;break;case S1:g=Hk;break;case"scroll":g=bk;break;case"wheel":g=Wk;break;case"copy":case"cut":case"paste":g=Vk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=oy}var I=(e&4)!==0,P=!I&&t==="scroll",y=I?m!==null?m+"Capture":null:m;I=[];for(var _=c,T;_!==null;){T=_;var C=T.stateNode;if(T.tag===5&&C!==null&&(T=C,y!==null&&(C=pl(_,y),C!=null&&I.push(xl(_,C,T)))),P)break;_=_.return}0<I.length&&(m=new g(m,b,null,n,h),f.push({event:m,listeners:I}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==Of&&(b=n.relatedTarget||n.fromElement)&&(ds(b)||b[Gr]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=c,b=b?ds(b):null,b!==null&&(P=$s(b),b!==P||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=c),g!==b)){if(I=iy,C="onMouseLeave",y="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(I=oy,C="onPointerLeave",y="onPointerEnter",_="pointer"),P=g==null?m:go(g),T=b==null?m:go(b),m=new I(C,_+"leave",g,n,h),m.target=P,m.relatedTarget=T,C=null,ds(h)===c&&(I=new I(y,_+"enter",b,n,h),I.target=T,I.relatedTarget=P,C=I),P=C,g&&b)t:{for(I=g,y=b,_=0,T=I;T;T=Js(T))_++;for(T=0,C=y;C;C=Js(C))T++;for(;0<_-T;)I=Js(I),_--;for(;0<T-_;)y=Js(y),T--;for(;_--;){if(I===y||y!==null&&I===y.alternate)break t;I=Js(I),y=Js(y)}I=null}else I=null;g!==null&&yy(f,m,g,I,!1),b!==null&&P!==null&&yy(f,P,b,I,!0)}}e:{if(m=c?go(c):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var F=tb;else if(uy(m))if(y1)F=sb;else{F=rb;var j=nb}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=ib);if(F&&(F=F(t,c))){g1(f,F,n,h);break e}j&&j(t,m,c),t==="focusout"&&(j=m._wrapperState)&&j.controlled&&m.type==="number"&&Cf(m,"number",m.value)}switch(j=c?go(c):window,t){case"focusin":(uy(j)||j.contentEditable==="true")&&(po=j,$f=c,el=null);break;case"focusout":el=$f=po=null;break;case"mousedown":qf=!0;break;case"contextmenu":case"mouseup":case"dragend":qf=!1,py(f,n,h);break;case"selectionchange":if(lb)break;case"keydown":case"keyup":py(f,n,h)}var E;if(Im)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else fo?p1(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(f1&&n.locale!=="ko"&&(fo||w!=="onCompositionStart"?w==="onCompositionEnd"&&fo&&(E=d1()):(_i=h,wm="value"in _i?_i.value:_i.textContent,fo=!0)),j=Fc(c,w),0<j.length&&(w=new sy(w,t,null,n,h),f.push({event:w,listeners:j}),E?w.data=E:(E=m1(n),E!==null&&(w.data=E)))),(E=Yk?Xk(t,n):Jk(t,n))&&(c=Fc(c,"onBeforeInput"),0<c.length&&(h=new sy("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:c}),h.data=E))}b1(f,e)})}function xl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Fc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=pl(t,n),s!=null&&r.unshift(xl(t,s,i)),s=pl(t,e),s!=null&&r.push(xl(t,s,i))),t=t.return}return r}function Js(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,i?(u=pl(n,s),u!=null&&o.unshift(xl(n,u,a))):i||(u=pl(n,s),u!=null&&o.push(xl(n,u,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var db=/\r\n?/g,fb=/\u0000|\uFFFD/g;function vy(t){return(typeof t=="string"?t:""+t).replace(db,`
`).replace(fb,"")}function Ou(t,e,n){if(e=vy(e),vy(t)!==e&&n)throw Error(Y(425))}function jc(){}var Gf=null,Hf=null;function Kf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wf=typeof setTimeout=="function"?setTimeout:void 0,pb=typeof clearTimeout=="function"?clearTimeout:void 0,_y=typeof Promise=="function"?Promise:void 0,mb=typeof queueMicrotask=="function"?queueMicrotask:typeof _y<"u"?function(t){return _y.resolve(null).then(t).catch(gb)}:Wf;function gb(t){setTimeout(function(){throw t})}function zd(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),yl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);yl(e)}function Si(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function wy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var oa=Math.random().toString(36).slice(2),cr="__reactFiber$"+oa,El="__reactProps$"+oa,Gr="__reactContainer$"+oa,Qf="__reactEvents$"+oa,yb="__reactListeners$"+oa,vb="__reactHandles$"+oa;function ds(t){var e=t[cr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gr]||n[cr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=wy(t);t!==null;){if(n=t[cr])return n;t=wy(t)}return e}t=n,n=t.parentNode}return null}function Ql(t){return t=t[cr]||t[Gr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function go(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Y(33))}function Dh(t){return t[El]||null}var Yf=[],yo=-1;function $i(t){return{current:t}}function et(t){0>yo||(t.current=Yf[yo],Yf[yo]=null,yo--)}function Ye(t,e){yo++,Yf[yo]=t.current,t.current=e}var Oi={},nn=$i(Oi),In=$i(!1),ks=Oi;function Lo(t,e){var n=t.type.contextTypes;if(!n)return Oi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Tn(t){return t=t.childContextTypes,t!=null}function zc(){et(In),et(nn)}function xy(t,e,n){if(nn.current!==Oi)throw Error(Y(168));Ye(nn,e),Ye(In,n)}function R1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Y(108,nk(t)||"Unknown",i));return ht({},n,r)}function Uc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Oi,ks=nn.current,Ye(nn,t),Ye(In,In.current),!0}function Ey(t,e,n){var r=t.stateNode;if(!r)throw Error(Y(169));n?(t=R1(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,et(In),et(nn),Ye(nn,t)):et(In),Ye(In,n)}var Rr=null,Vh=!1,Ud=!1;function P1(t){Rr===null?Rr=[t]:Rr.push(t)}function _b(t){Vh=!0,P1(t)}function qi(){if(!Ud&&Rr!==null){Ud=!0;var t=0,e=Be;try{var n=Rr;for(Be=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Rr=null,Vh=!1}catch(i){throw Rr!==null&&(Rr=Rr.slice(t+1)),t1(gm,qi),i}finally{Be=e,Ud=!1}}return null}var vo=[],_o=0,Bc=null,$c=0,Ln=[],Fn=0,bs=null,Vr=1,Mr="";function rs(t,e){vo[_o++]=$c,vo[_o++]=Bc,Bc=t,$c=e}function C1(t,e,n){Ln[Fn++]=Vr,Ln[Fn++]=Mr,Ln[Fn++]=bs,bs=t;var r=Vr;t=Mr;var i=32-tr(r)-1;r&=~(1<<i),n+=1;var s=32-tr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Vr=1<<32-tr(e)+i|n<<i|r,Mr=s+t}else Vr=1<<s|n<<i|r,Mr=t}function Sm(t){t.return!==null&&(rs(t,1),C1(t,1,0))}function km(t){for(;t===Bc;)Bc=vo[--_o],vo[_o]=null,$c=vo[--_o],vo[_o]=null;for(;t===bs;)bs=Ln[--Fn],Ln[Fn]=null,Mr=Ln[--Fn],Ln[Fn]=null,Vr=Ln[--Fn],Ln[Fn]=null}var Pn=null,An=null,it=!1,Zn=null;function N1(t,e){var n=jn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Iy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pn=t,An=Si(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pn=t,An=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=bs!==null?{id:Vr,overflow:Mr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=jn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pn=t,An=null,!0):!1;default:return!1}}function Xf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jf(t){if(it){var e=An;if(e){var n=e;if(!Iy(t,e)){if(Xf(t))throw Error(Y(418));e=Si(n.nextSibling);var r=Pn;e&&Iy(t,e)?N1(r,n):(t.flags=t.flags&-4097|2,it=!1,Pn=t)}}else{if(Xf(t))throw Error(Y(418));t.flags=t.flags&-4097|2,it=!1,Pn=t}}}function Ty(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pn=t}function Lu(t){if(t!==Pn)return!1;if(!it)return Ty(t),it=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Kf(t.type,t.memoizedProps)),e&&(e=An)){if(Xf(t))throw D1(),Error(Y(418));for(;e;)N1(t,e),e=Si(e.nextSibling)}if(Ty(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Y(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){An=Si(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}An=null}}else An=Pn?Si(t.stateNode.nextSibling):null;return!0}function D1(){for(var t=An;t;)t=Si(t.nextSibling)}function Fo(){An=Pn=null,it=!1}function bm(t){Zn===null?Zn=[t]:Zn.push(t)}var wb=Jr.ReactCurrentBatchConfig;function Aa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,t))}return t}function Fu(t,e){throw t=Object.prototype.toString.call(e),Error(Y(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Sy(t){var e=t._init;return e(t._payload)}function V1(t){function e(y,_){if(t){var T=y.deletions;T===null?(y.deletions=[_],y.flags|=16):T.push(_)}}function n(y,_){if(!t)return null;for(;_!==null;)e(y,_),_=_.sibling;return null}function r(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function i(y,_){return y=Ri(y,_),y.index=0,y.sibling=null,y}function s(y,_,T){return y.index=T,t?(T=y.alternate,T!==null?(T=T.index,T<_?(y.flags|=2,_):T):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,_,T,C){return _===null||_.tag!==6?(_=Wd(T,y.mode,C),_.return=y,_):(_=i(_,T),_.return=y,_)}function u(y,_,T,C){var F=T.type;return F===ho?h(y,_,T.props.children,C,T.key):_!==null&&(_.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===ci&&Sy(F)===_.type)?(C=i(_,T.props),C.ref=Aa(y,_,T),C.return=y,C):(C=dc(T.type,T.key,T.props,null,y.mode,C),C.ref=Aa(y,_,T),C.return=y,C)}function c(y,_,T,C){return _===null||_.tag!==4||_.stateNode.containerInfo!==T.containerInfo||_.stateNode.implementation!==T.implementation?(_=Qd(T,y.mode,C),_.return=y,_):(_=i(_,T.children||[]),_.return=y,_)}function h(y,_,T,C,F){return _===null||_.tag!==7?(_=_s(T,y.mode,C,F),_.return=y,_):(_=i(_,T),_.return=y,_)}function f(y,_,T){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Wd(""+_,y.mode,T),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case bu:return T=dc(_.type,_.key,_.props,null,y.mode,T),T.ref=Aa(y,null,_),T.return=y,T;case co:return _=Qd(_,y.mode,T),_.return=y,_;case ci:var C=_._init;return f(y,C(_._payload),T)}if(ja(_)||Ia(_))return _=_s(_,y.mode,T,null),_.return=y,_;Fu(y,_)}return null}function m(y,_,T,C){var F=_!==null?_.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return F!==null?null:a(y,_,""+T,C);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case bu:return T.key===F?u(y,_,T,C):null;case co:return T.key===F?c(y,_,T,C):null;case ci:return F=T._init,m(y,_,F(T._payload),C)}if(ja(T)||Ia(T))return F!==null?null:h(y,_,T,C,null);Fu(y,T)}return null}function g(y,_,T,C,F){if(typeof C=="string"&&C!==""||typeof C=="number")return y=y.get(T)||null,a(_,y,""+C,F);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case bu:return y=y.get(C.key===null?T:C.key)||null,u(_,y,C,F);case co:return y=y.get(C.key===null?T:C.key)||null,c(_,y,C,F);case ci:var j=C._init;return g(y,_,T,j(C._payload),F)}if(ja(C)||Ia(C))return y=y.get(T)||null,h(_,y,C,F,null);Fu(_,C)}return null}function b(y,_,T,C){for(var F=null,j=null,E=_,w=_=0,k=null;E!==null&&w<T.length;w++){E.index>w?(k=E,E=null):k=E.sibling;var A=m(y,E,T[w],C);if(A===null){E===null&&(E=k);break}t&&E&&A.alternate===null&&e(y,E),_=s(A,_,w),j===null?F=A:j.sibling=A,j=A,E=k}if(w===T.length)return n(y,E),it&&rs(y,w),F;if(E===null){for(;w<T.length;w++)E=f(y,T[w],C),E!==null&&(_=s(E,_,w),j===null?F=E:j.sibling=E,j=E);return it&&rs(y,w),F}for(E=r(y,E);w<T.length;w++)k=g(E,y,w,T[w],C),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?w:k.key),_=s(k,_,w),j===null?F=k:j.sibling=k,j=k);return t&&E.forEach(function(R){return e(y,R)}),it&&rs(y,w),F}function I(y,_,T,C){var F=Ia(T);if(typeof F!="function")throw Error(Y(150));if(T=F.call(T),T==null)throw Error(Y(151));for(var j=F=null,E=_,w=_=0,k=null,A=T.next();E!==null&&!A.done;w++,A=T.next()){E.index>w?(k=E,E=null):k=E.sibling;var R=m(y,E,A.value,C);if(R===null){E===null&&(E=k);break}t&&E&&R.alternate===null&&e(y,E),_=s(R,_,w),j===null?F=R:j.sibling=R,j=R,E=k}if(A.done)return n(y,E),it&&rs(y,w),F;if(E===null){for(;!A.done;w++,A=T.next())A=f(y,A.value,C),A!==null&&(_=s(A,_,w),j===null?F=A:j.sibling=A,j=A);return it&&rs(y,w),F}for(E=r(y,E);!A.done;w++,A=T.next())A=g(E,y,w,A.value,C),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?w:A.key),_=s(A,_,w),j===null?F=A:j.sibling=A,j=A);return t&&E.forEach(function(N){return e(y,N)}),it&&rs(y,w),F}function P(y,_,T,C){if(typeof T=="object"&&T!==null&&T.type===ho&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case bu:e:{for(var F=T.key,j=_;j!==null;){if(j.key===F){if(F=T.type,F===ho){if(j.tag===7){n(y,j.sibling),_=i(j,T.props.children),_.return=y,y=_;break e}}else if(j.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===ci&&Sy(F)===j.type){n(y,j.sibling),_=i(j,T.props),_.ref=Aa(y,j,T),_.return=y,y=_;break e}n(y,j);break}else e(y,j);j=j.sibling}T.type===ho?(_=_s(T.props.children,y.mode,C,T.key),_.return=y,y=_):(C=dc(T.type,T.key,T.props,null,y.mode,C),C.ref=Aa(y,_,T),C.return=y,y=C)}return o(y);case co:e:{for(j=T.key;_!==null;){if(_.key===j)if(_.tag===4&&_.stateNode.containerInfo===T.containerInfo&&_.stateNode.implementation===T.implementation){n(y,_.sibling),_=i(_,T.children||[]),_.return=y,y=_;break e}else{n(y,_);break}else e(y,_);_=_.sibling}_=Qd(T,y.mode,C),_.return=y,y=_}return o(y);case ci:return j=T._init,P(y,_,j(T._payload),C)}if(ja(T))return b(y,_,T,C);if(Ia(T))return I(y,_,T,C);Fu(y,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,_!==null&&_.tag===6?(n(y,_.sibling),_=i(_,T),_.return=y,y=_):(n(y,_),_=Wd(T,y.mode,C),_.return=y,y=_),o(y)):n(y,_)}return P}var jo=V1(!0),M1=V1(!1),qc=$i(null),Gc=null,wo=null,Am=null;function Rm(){Am=wo=Gc=null}function Pm(t){var e=qc.current;et(qc),t._currentValue=e}function Zf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ao(t,e){Gc=t,Am=wo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wn=!0),t.firstContext=null)}function qn(t){var e=t._currentValue;if(Am!==t)if(t={context:t,memoizedValue:e,next:null},wo===null){if(Gc===null)throw Error(Y(308));wo=t,Gc.dependencies={lanes:0,firstContext:t}}else wo=wo.next=t;return e}var fs=null;function Cm(t){fs===null?fs=[t]:fs.push(t)}function O1(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Cm(e)):(n.next=i.next,i.next=n),e.interleaved=n,Hr(t,r)}function Hr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var hi=!1;function Nm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function L1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Br(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ki(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Hr(t,n)}return i=r.interleaved,i===null?(e.next=e,Cm(r)):(e.next=i.next,i.next=e),r.interleaved=e,Hr(t,n)}function oc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ym(t,n)}}function ky(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hc(t,e,n,r){var i=t.updateQueue;hi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var u=a,c=u.next;u.next=null,o===null?s=c:o.next=c,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=u))}if(s!==null){var f=i.baseState;o=0,h=c=u=null,a=s;do{var m=a.lane,g=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,I=a;switch(m=e,g=n,I.tag){case 1:if(b=I.payload,typeof b=="function"){f=b.call(g,f,m);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=I.payload,m=typeof b=="function"?b.call(g,f,m):b,m==null)break e;f=ht({},f,m);break e;case 2:hi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=g,u=f):h=h.next=g,o|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(u=f),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Rs|=o,t.lanes=o,t.memoizedState=f}}function by(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Y(191,i));i.call(r)}}}var Yl={},pr=$i(Yl),Il=$i(Yl),Tl=$i(Yl);function ps(t){if(t===Yl)throw Error(Y(174));return t}function Dm(t,e){switch(Ye(Tl,e),Ye(Il,t),Ye(pr,Yl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Df(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Df(e,t)}et(pr),Ye(pr,e)}function zo(){et(pr),et(Il),et(Tl)}function F1(t){ps(Tl.current);var e=ps(pr.current),n=Df(e,t.type);e!==n&&(Ye(Il,t),Ye(pr,n))}function Vm(t){Il.current===t&&(et(pr),et(Il))}var at=$i(0);function Kc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bd=[];function Mm(){for(var t=0;t<Bd.length;t++)Bd[t]._workInProgressVersionPrimary=null;Bd.length=0}var ac=Jr.ReactCurrentDispatcher,$d=Jr.ReactCurrentBatchConfig,As=0,ut=null,At=null,Ot=null,Wc=!1,tl=!1,Sl=0,xb=0;function Xt(){throw Error(Y(321))}function Om(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function Lm(t,e,n,r,i,s){if(As=s,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ac.current=t===null||t.memoizedState===null?Sb:kb,t=n(r,i),tl){s=0;do{if(tl=!1,Sl=0,25<=s)throw Error(Y(301));s+=1,Ot=At=null,e.updateQueue=null,ac.current=bb,t=n(r,i)}while(tl)}if(ac.current=Qc,e=At!==null&&At.next!==null,As=0,Ot=At=ut=null,Wc=!1,e)throw Error(Y(300));return t}function Fm(){var t=Sl!==0;return Sl=0,t}function ur(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?ut.memoizedState=Ot=t:Ot=Ot.next=t,Ot}function Gn(){if(At===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=At.next;var e=Ot===null?ut.memoizedState:Ot.next;if(e!==null)Ot=e,At=t;else{if(t===null)throw Error(Y(310));At=t,t={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Ot===null?ut.memoizedState=Ot=t:Ot=Ot.next=t}return Ot}function kl(t,e){return typeof e=="function"?e(t):e}function qd(t){var e=Gn(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=At,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,u=null,c=s;do{var h=c.lane;if((As&h)===h)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=f,o=r):u=u.next=f,ut.lanes|=h,Rs|=h}c=c.next}while(c!==null&&c!==s);u===null?o=r:u.next=a,sr(r,e.memoizedState)||(wn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ut.lanes|=s,Rs|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Gd(t){var e=Gn(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);sr(s,e.memoizedState)||(wn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function j1(){}function z1(t,e){var n=ut,r=Gn(),i=e(),s=!sr(r.memoizedState,i);if(s&&(r.memoizedState=i,wn=!0),r=r.queue,jm($1.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ot!==null&&Ot.memoizedState.tag&1){if(n.flags|=2048,bl(9,B1.bind(null,n,r,i,e),void 0,null),Lt===null)throw Error(Y(349));As&30||U1(n,e,i)}return i}function U1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function B1(t,e,n,r){e.value=n,e.getSnapshot=r,q1(e)&&G1(t)}function $1(t,e,n){return n(function(){q1(e)&&G1(t)})}function q1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch{return!0}}function G1(t){var e=Hr(t,1);e!==null&&nr(e,t,1,-1)}function Ay(t){var e=ur();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kl,lastRenderedState:t},e.queue=t,t=t.dispatch=Tb.bind(null,ut,t),[e.memoizedState,t]}function bl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function H1(){return Gn().memoizedState}function lc(t,e,n,r){var i=ur();ut.flags|=t,i.memoizedState=bl(1|e,n,void 0,r===void 0?null:r)}function Mh(t,e,n,r){var i=Gn();r=r===void 0?null:r;var s=void 0;if(At!==null){var o=At.memoizedState;if(s=o.destroy,r!==null&&Om(r,o.deps)){i.memoizedState=bl(e,n,s,r);return}}ut.flags|=t,i.memoizedState=bl(1|e,n,s,r)}function Ry(t,e){return lc(8390656,8,t,e)}function jm(t,e){return Mh(2048,8,t,e)}function K1(t,e){return Mh(4,2,t,e)}function W1(t,e){return Mh(4,4,t,e)}function Q1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Y1(t,e,n){return n=n!=null?n.concat([t]):null,Mh(4,4,Q1.bind(null,e,t),n)}function zm(){}function X1(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Om(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function J1(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Om(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Z1(t,e,n){return As&21?(sr(n,e)||(n=i1(),ut.lanes|=n,Rs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wn=!0),t.memoizedState=n)}function Eb(t,e){var n=Be;Be=n!==0&&4>n?n:4,t(!0);var r=$d.transition;$d.transition={};try{t(!1),e()}finally{Be=n,$d.transition=r}}function ex(){return Gn().memoizedState}function Ib(t,e,n){var r=Ai(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tx(t))nx(e,n);else if(n=O1(t,e,n,r),n!==null){var i=ln();nr(n,t,r,i),rx(n,e,r)}}function Tb(t,e,n){var r=Ai(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tx(t))nx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,sr(a,o)){var u=e.interleaved;u===null?(i.next=i,Cm(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=O1(t,e,i,r),n!==null&&(i=ln(),nr(n,t,r,i),rx(n,e,r))}}function tx(t){var e=t.alternate;return t===ut||e!==null&&e===ut}function nx(t,e){tl=Wc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ym(t,n)}}var Qc={readContext:qn,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useInsertionEffect:Xt,useLayoutEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useMutableSource:Xt,useSyncExternalStore:Xt,useId:Xt,unstable_isNewReconciler:!1},Sb={readContext:qn,useCallback:function(t,e){return ur().memoizedState=[t,e===void 0?null:e],t},useContext:qn,useEffect:Ry,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,lc(4194308,4,Q1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return lc(4194308,4,t,e)},useInsertionEffect:function(t,e){return lc(4,2,t,e)},useMemo:function(t,e){var n=ur();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ur();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Ib.bind(null,ut,t),[r.memoizedState,t]},useRef:function(t){var e=ur();return t={current:t},e.memoizedState=t},useState:Ay,useDebugValue:zm,useDeferredValue:function(t){return ur().memoizedState=t},useTransition:function(){var t=Ay(!1),e=t[0];return t=Eb.bind(null,t[1]),ur().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ut,i=ur();if(it){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=e(),Lt===null)throw Error(Y(349));As&30||U1(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Ry($1.bind(null,r,s,t),[t]),r.flags|=2048,bl(9,B1.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=ur(),e=Lt.identifierPrefix;if(it){var n=Mr,r=Vr;n=(r&~(1<<32-tr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Sl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=xb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},kb={readContext:qn,useCallback:X1,useContext:qn,useEffect:jm,useImperativeHandle:Y1,useInsertionEffect:K1,useLayoutEffect:W1,useMemo:J1,useReducer:qd,useRef:H1,useState:function(){return qd(kl)},useDebugValue:zm,useDeferredValue:function(t){var e=Gn();return Z1(e,At.memoizedState,t)},useTransition:function(){var t=qd(kl)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:j1,useSyncExternalStore:z1,useId:ex,unstable_isNewReconciler:!1},bb={readContext:qn,useCallback:X1,useContext:qn,useEffect:jm,useImperativeHandle:Y1,useInsertionEffect:K1,useLayoutEffect:W1,useMemo:J1,useReducer:Gd,useRef:H1,useState:function(){return Gd(kl)},useDebugValue:zm,useDeferredValue:function(t){var e=Gn();return At===null?e.memoizedState=t:Z1(e,At.memoizedState,t)},useTransition:function(){var t=Gd(kl)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:j1,useSyncExternalStore:z1,useId:ex,unstable_isNewReconciler:!1};function Xn(t,e){if(t&&t.defaultProps){e=ht({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ep(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ht({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Oh={isMounted:function(t){return(t=t._reactInternals)?$s(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),i=Ai(t),s=Br(r,i);s.payload=e,n!=null&&(s.callback=n),e=ki(t,s,i),e!==null&&(nr(e,t,i,r),oc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),i=Ai(t),s=Br(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ki(t,s,i),e!==null&&(nr(e,t,i,r),oc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=Ai(t),i=Br(n,r);i.tag=2,e!=null&&(i.callback=e),e=ki(t,i,r),e!==null&&(nr(e,t,r,n),oc(e,t,r))}};function Py(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!_l(n,r)||!_l(i,s):!0}function ix(t,e,n){var r=!1,i=Oi,s=e.contextType;return typeof s=="object"&&s!==null?s=qn(s):(i=Tn(e)?ks:nn.current,r=e.contextTypes,s=(r=r!=null)?Lo(t,i):Oi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Oh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Cy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Oh.enqueueReplaceState(e,e.state,null)}function tp(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Nm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=qn(s):(s=Tn(e)?ks:nn.current,i.context=Lo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ep(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Oh.enqueueReplaceState(i,i.state,null),Hc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Uo(t,e){try{var n="",r=e;do n+=tk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Hd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function np(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Ab=typeof WeakMap=="function"?WeakMap:Map;function sx(t,e,n){n=Br(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Xc||(Xc=!0,dp=r),np(t,e)},n}function ox(t,e,n){n=Br(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){np(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){np(t,e),typeof r!="function"&&(bi===null?bi=new Set([this]):bi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Ny(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Ab;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Bb.bind(null,t,e,n),e.then(t,t))}function Dy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Vy(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Br(-1,1),e.tag=2,ki(n,e,1))),n.lanes|=1),t)}var Rb=Jr.ReactCurrentOwner,wn=!1;function sn(t,e,n,r){e.child=t===null?M1(e,null,n,r):jo(e,t.child,n,r)}function My(t,e,n,r,i){n=n.render;var s=e.ref;return Ao(e,i),r=Lm(t,e,n,r,s,i),n=Fm(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(it&&n&&Sm(e),e.flags|=1,sn(t,e,r,i),e.child)}function Oy(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Wm(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,ax(t,e,s,r,i)):(t=dc(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:_l,n(o,r)&&t.ref===e.ref)return Kr(t,e,i)}return e.flags|=1,t=Ri(s,r),t.ref=e.ref,t.return=e,e.child=t}function ax(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(_l(s,r)&&t.ref===e.ref)if(wn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(wn=!0);else return e.lanes=t.lanes,Kr(t,e,i)}return rp(t,e,n,r,i)}function lx(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Eo,bn),bn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ye(Eo,bn),bn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ye(Eo,bn),bn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ye(Eo,bn),bn|=r;return sn(t,e,i,n),e.child}function ux(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function rp(t,e,n,r,i){var s=Tn(n)?ks:nn.current;return s=Lo(e,s),Ao(e,i),n=Lm(t,e,n,r,s,i),r=Fm(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Kr(t,e,i)):(it&&r&&Sm(e),e.flags|=1,sn(t,e,n,i),e.child)}function Ly(t,e,n,r,i){if(Tn(n)){var s=!0;Uc(e)}else s=!1;if(Ao(e,i),e.stateNode===null)uc(t,e),ix(e,n,r),tp(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=qn(c):(c=Tn(n)?ks:nn.current,c=Lo(e,c));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==c)&&Cy(e,o,r,c),hi=!1;var m=e.memoizedState;o.state=m,Hc(e,r,o,i),u=e.memoizedState,a!==r||m!==u||In.current||hi?(typeof h=="function"&&(ep(e,n,h,r),u=e.memoizedState),(a=hi||Py(e,n,a,r,m,u,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,L1(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Xn(e.type,a),o.props=c,f=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=qn(u):(u=Tn(n)?ks:nn.current,u=Lo(e,u));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==u)&&Cy(e,o,r,u),hi=!1,m=e.memoizedState,o.state=m,Hc(e,r,o,i);var b=e.memoizedState;a!==f||m!==b||In.current||hi?(typeof g=="function"&&(ep(e,n,g,r),b=e.memoizedState),(c=hi||Py(e,n,c,r,m,b,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),o.props=r,o.state=b,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return ip(t,e,n,r,s,i)}function ip(t,e,n,r,i,s){ux(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Ey(e,n,!1),Kr(t,e,s);r=e.stateNode,Rb.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=jo(e,t.child,null,s),e.child=jo(e,null,a,s)):sn(t,e,a,s),e.memoizedState=r.state,i&&Ey(e,n,!0),e.child}function cx(t){var e=t.stateNode;e.pendingContext?xy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xy(t,e.context,!1),Dm(t,e.containerInfo)}function Fy(t,e,n,r,i){return Fo(),bm(i),e.flags|=256,sn(t,e,n,r),e.child}var sp={dehydrated:null,treeContext:null,retryLane:0};function op(t){return{baseLanes:t,cachePool:null,transitions:null}}function hx(t,e,n){var r=e.pendingProps,i=at.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ye(at,i&1),t===null)return Jf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=jh(o,r,0,null),t=_s(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=op(n),e.memoizedState=sp,t):Um(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Pb(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ri(i,u),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ri(a,s):(s=_s(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?op(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=sp,r}return s=t.child,t=s.sibling,r=Ri(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Um(t,e){return e=jh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ju(t,e,n,r){return r!==null&&bm(r),jo(e,t.child,null,n),t=Um(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Pb(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Hd(Error(Y(422))),ju(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=jh({mode:"visible",children:r.children},i,0,null),s=_s(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&jo(e,t.child,null,o),e.child.memoizedState=op(o),e.memoizedState=sp,s);if(!(e.mode&1))return ju(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Y(419)),r=Hd(s,r,void 0),ju(t,e,o,r)}if(a=(o&t.childLanes)!==0,wn||a){if(r=Lt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Hr(t,i),nr(r,t,i,-1))}return Km(),r=Hd(Error(Y(421))),ju(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=$b.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,An=Si(i.nextSibling),Pn=e,it=!0,Zn=null,t!==null&&(Ln[Fn++]=Vr,Ln[Fn++]=Mr,Ln[Fn++]=bs,Vr=t.id,Mr=t.overflow,bs=e),e=Um(e,r.children),e.flags|=4096,e)}function jy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Zf(t.return,e,n)}function Kd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function dx(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(sn(t,e,r.children,n),r=at.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jy(t,n,e);else if(t.tag===19)jy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ye(at,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Kc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Kd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Kc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Kd(e,!0,n,null,s);break;case"together":Kd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function uc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Rs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Y(153));if(e.child!==null){for(t=e.child,n=Ri(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ri(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Cb(t,e,n){switch(e.tag){case 3:cx(e),Fo();break;case 5:F1(e);break;case 1:Tn(e.type)&&Uc(e);break;case 4:Dm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ye(qc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ye(at,at.current&1),e.flags|=128,null):n&e.child.childLanes?hx(t,e,n):(Ye(at,at.current&1),t=Kr(t,e,n),t!==null?t.sibling:null);Ye(at,at.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ye(at,at.current),r)break;return null;case 22:case 23:return e.lanes=0,lx(t,e,n)}return Kr(t,e,n)}var fx,ap,px,mx;fx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ap=function(){};px=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ps(pr.current);var s=null;switch(n){case"input":i=Rf(t,i),r=Rf(t,r),s=[];break;case"select":i=ht({},i,{value:void 0}),r=ht({},r,{value:void 0}),s=[];break;case"textarea":i=Nf(t,i),r=Nf(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=jc)}Vf(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(dl.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(dl.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ze("scroll",t),s||a===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};mx=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ra(t,e){if(!it)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Jt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Nb(t,e,n){var r=e.pendingProps;switch(km(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(e),null;case 1:return Tn(e.type)&&zc(),Jt(e),null;case 3:return r=e.stateNode,zo(),et(In),et(nn),Mm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Lu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(mp(Zn),Zn=null))),ap(t,e),Jt(e),null;case 5:Vm(e);var i=ps(Tl.current);if(n=e.type,t!==null&&e.stateNode!=null)px(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Y(166));return Jt(e),null}if(t=ps(pr.current),Lu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[cr]=e,r[El]=s,t=(e.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(i=0;i<Ua.length;i++)Ze(Ua[i],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":W0(r,s),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ze("invalid",r);break;case"textarea":Y0(r,s),Ze("invalid",r)}Vf(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ou(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ou(r.textContent,a,t),i=["children",""+a]):dl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Au(r),Q0(r,s,!0);break;case"textarea":Au(r),X0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=jc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$w(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[cr]=e,t[El]=r,fx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Mf(n,r),n){case"dialog":Ze("cancel",t),Ze("close",t),i=r;break;case"iframe":case"object":case"embed":Ze("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ua.length;i++)Ze(Ua[i],t);i=r;break;case"source":Ze("error",t),i=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),i=r;break;case"details":Ze("toggle",t),i=r;break;case"input":W0(t,r),i=Rf(t,r),Ze("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ht({},r,{value:void 0}),Ze("invalid",t);break;case"textarea":Y0(t,r),i=Nf(t,r),Ze("invalid",t);break;default:i=r}Vf(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var u=a[s];s==="style"?Hw(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&qw(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&fl(t,u):typeof u=="number"&&fl(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(dl.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Ze("scroll",t):u!=null&&hm(t,s,u,o))}switch(n){case"input":Au(t),Q0(t,r,!1);break;case"textarea":Au(t),X0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Mi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?To(t,!!r.multiple,s,!1):r.defaultValue!=null&&To(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=jc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jt(e),null;case 6:if(t&&e.stateNode!=null)mx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Y(166));if(n=ps(Tl.current),ps(pr.current),Lu(e)){if(r=e.stateNode,n=e.memoizedProps,r[cr]=e,(s=r.nodeValue!==n)&&(t=Pn,t!==null))switch(t.tag){case 3:Ou(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ou(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[cr]=e,e.stateNode=r}return Jt(e),null;case 13:if(et(at),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(it&&An!==null&&e.mode&1&&!(e.flags&128))D1(),Fo(),e.flags|=98560,s=!1;else if(s=Lu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Y(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Y(317));s[cr]=e}else Fo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jt(e),s=!1}else Zn!==null&&(mp(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||at.current&1?Rt===0&&(Rt=3):Km())),e.updateQueue!==null&&(e.flags|=4),Jt(e),null);case 4:return zo(),ap(t,e),t===null&&wl(e.stateNode.containerInfo),Jt(e),null;case 10:return Pm(e.type._context),Jt(e),null;case 17:return Tn(e.type)&&zc(),Jt(e),null;case 19:if(et(at),s=e.memoizedState,s===null)return Jt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ra(s,!1);else{if(Rt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Kc(t),o!==null){for(e.flags|=128,Ra(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ye(at,at.current&1|2),e.child}t=t.sibling}s.tail!==null&&Et()>Bo&&(e.flags|=128,r=!0,Ra(s,!1),e.lanes=4194304)}else{if(!r)if(t=Kc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ra(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!it)return Jt(e),null}else 2*Et()-s.renderingStartTime>Bo&&n!==1073741824&&(e.flags|=128,r=!0,Ra(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Et(),e.sibling=null,n=at.current,Ye(at,r?n&1|2:n&1),e):(Jt(e),null);case 22:case 23:return Hm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bn&1073741824&&(Jt(e),e.subtreeFlags&6&&(e.flags|=8192)):Jt(e),null;case 24:return null;case 25:return null}throw Error(Y(156,e.tag))}function Db(t,e){switch(km(e),e.tag){case 1:return Tn(e.type)&&zc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zo(),et(In),et(nn),Mm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vm(e),null;case 13:if(et(at),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Y(340));Fo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return et(at),null;case 4:return zo(),null;case 10:return Pm(e.type._context),null;case 22:case 23:return Hm(),null;case 24:return null;default:return null}}var zu=!1,en=!1,Vb=typeof WeakSet=="function"?WeakSet:Set,le=null;function xo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){yt(t,e,r)}else n.current=null}function lp(t,e,n){try{n()}catch(r){yt(t,e,r)}}var zy=!1;function Mb(t,e){if(Gf=Oc,t=w1(),Tm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,u=-1,c=0,h=0,f=t,m=null;t:for(;;){for(var g;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)m=f,f=g;for(;;){if(f===t)break t;if(m===n&&++c===i&&(a=o),m===s&&++h===r&&(u=o),(g=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=g}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hf={focusedElem:t,selectionRange:n},Oc=!1,le=e;le!==null;)if(e=le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,le=t;else for(;le!==null;){e=le;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var I=b.memoizedProps,P=b.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?I:Xn(e.type,I),P);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(C){yt(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,le=t;break}le=e.return}return b=zy,zy=!1,b}function nl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&lp(e,n,s)}i=i.next}while(i!==r)}}function Lh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function up(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gx(t){var e=t.alternate;e!==null&&(t.alternate=null,gx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[cr],delete e[El],delete e[Qf],delete e[yb],delete e[vb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yx(t){return t.tag===5||t.tag===3||t.tag===4}function Uy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=jc));else if(r!==4&&(t=t.child,t!==null))for(cp(t,e,n),t=t.sibling;t!==null;)cp(t,e,n),t=t.sibling}function hp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(hp(t,e,n),t=t.sibling;t!==null;)hp(t,e,n),t=t.sibling}var zt=null,Jn=!1;function si(t,e,n){for(n=n.child;n!==null;)vx(t,e,n),n=n.sibling}function vx(t,e,n){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(Rh,n)}catch{}switch(n.tag){case 5:en||xo(n,e);case 6:var r=zt,i=Jn;zt=null,si(t,e,n),zt=r,Jn=i,zt!==null&&(Jn?(t=zt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):zt.removeChild(n.stateNode));break;case 18:zt!==null&&(Jn?(t=zt,n=n.stateNode,t.nodeType===8?zd(t.parentNode,n):t.nodeType===1&&zd(t,n),yl(t)):zd(zt,n.stateNode));break;case 4:r=zt,i=Jn,zt=n.stateNode.containerInfo,Jn=!0,si(t,e,n),zt=r,Jn=i;break;case 0:case 11:case 14:case 15:if(!en&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&lp(n,e,o),i=i.next}while(i!==r)}si(t,e,n);break;case 1:if(!en&&(xo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){yt(n,e,a)}si(t,e,n);break;case 21:si(t,e,n);break;case 22:n.mode&1?(en=(r=en)||n.memoizedState!==null,si(t,e,n),en=r):si(t,e,n);break;default:si(t,e,n)}}function By(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Vb),e.forEach(function(r){var i=qb.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:zt=a.stateNode,Jn=!1;break e;case 3:zt=a.stateNode.containerInfo,Jn=!0;break e;case 4:zt=a.stateNode.containerInfo,Jn=!0;break e}a=a.return}if(zt===null)throw Error(Y(160));vx(s,o,i),zt=null,Jn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(c){yt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_x(e,t),e=e.sibling}function _x(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qn(e,t),lr(t),r&4){try{nl(3,t,t.return),Lh(3,t)}catch(I){yt(t,t.return,I)}try{nl(5,t,t.return)}catch(I){yt(t,t.return,I)}}break;case 1:Qn(e,t),lr(t),r&512&&n!==null&&xo(n,n.return);break;case 5:if(Qn(e,t),lr(t),r&512&&n!==null&&xo(n,n.return),t.flags&32){var i=t.stateNode;try{fl(i,"")}catch(I){yt(t,t.return,I)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Uw(i,s),Mf(a,o);var c=Mf(a,s);for(o=0;o<u.length;o+=2){var h=u[o],f=u[o+1];h==="style"?Hw(i,f):h==="dangerouslySetInnerHTML"?qw(i,f):h==="children"?fl(i,f):hm(i,h,f,c)}switch(a){case"input":Pf(i,s);break;case"textarea":Bw(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?To(i,!!s.multiple,g,!1):m!==!!s.multiple&&(s.defaultValue!=null?To(i,!!s.multiple,s.defaultValue,!0):To(i,!!s.multiple,s.multiple?[]:"",!1))}i[El]=s}catch(I){yt(t,t.return,I)}}break;case 6:if(Qn(e,t),lr(t),r&4){if(t.stateNode===null)throw Error(Y(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(I){yt(t,t.return,I)}}break;case 3:if(Qn(e,t),lr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{yl(e.containerInfo)}catch(I){yt(t,t.return,I)}break;case 4:Qn(e,t),lr(t);break;case 13:Qn(e,t),lr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(qm=Et())),r&4&&By(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(en=(c=en)||h,Qn(e,t),en=c):Qn(e,t),lr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(le=t,h=t.child;h!==null;){for(f=le=h;le!==null;){switch(m=le,g=m.child,m.tag){case 0:case 11:case 14:case 15:nl(4,m,m.return);break;case 1:xo(m,m.return);var b=m.stateNode;if(typeof b.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(I){yt(r,n,I)}}break;case 5:xo(m,m.return);break;case 22:if(m.memoizedState!==null){qy(f);continue}}g!==null?(g.return=m,le=g):qy(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Gw("display",o))}catch(I){yt(t,t.return,I)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(I){yt(t,t.return,I)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Qn(e,t),lr(t),r&4&&By(t);break;case 21:break;default:Qn(e,t),lr(t)}}function lr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yx(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(fl(i,""),r.flags&=-33);var s=Uy(t);hp(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Uy(t);cp(t,a,o);break;default:throw Error(Y(161))}}catch(u){yt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ob(t,e,n){le=t,wx(t)}function wx(t,e,n){for(var r=(t.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||zu;if(!o){var a=i.alternate,u=a!==null&&a.memoizedState!==null||en;a=zu;var c=en;if(zu=o,(en=u)&&!c)for(le=i;le!==null;)o=le,u=o.child,o.tag===22&&o.memoizedState!==null?Gy(i):u!==null?(u.return=o,le=u):Gy(i);for(;s!==null;)le=s,wx(s),s=s.sibling;le=i,zu=a,en=c}$y(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):$y(t)}}function $y(t){for(;le!==null;){var e=le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:en||Lh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!en)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Xn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&by(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}by(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&yl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}en||e.flags&512&&up(e)}catch(m){yt(e,e.return,m)}}if(e===t){le=null;break}if(n=e.sibling,n!==null){n.return=e.return,le=n;break}le=e.return}}function qy(t){for(;le!==null;){var e=le;if(e===t){le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,le=n;break}le=e.return}}function Gy(t){for(;le!==null;){var e=le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lh(4,e)}catch(u){yt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){yt(e,i,u)}}var s=e.return;try{up(e)}catch(u){yt(e,s,u)}break;case 5:var o=e.return;try{up(e)}catch(u){yt(e,o,u)}}}catch(u){yt(e,e.return,u)}if(e===t){le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,le=a;break}le=e.return}}var Lb=Math.ceil,Yc=Jr.ReactCurrentDispatcher,Bm=Jr.ReactCurrentOwner,Bn=Jr.ReactCurrentBatchConfig,Ve=0,Lt=null,kt=null,Gt=0,bn=0,Eo=$i(0),Rt=0,Al=null,Rs=0,Fh=0,$m=0,rl=null,_n=null,qm=0,Bo=1/0,Ar=null,Xc=!1,dp=null,bi=null,Uu=!1,wi=null,Jc=0,il=0,fp=null,cc=-1,hc=0;function ln(){return Ve&6?Et():cc!==-1?cc:cc=Et()}function Ai(t){return t.mode&1?Ve&2&&Gt!==0?Gt&-Gt:wb.transition!==null?(hc===0&&(hc=i1()),hc):(t=Be,t!==0||(t=window.event,t=t===void 0?16:h1(t.type)),t):1}function nr(t,e,n,r){if(50<il)throw il=0,fp=null,Error(Y(185));Kl(t,n,r),(!(Ve&2)||t!==Lt)&&(t===Lt&&(!(Ve&2)&&(Fh|=n),Rt===4&&pi(t,Gt)),Sn(t,r),n===1&&Ve===0&&!(e.mode&1)&&(Bo=Et()+500,Vh&&qi()))}function Sn(t,e){var n=t.callbackNode;wk(t,e);var r=Mc(t,t===Lt?Gt:0);if(r===0)n!==null&&ey(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ey(n),e===1)t.tag===0?_b(Hy.bind(null,t)):P1(Hy.bind(null,t)),mb(function(){!(Ve&6)&&qi()}),n=null;else{switch(s1(r)){case 1:n=gm;break;case 4:n=n1;break;case 16:n=Vc;break;case 536870912:n=r1;break;default:n=Vc}n=Ax(n,xx.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xx(t,e){if(cc=-1,hc=0,Ve&6)throw Error(Y(327));var n=t.callbackNode;if(Ro()&&t.callbackNode!==n)return null;var r=Mc(t,t===Lt?Gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zc(t,r);else{e=r;var i=Ve;Ve|=2;var s=Ix();(Lt!==t||Gt!==e)&&(Ar=null,Bo=Et()+500,vs(t,e));do try{zb();break}catch(a){Ex(t,a)}while(!0);Rm(),Yc.current=s,Ve=i,kt!==null?e=0:(Lt=null,Gt=0,e=Rt)}if(e!==0){if(e===2&&(i=zf(t),i!==0&&(r=i,e=pp(t,i))),e===1)throw n=Al,vs(t,0),pi(t,r),Sn(t,Et()),n;if(e===6)pi(t,r);else{if(i=t.current.alternate,!(r&30)&&!Fb(i)&&(e=Zc(t,r),e===2&&(s=zf(t),s!==0&&(r=s,e=pp(t,s))),e===1))throw n=Al,vs(t,0),pi(t,r),Sn(t,Et()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Y(345));case 2:is(t,_n,Ar);break;case 3:if(pi(t,r),(r&130023424)===r&&(e=qm+500-Et(),10<e)){if(Mc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Wf(is.bind(null,t,_n,Ar),e);break}is(t,_n,Ar);break;case 4:if(pi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-tr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lb(r/1960))-r,10<r){t.timeoutHandle=Wf(is.bind(null,t,_n,Ar),r);break}is(t,_n,Ar);break;case 5:is(t,_n,Ar);break;default:throw Error(Y(329))}}}return Sn(t,Et()),t.callbackNode===n?xx.bind(null,t):null}function pp(t,e){var n=rl;return t.current.memoizedState.isDehydrated&&(vs(t,e).flags|=256),t=Zc(t,e),t!==2&&(e=_n,_n=n,e!==null&&mp(e)),t}function mp(t){_n===null?_n=t:_n.push.apply(_n,t)}function Fb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!sr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function pi(t,e){for(e&=~$m,e&=~Fh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-tr(e),r=1<<n;t[n]=-1,e&=~r}}function Hy(t){if(Ve&6)throw Error(Y(327));Ro();var e=Mc(t,0);if(!(e&1))return Sn(t,Et()),null;var n=Zc(t,e);if(t.tag!==0&&n===2){var r=zf(t);r!==0&&(e=r,n=pp(t,r))}if(n===1)throw n=Al,vs(t,0),pi(t,e),Sn(t,Et()),n;if(n===6)throw Error(Y(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,is(t,_n,Ar),Sn(t,Et()),null}function Gm(t,e){var n=Ve;Ve|=1;try{return t(e)}finally{Ve=n,Ve===0&&(Bo=Et()+500,Vh&&qi())}}function Ps(t){wi!==null&&wi.tag===0&&!(Ve&6)&&Ro();var e=Ve;Ve|=1;var n=Bn.transition,r=Be;try{if(Bn.transition=null,Be=1,t)return t()}finally{Be=r,Bn.transition=n,Ve=e,!(Ve&6)&&qi()}}function Hm(){bn=Eo.current,et(Eo)}function vs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,pb(n)),kt!==null)for(n=kt.return;n!==null;){var r=n;switch(km(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zc();break;case 3:zo(),et(In),et(nn),Mm();break;case 5:Vm(r);break;case 4:zo();break;case 13:et(at);break;case 19:et(at);break;case 10:Pm(r.type._context);break;case 22:case 23:Hm()}n=n.return}if(Lt=t,kt=t=Ri(t.current,null),Gt=bn=e,Rt=0,Al=null,$m=Fh=Rs=0,_n=rl=null,fs!==null){for(e=0;e<fs.length;e++)if(n=fs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}fs=null}return t}function Ex(t,e){do{var n=kt;try{if(Rm(),ac.current=Qc,Wc){for(var r=ut.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wc=!1}if(As=0,Ot=At=ut=null,tl=!1,Sl=0,Bm.current=null,n===null||n.return===null){Rt=1,Al=e,kt=null;break}e:{var s=t,o=n.return,a=n,u=e;if(e=Gt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Dy(o);if(g!==null){g.flags&=-257,Vy(g,o,a,s,e),g.mode&1&&Ny(s,c,e),e=g,u=c;var b=e.updateQueue;if(b===null){var I=new Set;I.add(u),e.updateQueue=I}else b.add(u);break e}else{if(!(e&1)){Ny(s,c,e),Km();break e}u=Error(Y(426))}}else if(it&&a.mode&1){var P=Dy(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Vy(P,o,a,s,e),bm(Uo(u,a));break e}}s=u=Uo(u,a),Rt!==4&&(Rt=2),rl===null?rl=[s]:rl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=sx(s,u,e);ky(s,y);break e;case 1:a=u;var _=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(bi===null||!bi.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var C=ox(s,a,e);ky(s,C);break e}}s=s.return}while(s!==null)}Sx(n)}catch(F){e=F,kt===n&&n!==null&&(kt=n=n.return);continue}break}while(!0)}function Ix(){var t=Yc.current;return Yc.current=Qc,t===null?Qc:t}function Km(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),Lt===null||!(Rs&268435455)&&!(Fh&268435455)||pi(Lt,Gt)}function Zc(t,e){var n=Ve;Ve|=2;var r=Ix();(Lt!==t||Gt!==e)&&(Ar=null,vs(t,e));do try{jb();break}catch(i){Ex(t,i)}while(!0);if(Rm(),Ve=n,Yc.current=r,kt!==null)throw Error(Y(261));return Lt=null,Gt=0,Rt}function jb(){for(;kt!==null;)Tx(kt)}function zb(){for(;kt!==null&&!hk();)Tx(kt)}function Tx(t){var e=bx(t.alternate,t,bn);t.memoizedProps=t.pendingProps,e===null?Sx(t):kt=e,Bm.current=null}function Sx(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Db(n,e),n!==null){n.flags&=32767,kt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rt=6,kt=null;return}}else if(n=Nb(n,e,bn),n!==null){kt=n;return}if(e=e.sibling,e!==null){kt=e;return}kt=e=t}while(e!==null);Rt===0&&(Rt=5)}function is(t,e,n){var r=Be,i=Bn.transition;try{Bn.transition=null,Be=1,Ub(t,e,n,r)}finally{Bn.transition=i,Be=r}return null}function Ub(t,e,n,r){do Ro();while(wi!==null);if(Ve&6)throw Error(Y(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Y(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(xk(t,s),t===Lt&&(kt=Lt=null,Gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Uu||(Uu=!0,Ax(Vc,function(){return Ro(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Bn.transition,Bn.transition=null;var o=Be;Be=1;var a=Ve;Ve|=4,Bm.current=null,Mb(t,n),_x(n,t),ab(Hf),Oc=!!Gf,Hf=Gf=null,t.current=n,Ob(n),dk(),Ve=a,Be=o,Bn.transition=s}else t.current=n;if(Uu&&(Uu=!1,wi=t,Jc=i),s=t.pendingLanes,s===0&&(bi=null),mk(n.stateNode),Sn(t,Et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Xc)throw Xc=!1,t=dp,dp=null,t;return Jc&1&&t.tag!==0&&Ro(),s=t.pendingLanes,s&1?t===fp?il++:(il=0,fp=t):il=0,qi(),null}function Ro(){if(wi!==null){var t=s1(Jc),e=Bn.transition,n=Be;try{if(Bn.transition=null,Be=16>t?16:t,wi===null)var r=!1;else{if(t=wi,wi=null,Jc=0,Ve&6)throw Error(Y(331));var i=Ve;for(Ve|=4,le=t.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var a=s.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(le=c;le!==null;){var h=le;switch(h.tag){case 0:case 11:case 15:nl(8,h,s)}var f=h.child;if(f!==null)f.return=h,le=f;else for(;le!==null;){h=le;var m=h.sibling,g=h.return;if(gx(h),h===c){le=null;break}if(m!==null){m.return=g,le=m;break}le=g}}}var b=s.alternate;if(b!==null){var I=b.child;if(I!==null){b.child=null;do{var P=I.sibling;I.sibling=null,I=P}while(I!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,le=y;break e}le=s.return}}var _=t.current;for(le=_;le!==null;){o=le;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,le=T;else e:for(o=_;le!==null;){if(a=le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lh(9,a)}}catch(F){yt(a,a.return,F)}if(a===o){le=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,le=C;break e}le=a.return}}if(Ve=i,qi(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(Rh,t)}catch{}r=!0}return r}finally{Be=n,Bn.transition=e}}return!1}function Ky(t,e,n){e=Uo(n,e),e=sx(t,e,1),t=ki(t,e,1),e=ln(),t!==null&&(Kl(t,1,e),Sn(t,e))}function yt(t,e,n){if(t.tag===3)Ky(t,t,n);else for(;e!==null;){if(e.tag===3){Ky(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(bi===null||!bi.has(r))){t=Uo(n,t),t=ox(e,t,1),e=ki(e,t,1),t=ln(),e!==null&&(Kl(e,1,t),Sn(e,t));break}}e=e.return}}function Bb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,Lt===t&&(Gt&n)===n&&(Rt===4||Rt===3&&(Gt&130023424)===Gt&&500>Et()-qm?vs(t,0):$m|=n),Sn(t,e)}function kx(t,e){e===0&&(t.mode&1?(e=Cu,Cu<<=1,!(Cu&130023424)&&(Cu=4194304)):e=1);var n=ln();t=Hr(t,e),t!==null&&(Kl(t,e,n),Sn(t,n))}function $b(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kx(t,n)}function qb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(e),kx(t,n)}var bx;bx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||In.current)wn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wn=!1,Cb(t,e,n);wn=!!(t.flags&131072)}else wn=!1,it&&e.flags&1048576&&C1(e,$c,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;uc(t,e),t=e.pendingProps;var i=Lo(e,nn.current);Ao(e,n),i=Lm(null,e,r,t,i,n);var s=Fm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(s=!0,Uc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Nm(e),i.updater=Oh,e.stateNode=i,i._reactInternals=e,tp(e,r,t,n),e=ip(null,e,r,!0,s,n)):(e.tag=0,it&&s&&Sm(e),sn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(uc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Hb(r),t=Xn(r,t),i){case 0:e=rp(null,e,r,t,n);break e;case 1:e=Ly(null,e,r,t,n);break e;case 11:e=My(null,e,r,t,n);break e;case 14:e=Oy(null,e,r,Xn(r.type,t),n);break e}throw Error(Y(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),rp(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),Ly(t,e,r,i,n);case 3:e:{if(cx(e),t===null)throw Error(Y(387));r=e.pendingProps,s=e.memoizedState,i=s.element,L1(t,e),Hc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Uo(Error(Y(423)),e),e=Fy(t,e,r,n,i);break e}else if(r!==i){i=Uo(Error(Y(424)),e),e=Fy(t,e,r,n,i);break e}else for(An=Si(e.stateNode.containerInfo.firstChild),Pn=e,it=!0,Zn=null,n=M1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fo(),r===i){e=Kr(t,e,n);break e}sn(t,e,r,n)}e=e.child}return e;case 5:return F1(e),t===null&&Jf(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Kf(r,i)?o=null:s!==null&&Kf(r,s)&&(e.flags|=32),ux(t,e),sn(t,e,o,n),e.child;case 6:return t===null&&Jf(e),null;case 13:return hx(t,e,n);case 4:return Dm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=jo(e,null,r,n):sn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),My(t,e,r,i,n);case 7:return sn(t,e,e.pendingProps,n),e.child;case 8:return sn(t,e,e.pendingProps.children,n),e.child;case 12:return sn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ye(qc,r._currentValue),r._currentValue=o,s!==null)if(sr(s.value,o)){if(s.children===i.children&&!In.current){e=Kr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Br(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Zf(s.return,n,e),a.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Y(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Zf(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}sn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ao(e,n),i=qn(i),r=r(i),e.flags|=1,sn(t,e,r,n),e.child;case 14:return r=e.type,i=Xn(r,e.pendingProps),i=Xn(r.type,i),Oy(t,e,r,i,n);case 15:return ax(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xn(r,i),uc(t,e),e.tag=1,Tn(r)?(t=!0,Uc(e)):t=!1,Ao(e,n),ix(e,r,i),tp(e,r,i,n),ip(null,e,r,!0,t,n);case 19:return dx(t,e,n);case 22:return lx(t,e,n)}throw Error(Y(156,e.tag))};function Ax(t,e){return t1(t,e)}function Gb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(t,e,n,r){return new Gb(t,e,n,r)}function Wm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Hb(t){if(typeof t=="function")return Wm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fm)return 11;if(t===pm)return 14}return 2}function Ri(t,e){var n=t.alternate;return n===null?(n=jn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function dc(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Wm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ho:return _s(n.children,i,s,e);case dm:o=8,i|=8;break;case Sf:return t=jn(12,n,e,i|2),t.elementType=Sf,t.lanes=s,t;case kf:return t=jn(13,n,e,i),t.elementType=kf,t.lanes=s,t;case bf:return t=jn(19,n,e,i),t.elementType=bf,t.lanes=s,t;case Fw:return jh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ow:o=10;break e;case Lw:o=9;break e;case fm:o=11;break e;case pm:o=14;break e;case ci:o=16,r=null;break e}throw Error(Y(130,t==null?t:typeof t,""))}return e=jn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function _s(t,e,n,r){return t=jn(7,t,r,e),t.lanes=n,t}function jh(t,e,n,r){return t=jn(22,t,r,e),t.elementType=Fw,t.lanes=n,t.stateNode={isHidden:!1},t}function Wd(t,e,n){return t=jn(6,t,null,e),t.lanes=n,t}function Qd(t,e,n){return e=jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Kb(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rd(0),this.expirationTimes=Rd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qm(t,e,n,r,i,s,o,a,u){return t=new Kb(t,e,n,a,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=jn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nm(s),t}function Wb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:co,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Rx(t){if(!t)return Oi;t=t._reactInternals;e:{if($s(t)!==t||t.tag!==1)throw Error(Y(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Y(171))}if(t.tag===1){var n=t.type;if(Tn(n))return R1(t,n,e)}return e}function Px(t,e,n,r,i,s,o,a,u){return t=Qm(n,r,!0,t,i,s,o,a,u),t.context=Rx(null),n=t.current,r=ln(),i=Ai(n),s=Br(r,i),s.callback=e??null,ki(n,s,i),t.current.lanes=i,Kl(t,i,r),Sn(t,r),t}function zh(t,e,n,r){var i=e.current,s=ln(),o=Ai(i);return n=Rx(n),e.context===null?e.context=n:e.pendingContext=n,e=Br(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ki(i,e,o),t!==null&&(nr(t,i,o,s),oc(t,i,o)),o}function eh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ym(t,e){Wy(t,e),(t=t.alternate)&&Wy(t,e)}function Qb(){return null}var Cx=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xm(t){this._internalRoot=t}Uh.prototype.render=Xm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Y(409));zh(t,e,null,null)};Uh.prototype.unmount=Xm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ps(function(){zh(null,t,null,null)}),e[Gr]=null}};function Uh(t){this._internalRoot=t}Uh.prototype.unstable_scheduleHydration=function(t){if(t){var e=l1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<fi.length&&e!==0&&e<fi[n].priority;n++);fi.splice(n,0,t),n===0&&c1(t)}};function Jm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qy(){}function Yb(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=eh(o);s.call(c)}}var o=Px(e,r,t,0,null,!1,!1,"",Qy);return t._reactRootContainer=o,t[Gr]=o.current,wl(t.nodeType===8?t.parentNode:t),Ps(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=eh(u);a.call(c)}}var u=Qm(t,0,!1,null,null,!1,!1,"",Qy);return t._reactRootContainer=u,t[Gr]=u.current,wl(t.nodeType===8?t.parentNode:t),Ps(function(){zh(e,u,n,r)}),u}function $h(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var u=eh(o);a.call(u)}}zh(e,o,t,i)}else o=Yb(n,e,t,i,r);return eh(o)}o1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=za(e.pendingLanes);n!==0&&(ym(e,n|1),Sn(e,Et()),!(Ve&6)&&(Bo=Et()+500,qi()))}break;case 13:Ps(function(){var r=Hr(t,1);if(r!==null){var i=ln();nr(r,t,1,i)}}),Ym(t,1)}};vm=function(t){if(t.tag===13){var e=Hr(t,134217728);if(e!==null){var n=ln();nr(e,t,134217728,n)}Ym(t,134217728)}};a1=function(t){if(t.tag===13){var e=Ai(t),n=Hr(t,e);if(n!==null){var r=ln();nr(n,t,e,r)}Ym(t,e)}};l1=function(){return Be};u1=function(t,e){var n=Be;try{return Be=t,e()}finally{Be=n}};Lf=function(t,e,n){switch(e){case"input":if(Pf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Dh(r);if(!i)throw Error(Y(90));zw(r),Pf(r,i)}}}break;case"textarea":Bw(t,n);break;case"select":e=n.value,e!=null&&To(t,!!n.multiple,e,!1)}};Qw=Gm;Yw=Ps;var Xb={usingClientEntryPoint:!1,Events:[Ql,go,Dh,Kw,Ww,Gm]},Pa={findFiberByHostInstance:ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jb={bundleType:Pa.bundleType,version:Pa.version,rendererPackageName:Pa.rendererPackageName,rendererConfig:Pa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Zw(t),t===null?null:t.stateNode},findFiberByHostInstance:Pa.findFiberByHostInstance||Qb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bu.isDisabled&&Bu.supportsFiber)try{Rh=Bu.inject(Jb),fr=Bu}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xb;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jm(e))throw Error(Y(200));return Wb(t,e,null,n)};Vn.createRoot=function(t,e){if(!Jm(t))throw Error(Y(299));var n=!1,r="",i=Cx;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qm(t,1,!1,null,null,n,!1,r,i),t[Gr]=e.current,wl(t.nodeType===8?t.parentNode:t),new Xm(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Y(188)):(t=Object.keys(t).join(","),Error(Y(268,t)));return t=Zw(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return Ps(t)};Vn.hydrate=function(t,e,n){if(!Bh(e))throw Error(Y(200));return $h(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!Jm(t))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Cx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Px(e,null,t,1,n??null,i,!1,s,o),t[Gr]=e.current,wl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Uh(e)};Vn.render=function(t,e,n){if(!Bh(e))throw Error(Y(200));return $h(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!Bh(t))throw Error(Y(40));return t._reactRootContainer?(Ps(function(){$h(null,null,t,!1,function(){t._reactRootContainer=null,t[Gr]=null})}),!0):!1};Vn.unstable_batchedUpdates=Gm;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Bh(n))throw Error(Y(200));if(t==null||t._reactInternals===void 0)throw Error(Y(38));return $h(t,e,n,!1,r)};Vn.version="18.3.1-next-f1338f8080-20240426";function Nx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nx)}catch(t){console.error(t)}}Nx(),Nw.exports=Vn;var Dx=Nw.exports,Yy=Dx;If.createRoot=Yy.createRoot,If.hydrateRoot=Yy.hydrateRoot;let $u;const Zb=new Uint8Array(16);function eA(){if(!$u&&($u=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$u))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $u(Zb)}const jt=[];for(let t=0;t<256;++t)jt.push((t+256).toString(16).slice(1));function tA(t,e=0){return jt[t[e+0]]+jt[t[e+1]]+jt[t[e+2]]+jt[t[e+3]]+"-"+jt[t[e+4]]+jt[t[e+5]]+"-"+jt[t[e+6]]+jt[t[e+7]]+"-"+jt[t[e+8]]+jt[t[e+9]]+"-"+jt[t[e+10]]+jt[t[e+11]]+jt[t[e+12]]+jt[t[e+13]]+jt[t[e+14]]+jt[t[e+15]]}const nA=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Xy={randomUUID:nA};function gp(t,e,n){if(Xy.randomUUID&&!t)return Xy.randomUUID();t=t||{};const r=t.random||(t.rng||eA)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,tA(r)}function rA(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var iA={value:()=>{}};function qh(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new fc(n)}function fc(t){this._=t}function sA(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}fc.prototype=qh.prototype={constructor:fc,on:function(t,e){var n=this._,r=sA(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=oA(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=Jy(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Jy(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new fc(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function oA(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Jy(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=iA,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var yp="http://www.w3.org/1999/xhtml";const Zy={svg:"http://www.w3.org/2000/svg",xhtml:yp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Gh(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Zy.hasOwnProperty(e)?{space:Zy[e],local:t}:t}function aA(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===yp&&e.documentElement.namespaceURI===yp?e.createElement(t):e.createElementNS(n,t)}}function lA(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Vx(t){var e=Gh(t);return(e.local?lA:aA)(e)}function uA(){}function Zm(t){return t==null?uA:function(){return this.querySelector(t)}}function cA(t){typeof t!="function"&&(t=Zm(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),u,c,h=0;h<o;++h)(u=s[h])&&(c=t.call(u,u.__data__,h,s))&&("__data__"in u&&(c.__data__=u.__data__),a[h]=c);return new Nn(r,this._parents)}function hA(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function dA(){return[]}function Mx(t){return t==null?dA:function(){return this.querySelectorAll(t)}}function fA(t){return function(){return hA(t.apply(this,arguments))}}function pA(t){typeof t=="function"?t=fA(t):t=Mx(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,u,c=0;c<a;++c)(u=o[c])&&(r.push(t.call(u,u.__data__,c,o)),i.push(u));return new Nn(r,i)}function Ox(t){return function(){return this.matches(t)}}function Lx(t){return function(e){return e.matches(t)}}var mA=Array.prototype.find;function gA(t){return function(){return mA.call(this.children,t)}}function yA(){return this.firstElementChild}function vA(t){return this.select(t==null?yA:gA(typeof t=="function"?t:Lx(t)))}var _A=Array.prototype.filter;function wA(){return Array.from(this.children)}function xA(t){return function(){return _A.call(this.children,t)}}function EA(t){return this.selectAll(t==null?wA:xA(typeof t=="function"?t:Lx(t)))}function IA(t){typeof t!="function"&&(t=Ox(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],u,c=0;c<o;++c)(u=s[c])&&t.call(u,u.__data__,c,s)&&a.push(u);return new Nn(r,this._parents)}function Fx(t){return new Array(t.length)}function TA(){return new Nn(this._enter||this._groups.map(Fx),this._parents)}function th(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}th.prototype={constructor:th,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function SA(t){return function(){return t}}function kA(t,e,n,r,i,s){for(var o=0,a,u=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new th(t,s[o]);for(;o<u;++o)(a=e[o])&&(i[o]=a)}function bA(t,e,n,r,i,s,o){var a,u,c=new Map,h=e.length,f=s.length,m=new Array(h),g;for(a=0;a<h;++a)(u=e[a])&&(m[a]=g=o.call(u,u.__data__,a,e)+"",c.has(g)?i[a]=u:c.set(g,u));for(a=0;a<f;++a)g=o.call(t,s[a],a,s)+"",(u=c.get(g))?(r[a]=u,u.__data__=s[a],c.delete(g)):n[a]=new th(t,s[a]);for(a=0;a<h;++a)(u=e[a])&&c.get(m[a])===u&&(i[a]=u)}function AA(t){return t.__data__}function RA(t,e){if(!arguments.length)return Array.from(this,AA);var n=e?bA:kA,r=this._parents,i=this._groups;typeof t!="function"&&(t=SA(t));for(var s=i.length,o=new Array(s),a=new Array(s),u=new Array(s),c=0;c<s;++c){var h=r[c],f=i[c],m=f.length,g=PA(t.call(h,h&&h.__data__,c,r)),b=g.length,I=a[c]=new Array(b),P=o[c]=new Array(b),y=u[c]=new Array(m);n(h,f,I,P,y,g,e);for(var _=0,T=0,C,F;_<b;++_)if(C=I[_]){for(_>=T&&(T=_+1);!(F=P[T])&&++T<b;);C._next=F||null}}return o=new Nn(o,r),o._enter=a,o._exit=u,o}function PA(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function CA(){return new Nn(this._exit||this._groups.map(Fx),this._parents)}function NA(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function DA(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),u=0;u<o;++u)for(var c=n[u],h=r[u],f=c.length,m=a[u]=new Array(f),g,b=0;b<f;++b)(g=c[b]||h[b])&&(m[b]=g);for(;u<i;++u)a[u]=n[u];return new Nn(a,this._parents)}function VA(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function MA(t){t||(t=OA);function e(f,m){return f&&m?t(f.__data__,m.__data__):!f-!m}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,u=i[s]=new Array(a),c,h=0;h<a;++h)(c=o[h])&&(u[h]=c);u.sort(e)}return new Nn(i,this._parents).order()}function OA(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function LA(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function FA(){return Array.from(this)}function jA(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function zA(){let t=0;for(const e of this)++t;return t}function UA(){return!this.node()}function BA(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function $A(t){return function(){this.removeAttribute(t)}}function qA(t){return function(){this.removeAttributeNS(t.space,t.local)}}function GA(t,e){return function(){this.setAttribute(t,e)}}function HA(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function KA(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function WA(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function QA(t,e){var n=Gh(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?qA:$A:typeof e=="function"?n.local?WA:KA:n.local?HA:GA)(n,e))}function jx(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function YA(t){return function(){this.style.removeProperty(t)}}function XA(t,e,n){return function(){this.style.setProperty(t,e,n)}}function JA(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function ZA(t,e,n){return arguments.length>1?this.each((e==null?YA:typeof e=="function"?JA:XA)(t,e,n??"")):$o(this.node(),t)}function $o(t,e){return t.style.getPropertyValue(e)||jx(t).getComputedStyle(t,null).getPropertyValue(e)}function e2(t){return function(){delete this[t]}}function t2(t,e){return function(){this[t]=e}}function n2(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function r2(t,e){return arguments.length>1?this.each((e==null?e2:typeof e=="function"?n2:t2)(t,e)):this.node()[t]}function zx(t){return t.trim().split(/^|\s+/)}function eg(t){return t.classList||new Ux(t)}function Ux(t){this._node=t,this._names=zx(t.getAttribute("class")||"")}Ux.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Bx(t,e){for(var n=eg(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function $x(t,e){for(var n=eg(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function i2(t){return function(){Bx(this,t)}}function s2(t){return function(){$x(this,t)}}function o2(t,e){return function(){(e.apply(this,arguments)?Bx:$x)(this,t)}}function a2(t,e){var n=zx(t+"");if(arguments.length<2){for(var r=eg(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?o2:e?i2:s2)(n,e))}function l2(){this.textContent=""}function u2(t){return function(){this.textContent=t}}function c2(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function h2(t){return arguments.length?this.each(t==null?l2:(typeof t=="function"?c2:u2)(t)):this.node().textContent}function d2(){this.innerHTML=""}function f2(t){return function(){this.innerHTML=t}}function p2(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function m2(t){return arguments.length?this.each(t==null?d2:(typeof t=="function"?p2:f2)(t)):this.node().innerHTML}function g2(){this.nextSibling&&this.parentNode.appendChild(this)}function y2(){return this.each(g2)}function v2(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _2(){return this.each(v2)}function w2(t){var e=typeof t=="function"?t:Vx(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function x2(){return null}function E2(t,e){var n=typeof t=="function"?t:Vx(t),r=e==null?x2:typeof e=="function"?e:Zm(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function I2(){var t=this.parentNode;t&&t.removeChild(this)}function T2(){return this.each(I2)}function S2(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function k2(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function b2(t){return this.select(t?k2:S2)}function A2(t){return arguments.length?this.property("__data__",t):this.node().__data__}function R2(t){return function(e){t.call(this,e,this.__data__)}}function P2(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function C2(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function N2(t,e,n){return function(){var r=this.__on,i,s=R2(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function D2(t,e,n){var r=P2(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,c=a.length,h;u<c;++u)for(i=0,h=a[u];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(a=e?N2:C2,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function qx(t,e,n){var r=jx(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function V2(t,e){return function(){return qx(this,t,e)}}function M2(t,e){return function(){return qx(this,t,e.apply(this,arguments))}}function O2(t,e){return this.each((typeof e=="function"?M2:V2)(t,e))}function*L2(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var Gx=[null];function Nn(t,e){this._groups=t,this._parents=e}function Xl(){return new Nn([[document.documentElement]],Gx)}function F2(){return this}Nn.prototype=Xl.prototype={constructor:Nn,select:cA,selectAll:pA,selectChild:vA,selectChildren:EA,filter:IA,data:RA,enter:TA,exit:CA,join:NA,merge:DA,selection:F2,order:VA,sort:MA,call:LA,nodes:FA,node:jA,size:zA,empty:UA,each:BA,attr:QA,style:ZA,property:r2,classed:a2,text:h2,html:m2,raise:y2,lower:_2,append:w2,insert:E2,remove:T2,clone:b2,datum:A2,on:D2,dispatch:O2,[Symbol.iterator]:L2};function Ut(t){return typeof t=="string"?new Nn([[document.querySelector(t)]],[document.documentElement]):new Nn([[t]],Gx)}function j2(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ts(t,e){if(t=j2(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const vp={capture:!0,passive:!1};function _p(t){t.preventDefault(),t.stopImmediatePropagation()}function z2(t){var e=t.document.documentElement,n=Ut(t).on("dragstart.drag",_p,vp);"onselectstart"in e?n.on("selectstart.drag",_p,vp):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function U2(t,e){var n=t.document.documentElement,r=Ut(t).on("dragstart.drag",null);e&&(r.on("click.drag",_p,vp),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function tg(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Hx(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Jl(){}var Rl=.7,nh=1/Rl,Po="\\s*([+-]?\\d+)\\s*",Pl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",B2=/^#([0-9a-f]{3,8})$/,$2=new RegExp(`^rgb\\(${Po},${Po},${Po}\\)$`),q2=new RegExp(`^rgb\\(${mr},${mr},${mr}\\)$`),G2=new RegExp(`^rgba\\(${Po},${Po},${Po},${Pl}\\)$`),H2=new RegExp(`^rgba\\(${mr},${mr},${mr},${Pl}\\)$`),K2=new RegExp(`^hsl\\(${Pl},${mr},${mr}\\)$`),W2=new RegExp(`^hsla\\(${Pl},${mr},${mr},${Pl}\\)$`),ev={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};tg(Jl,Li,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:tv,formatHex:tv,formatHex8:Q2,formatHsl:Y2,formatRgb:nv,toString:nv});function tv(){return this.rgb().formatHex()}function Q2(){return this.rgb().formatHex8()}function Y2(){return Kx(this).formatHsl()}function nv(){return this.rgb().formatRgb()}function Li(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=B2.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?rv(e):n===3?new xn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?qu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?qu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$2.exec(t))?new xn(e[1],e[2],e[3],1):(e=q2.exec(t))?new xn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=G2.exec(t))?qu(e[1],e[2],e[3],e[4]):(e=H2.exec(t))?qu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=K2.exec(t))?ov(e[1],e[2]/100,e[3]/100,1):(e=W2.exec(t))?ov(e[1],e[2]/100,e[3]/100,e[4]):ev.hasOwnProperty(t)?rv(ev[t]):t==="transparent"?new xn(NaN,NaN,NaN,0):null}function rv(t){return new xn(t>>16&255,t>>8&255,t&255,1)}function qu(t,e,n,r){return r<=0&&(t=e=n=NaN),new xn(t,e,n,r)}function X2(t){return t instanceof Jl||(t=Li(t)),t?(t=t.rgb(),new xn(t.r,t.g,t.b,t.opacity)):new xn}function wp(t,e,n,r){return arguments.length===1?X2(t):new xn(t,e,n,r??1)}function xn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}tg(xn,wp,Hx(Jl,{brighter(t){return t=t==null?nh:Math.pow(nh,t),new xn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Rl:Math.pow(Rl,t),new xn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xn(ws(this.r),ws(this.g),ws(this.b),rh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iv,formatHex:iv,formatHex8:J2,formatRgb:sv,toString:sv}));function iv(){return`#${ms(this.r)}${ms(this.g)}${ms(this.b)}`}function J2(){return`#${ms(this.r)}${ms(this.g)}${ms(this.b)}${ms((isNaN(this.opacity)?1:this.opacity)*255)}`}function sv(){const t=rh(this.opacity);return`${t===1?"rgb(":"rgba("}${ws(this.r)}, ${ws(this.g)}, ${ws(this.b)}${t===1?")":`, ${t})`}`}function rh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ws(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ms(t){return t=ws(t),(t<16?"0":"")+t.toString(16)}function ov(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new er(t,e,n,r)}function Kx(t){if(t instanceof er)return new er(t.h,t.s,t.l,t.opacity);if(t instanceof Jl||(t=Li(t)),!t)return new er;if(t instanceof er)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,u=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new er(o,a,u,t.opacity)}function Z2(t,e,n,r){return arguments.length===1?Kx(t):new er(t,e,n,r??1)}function er(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}tg(er,Z2,Hx(Jl,{brighter(t){return t=t==null?nh:Math.pow(nh,t),new er(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Rl:Math.pow(Rl,t),new er(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new xn(Yd(t>=240?t-240:t+120,i,r),Yd(t,i,r),Yd(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new er(av(this.h),Gu(this.s),Gu(this.l),rh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=rh(this.opacity);return`${t===1?"hsl(":"hsla("}${av(this.h)}, ${Gu(this.s)*100}%, ${Gu(this.l)*100}%${t===1?")":`, ${t})`}`}}));function av(t){return t=(t||0)%360,t<0?t+360:t}function Gu(t){return Math.max(0,Math.min(1,t||0))}function Yd(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Wx=t=>()=>t;function eR(t,e){return function(n){return t+n*e}}function tR(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function nR(t){return(t=+t)==1?Qx:function(e,n){return n-e?tR(e,n,t):Wx(isNaN(e)?n:e)}}function Qx(t,e){var n=e-t;return n?eR(t,n):Wx(isNaN(t)?e:t)}const lv=function t(e){var n=nR(e);function r(i,s){var o=n((i=wp(i)).r,(s=wp(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),c=Qx(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=a(h),i.b=u(h),i.opacity=c(h),i+""}}return r.gamma=t,r}(1);function di(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var xp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xd=new RegExp(xp.source,"g");function rR(t){return function(){return t}}function iR(t){return function(e){return t(e)+""}}function sR(t,e){var n=xp.lastIndex=Xd.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(t=t+"",e=e+"";(r=xp.exec(t))&&(i=Xd.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:di(r,i)})),n=Xd.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?iR(u[0].x):rR(e):(e=u.length,function(c){for(var h=0,f;h<e;++h)a[(f=u[h]).i]=f.x(c);return a.join("")})}var uv=180/Math.PI,Ep={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Yx(t,e,n,r,i,s){var o,a,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*uv,skewX:Math.atan(u)*uv,scaleX:o,scaleY:a}}var Hu;function oR(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ep:Yx(e.a,e.b,e.c,e.d,e.e,e.f)}function aR(t){return t==null||(Hu||(Hu=document.createElementNS("http://www.w3.org/2000/svg","g")),Hu.setAttribute("transform",t),!(t=Hu.transform.baseVal.consolidate()))?Ep:(t=t.matrix,Yx(t.a,t.b,t.c,t.d,t.e,t.f))}function Xx(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,h,f,m,g,b){if(c!==f||h!==m){var I=g.push("translate(",null,e,null,n);b.push({i:I-4,x:di(c,f)},{i:I-2,x:di(h,m)})}else(f||m)&&g.push("translate("+f+e+m+n)}function o(c,h,f,m){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),m.push({i:f.push(i(f)+"rotate(",null,r)-2,x:di(c,h)})):h&&f.push(i(f)+"rotate("+h+r)}function a(c,h,f,m){c!==h?m.push({i:f.push(i(f)+"skewX(",null,r)-2,x:di(c,h)}):h&&f.push(i(f)+"skewX("+h+r)}function u(c,h,f,m,g,b){if(c!==f||h!==m){var I=g.push(i(g)+"scale(",null,",",null,")");b.push({i:I-4,x:di(c,f)},{i:I-2,x:di(h,m)})}else(f!==1||m!==1)&&g.push(i(g)+"scale("+f+","+m+")")}return function(c,h){var f=[],m=[];return c=t(c),h=t(h),s(c.translateX,c.translateY,h.translateX,h.translateY,f,m),o(c.rotate,h.rotate,f,m),a(c.skewX,h.skewX,f,m),u(c.scaleX,c.scaleY,h.scaleX,h.scaleY,f,m),c=h=null,function(g){for(var b=-1,I=m.length,P;++b<I;)f[(P=m[b]).i]=P.x(g);return f.join("")}}}var lR=Xx(oR,"px, ","px)","deg)"),uR=Xx(aR,", ",")",")"),cR=1e-12;function cv(t){return((t=Math.exp(t))+1/t)/2}function hR(t){return((t=Math.exp(t))-1/t)/2}function dR(t){return((t=Math.exp(2*t))-1)/(t+1)}const fR=function t(e,n,r){function i(s,o){var a=s[0],u=s[1],c=s[2],h=o[0],f=o[1],m=o[2],g=h-a,b=f-u,I=g*g+b*b,P,y;if(I<cR)y=Math.log(m/c)/e,P=function(E){return[a+E*g,u+E*b,c*Math.exp(e*E*y)]};else{var _=Math.sqrt(I),T=(m*m-c*c+r*I)/(2*c*n*_),C=(m*m-c*c-r*I)/(2*m*n*_),F=Math.log(Math.sqrt(T*T+1)-T),j=Math.log(Math.sqrt(C*C+1)-C);y=(j-F)/e,P=function(E){var w=E*y,k=cv(F),A=c/(n*_)*(k*dR(e*w+F)-hR(F));return[a+A*g,u+A*b,c*k/cv(e*w+F)]}}return P.duration=y*1e3*e/Math.SQRT2,P}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return t(o,a,u)},i}(Math.SQRT2,2,4);var qo=0,Ba=0,Ca=0,Jx=1e3,ih,$a,sh=0,Cs=0,Hh=0,Cl=typeof performance=="object"&&performance.now?performance:Date,Zx=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ng(){return Cs||(Zx(pR),Cs=Cl.now()+Hh)}function pR(){Cs=0}function oh(){this._call=this._time=this._next=null}oh.prototype=rg.prototype={constructor:oh,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ng():+n)+(e==null?0:+e),!this._next&&$a!==this&&($a?$a._next=this:ih=this,$a=this),this._call=t,this._time=n,Ip()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ip())}};function rg(t,e,n){var r=new oh;return r.restart(t,e,n),r}function mR(){ng(),++qo;for(var t=ih,e;t;)(e=Cs-t._time)>=0&&t._call.call(void 0,e),t=t._next;--qo}function hv(){Cs=(sh=Cl.now())+Hh,qo=Ba=0;try{mR()}finally{qo=0,yR(),Cs=0}}function gR(){var t=Cl.now(),e=t-sh;e>Jx&&(Hh-=e,sh=t)}function yR(){for(var t,e=ih,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ih=n);$a=t,Ip(r)}function Ip(t){if(!qo){Ba&&(Ba=clearTimeout(Ba));var e=t-Cs;e>24?(t<1/0&&(Ba=setTimeout(hv,t-Cl.now()-Hh)),Ca&&(Ca=clearInterval(Ca))):(Ca||(sh=Cl.now(),Ca=setInterval(gR,Jx)),qo=1,Zx(hv))}}function dv(t,e,n){var r=new oh;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var vR=qh("start","end","cancel","interrupt"),_R=[],eE=0,fv=1,Tp=2,pc=3,pv=4,Sp=5,mc=6;function Kh(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;wR(t,n,{name:e,index:r,group:i,on:vR,tween:_R,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:eE})}function ig(t,e){var n=or(t,e);if(n.state>eE)throw new Error("too late; already scheduled");return n}function _r(t,e){var n=or(t,e);if(n.state>pc)throw new Error("too late; already running");return n}function or(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function wR(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=rg(s,0,n.time);function s(c){n.state=fv,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,f,m,g;if(n.state!==fv)return u();for(h in r)if(g=r[h],g.name===n.name){if(g.state===pc)return dv(o);g.state===pv?(g.state=mc,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[h]):+h<e&&(g.state=mc,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[h])}if(dv(function(){n.state===pc&&(n.state=pv,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Tp,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Tp){for(n.state=pc,i=new Array(m=n.tween.length),h=0,f=-1;h<m;++h)(g=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=g);i.length=f+1}}function a(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=Sp,1),f=-1,m=i.length;++f<m;)i[f].call(t,h);n.state===Sp&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=mc,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function gc(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>Tp&&r.state<Sp,r.state=mc,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function xR(t){return this.each(function(){gc(this,t)})}function ER(t,e){var n,r;return function(){var i=_r(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function IR(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=_r(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=a;break}u===c&&i.push(a)}s.tween=i}}function TR(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=or(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?ER:IR)(n,t,e))}function sg(t,e,n){var r=t._id;return t.each(function(){var i=_r(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return or(i,r).value[e]}}function tE(t,e){var n;return(typeof e=="number"?di:e instanceof Li?lv:(n=Li(e))?(e=n,lv):sR)(t,e)}function SR(t){return function(){this.removeAttribute(t)}}function kR(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bR(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function AR(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function RR(t,e,n){var r,i,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),u=a+"",o===u?null:o===r&&u===i?s:(i=u,s=e(r=o,a)))}}function PR(t,e,n){var r,i,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),u=a+"",o===u?null:o===r&&u===i?s:(i=u,s=e(r=o,a)))}}function CR(t,e){var n=Gh(t),r=n==="transform"?uR:tE;return this.attrTween(t,typeof e=="function"?(n.local?PR:RR)(n,r,sg(this,"attr."+t,e)):e==null?(n.local?kR:SR)(n):(n.local?AR:bR)(n,r,e))}function NR(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function DR(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function VR(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&DR(t,s)),n}return i._value=e,i}function MR(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&NR(t,s)),n}return i._value=e,i}function OR(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Gh(t);return this.tween(n,(r.local?VR:MR)(r,e))}function LR(t,e){return function(){ig(this,t).delay=+e.apply(this,arguments)}}function FR(t,e){return e=+e,function(){ig(this,t).delay=e}}function jR(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?LR:FR)(e,t)):or(this.node(),e).delay}function zR(t,e){return function(){_r(this,t).duration=+e.apply(this,arguments)}}function UR(t,e){return e=+e,function(){_r(this,t).duration=e}}function BR(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?zR:UR)(e,t)):or(this.node(),e).duration}function $R(t,e){if(typeof e!="function")throw new Error;return function(){_r(this,t).ease=e}}function qR(t){var e=this._id;return arguments.length?this.each($R(e,t)):or(this.node(),e).ease}function GR(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;_r(this,t).ease=n}}function HR(t){if(typeof t!="function")throw new Error;return this.each(GR(this._id,t))}function KR(t){typeof t!="function"&&(t=Ox(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],u,c=0;c<o;++c)(u=s[c])&&t.call(u,u.__data__,c,s)&&a.push(u);return new Wr(r,this._parents,this._name,this._id)}function WR(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var u=e[a],c=n[a],h=u.length,f=o[a]=new Array(h),m,g=0;g<h;++g)(m=u[g]||c[g])&&(f[g]=m);for(;a<r;++a)o[a]=e[a];return new Wr(o,this._parents,this._name,this._id)}function QR(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function YR(t,e,n){var r,i,s=QR(e)?ig:_r;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function XR(t,e){var n=this._id;return arguments.length<2?or(this.node(),n).on.on(t):this.each(YR(n,t,e))}function JR(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function ZR(){return this.on("end.remove",JR(this._id))}function eP(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Zm(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],u=a.length,c=s[o]=new Array(u),h,f,m=0;m<u;++m)(h=a[m])&&(f=t.call(h,h.__data__,m,a))&&("__data__"in h&&(f.__data__=h.__data__),c[m]=f,Kh(c[m],e,n,m,c,or(h,n)));return new Wr(s,this._parents,e,n)}function tP(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Mx(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var u=r[a],c=u.length,h,f=0;f<c;++f)if(h=u[f]){for(var m=t.call(h,h.__data__,f,u),g,b=or(h,n),I=0,P=m.length;I<P;++I)(g=m[I])&&Kh(g,e,n,I,m,b);s.push(m),o.push(h)}return new Wr(s,o,e,n)}var nP=Xl.prototype.constructor;function rP(){return new nP(this._groups,this._parents)}function iP(t,e){var n,r,i;return function(){var s=$o(this,t),o=(this.style.removeProperty(t),$o(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function nE(t){return function(){this.style.removeProperty(t)}}function sP(t,e,n){var r,i=n+"",s;return function(){var o=$o(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function oP(t,e,n){var r,i,s;return function(){var o=$o(this,t),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(t),$o(this,t))),o===u?null:o===r&&u===i?s:(i=u,s=e(r=o,a))}}function aP(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var u=_r(this,t),c=u.on,h=u.value[s]==null?a||(a=nE(e)):void 0;(c!==n||i!==h)&&(r=(n=c).copy()).on(o,i=h),u.on=r}}function lP(t,e,n){var r=(t+="")=="transform"?lR:tE;return e==null?this.styleTween(t,iP(t,r)).on("end.style."+t,nE(t)):typeof e=="function"?this.styleTween(t,oP(t,r,sg(this,"style."+t,e))).each(aP(this._id,t)):this.styleTween(t,sP(t,r,e),n).on("end.style."+t,null)}function uP(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function cP(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&uP(t,o,n)),r}return s._value=e,s}function hP(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,cP(t,e,n??""))}function dP(t){return function(){this.textContent=t}}function fP(t){return function(){var e=t(this);this.textContent=e??""}}function pP(t){return this.tween("text",typeof t=="function"?fP(sg(this,"text",t)):dP(t==null?"":t+""))}function mP(t){return function(e){this.textContent=t.call(this,e)}}function gP(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&mP(i)),e}return r._value=t,r}function yP(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,gP(t))}function vP(){for(var t=this._name,e=this._id,n=rE(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,u,c=0;c<a;++c)if(u=o[c]){var h=or(u,e);Kh(u,t,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Wr(r,this._parents,t,n)}function _P(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},u={value:function(){--i===0&&s()}};n.each(function(){var c=_r(this,r),h=c.on;h!==t&&(e=(t=h).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),c.on=e}),i===0&&s()})}var wP=0;function Wr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function rE(){return++wP}var br=Xl.prototype;Wr.prototype={constructor:Wr,select:eP,selectAll:tP,selectChild:br.selectChild,selectChildren:br.selectChildren,filter:KR,merge:WR,selection:rP,transition:vP,call:br.call,nodes:br.nodes,node:br.node,size:br.size,empty:br.empty,each:br.each,on:XR,attr:CR,attrTween:OR,style:lP,styleTween:hP,text:pP,textTween:yP,remove:ZR,tween:TR,delay:jR,duration:BR,ease:qR,easeVarying:HR,end:_P,[Symbol.iterator]:br[Symbol.iterator]};const xP=t=>+t;function EP(t){return t*t}function IP(t){return t*(2-t)}function TP(t){return--t*t*t+1}function SP(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function Nl(t){return(Math.pow(2,-10*t)-.0009765625)*1.0009775171065494}function mv(t){return 1-Nl(t)}var og=1.70158,Jd=function t(e){e=+e;function n(r){return(r=+r)*r*(e*(r-1)+r)}return n.overshoot=t,n}(og);(function t(e){e=+e;function n(r){return--r*r*((r+1)*e+r)+1}return n.overshoot=t,n})(og);(function t(e){e=+e;function n(r){return((r*=2)<1?r*r*((e+1)*r-e):(r-=2)*r*((e+1)*r+e)+2)/2}return n.overshoot=t,n})(og);var Go=2*Math.PI,ag=1,lg=.3;(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Go);function i(s){return e*Nl(- --s)*Math.sin((r-s)/n)}return i.amplitude=function(s){return t(s,n*Go)},i.period=function(s){return t(e,s)},i})(ag,lg);var kP=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Go);function i(s){return 1-e*Nl(s=+s)*Math.sin((s+r)/n)}return i.amplitude=function(s){return t(s,n*Go)},i.period=function(s){return t(e,s)},i}(ag,lg);(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Go);function i(s){return((s=s*2-1)<0?e*Nl(-s)*Math.sin((r-s)/n):2-e*Nl(s)*Math.sin((r+s)/n))/2}return i.amplitude=function(s){return t(s,n*Go)},i.period=function(s){return t(e,s)},i})(ag,lg);var bP={time:null,delay:0,duration:250,ease:SP};function AP(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function RP(t){var e,n;t instanceof Wr?(e=t._id,t=t._name):(e=rE(),(n=bP).time=ng(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,u,c=0;c<a;++c)(u=o[c])&&Kh(u,t,e,c,o,n||AP(u,e));return new Wr(r,this._parents,t,e)}Xl.prototype.interrupt=xR;Xl.prototype.transition=RP;function PP(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return iE(this.cover(e,n),e,n,t)}function iE(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,s=t._root,o={data:r},a=t._x0,u=t._y0,c=t._x1,h=t._y1,f,m,g,b,I,P,y,_;if(!s)return t._root=o,t;for(;s.length;)if((I=e>=(f=(a+c)/2))?a=f:c=f,(P=n>=(m=(u+h)/2))?u=m:h=m,i=s,!(s=s[y=P<<1|I]))return i[y]=o,t;if(g=+t._x.call(null,s.data),b=+t._y.call(null,s.data),e===g&&n===b)return o.next=s,i?i[y]=o:t._root=o,t;do i=i?i[y]=new Array(4):t._root=new Array(4),(I=e>=(f=(a+c)/2))?a=f:c=f,(P=n>=(m=(u+h)/2))?u=m:h=m;while((y=P<<1|I)===(_=(b>=m)<<1|g>=f));return i[_]=s,i[y]=o,t}function CP(t){var e,n,r=t.length,i,s,o=new Array(r),a=new Array(r),u=1/0,c=1/0,h=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(o[n]=i,a[n]=s,i<u&&(u=i),i>h&&(h=i),s<c&&(c=s),s>f&&(f=s));if(u>h||c>f)return this;for(this.cover(u,c).cover(h,f),n=0;n<r;++n)iE(this,o[n],a[n],t[n]);return this}function NP(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,s=(r=Math.floor(e))+1;else{for(var o=i-n||1,a=this._root,u,c;n>t||t>=i||r>e||e>=s;)switch(c=(e<r)<<1|t<n,u=new Array(4),u[c]=a,a=u,o*=2,c){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function DP(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function VP(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function on(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function MP(t,e,n){var r,i=this._x0,s=this._y0,o,a,u,c,h=this._x1,f=this._y1,m=[],g=this._root,b,I;for(g&&m.push(new on(g,i,s,h,f)),n==null?n=1/0:(i=t-n,s=e-n,h=t+n,f=e+n,n*=n);b=m.pop();)if(!(!(g=b.node)||(o=b.x0)>h||(a=b.y0)>f||(u=b.x1)<i||(c=b.y1)<s))if(g.length){var P=(o+u)/2,y=(a+c)/2;m.push(new on(g[3],P,y,u,c),new on(g[2],o,y,P,c),new on(g[1],P,a,u,y),new on(g[0],o,a,P,y)),(I=(e>=y)<<1|t>=P)&&(b=m[m.length-1],m[m.length-1]=m[m.length-1-I],m[m.length-1-I]=b)}else{var _=t-+this._x.call(null,g.data),T=e-+this._y.call(null,g.data),C=_*_+T*T;if(C<n){var F=Math.sqrt(n=C);i=t-F,s=e-F,h=t+F,f=e+F,r=g.data}}return r}function OP(t){if(isNaN(h=+this._x.call(null,t))||isNaN(f=+this._y.call(null,t)))return this;var e,n=this._root,r,i,s,o=this._x0,a=this._y0,u=this._x1,c=this._y1,h,f,m,g,b,I,P,y;if(!n)return this;if(n.length)for(;;){if((b=h>=(m=(o+u)/2))?o=m:u=m,(I=f>=(g=(a+c)/2))?a=g:c=g,e=n,!(n=n[P=I<<1|b]))return this;if(!n.length)break;(e[P+1&3]||e[P+2&3]||e[P+3&3])&&(r=e,y=P)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):e?(s?e[P]=s:delete e[P],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=s,this)}function LP(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function FP(){return this._root}function jP(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function zP(t){var e=[],n,r=this._root,i,s,o,a,u;for(r&&e.push(new on(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&r.length){var c=(s+a)/2,h=(o+u)/2;(i=r[3])&&e.push(new on(i,c,h,a,u)),(i=r[2])&&e.push(new on(i,s,h,c,u)),(i=r[1])&&e.push(new on(i,c,o,a,h)),(i=r[0])&&e.push(new on(i,s,o,c,h))}return this}function UP(t){var e=[],n=[],r;for(this._root&&e.push(new on(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,u=r.x1,c=r.y1,h=(o+u)/2,f=(a+c)/2;(s=i[0])&&e.push(new on(s,o,a,h,f)),(s=i[1])&&e.push(new on(s,h,a,u,f)),(s=i[2])&&e.push(new on(s,o,f,h,c)),(s=i[3])&&e.push(new on(s,h,f,u,c))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function BP(t){return t[0]}function $P(t){return arguments.length?(this._x=t,this):this._x}function qP(t){return t[1]}function GP(t){return arguments.length?(this._y=t,this):this._y}function ug(t,e,n){var r=new cg(e??BP,n??qP,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function cg(t,e,n,r,i,s){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function gv(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var pn=ug.prototype=cg.prototype;pn.copy=function(){var t=new cg(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=gv(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=gv(r));return t};pn.add=PP;pn.addAll=CP;pn.cover=NP;pn.data=DP;pn.extent=VP;pn.find=MP;pn.remove=OP;pn.removeAll=LP;pn.root=FP;pn.size=jP;pn.visit=zP;pn.visitAfter=UP;pn.x=$P;pn.y=GP;function zn(t){return function(){return t}}function Io(t){return(t()-.5)*1e-6}function HP(t){return t.x+t.vx}function KP(t){return t.y+t.vy}function WP(t){var e,n,r,i=1,s=1;typeof t!="function"&&(t=zn(t==null?1:+t));function o(){for(var c,h=e.length,f,m,g,b,I,P,y=0;y<s;++y)for(f=ug(e,HP,KP).visitAfter(a),c=0;c<h;++c)m=e[c],I=n[m.index],P=I*I,g=m.x+m.vx,b=m.y+m.vy,f.visit(_);function _(T,C,F,j,E){var w=T.data,k=T.r,A=I+k;if(w){if(w.index>m.index){var R=g-w.x-w.vx,N=b-w.y-w.vy,S=R*R+N*N;S<A*A&&(R===0&&(R=Io(r),S+=R*R),N===0&&(N=Io(r),S+=N*N),S=(A-(S=Math.sqrt(S)))/S*i,m.vx+=(R*=S)*(A=(k*=k)/(P+k)),m.vy+=(N*=S)*A,w.vx-=R*(A=1-A),w.vy-=N*A)}return}return C>g+A||j<g-A||F>b+A||E<b-A}}function a(c){if(c.data)return c.r=n[c.data.index];for(var h=c.r=0;h<4;++h)c[h]&&c[h].r>c.r&&(c.r=c[h].r)}function u(){if(e){var c,h=e.length,f;for(n=new Array(h),c=0;c<h;++c)f=e[c],n[f.index]=+t(f,c,e)}}return o.initialize=function(c,h){e=c,r=h,u()},o.iterations=function(c){return arguments.length?(s=+c,o):s},o.strength=function(c){return arguments.length?(i=+c,o):i},o.radius=function(c){return arguments.length?(t=typeof c=="function"?c:zn(+c),u(),o):t},o}const QP=1664525,YP=1013904223,yv=4294967296;function XP(){let t=1;return()=>(t=(QP*t+YP)%yv)/yv}function JP(t){return t.x}function ZP(t){return t.y}var eC=10,tC=Math.PI*(3-Math.sqrt(5));function nC(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,a=new Map,u=rg(f),c=qh("tick","end"),h=XP();t==null&&(t=[]);function f(){m(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function m(I){var P,y=t.length,_;I===void 0&&(I=1);for(var T=0;T<I;++T)for(n+=(s-n)*i,a.forEach(function(C){C(n)}),P=0;P<y;++P)_=t[P],_.fx==null?_.x+=_.vx*=o:(_.x=_.fx,_.vx=0),_.fy==null?_.y+=_.vy*=o:(_.y=_.fy,_.vy=0);return e}function g(){for(var I=0,P=t.length,y;I<P;++I){if(y=t[I],y.index=I,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var _=eC*Math.sqrt(.5+I),T=I*tC;y.x=_*Math.cos(T),y.y=_*Math.sin(T)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function b(I){return I.initialize&&I.initialize(t,h),I}return g(),e={tick:m,restart:function(){return u.restart(f),e},stop:function(){return u.stop(),e},nodes:function(I){return arguments.length?(t=I,g(),a.forEach(b),e):t},alpha:function(I){return arguments.length?(n=+I,e):n},alphaMin:function(I){return arguments.length?(r=+I,e):r},alphaDecay:function(I){return arguments.length?(i=+I,e):+i},alphaTarget:function(I){return arguments.length?(s=+I,e):s},velocityDecay:function(I){return arguments.length?(o=1-I,e):1-o},randomSource:function(I){return arguments.length?(h=I,a.forEach(b),e):h},force:function(I,P){return arguments.length>1?(P==null?a.delete(I):a.set(I,b(P)),e):a.get(I)},find:function(I,P,y){var _=0,T=t.length,C,F,j,E,w;for(y==null?y=1/0:y*=y,_=0;_<T;++_)E=t[_],C=I-E.x,F=P-E.y,j=C*C+F*F,j<y&&(w=E,y=j);return w},on:function(I,P){return arguments.length>1?(c.on(I,P),e):c.on(I)}}}function rC(){var t,e,n,r,i=zn(-30),s,o=1,a=1/0,u=.81;function c(g){var b,I=t.length,P=ug(t,JP,ZP).visitAfter(f);for(r=g,b=0;b<I;++b)e=t[b],P.visit(m)}function h(){if(t){var g,b=t.length,I;for(s=new Array(b),g=0;g<b;++g)I=t[g],s[I.index]=+i(I,g,t)}}function f(g){var b=0,I,P,y=0,_,T,C;if(g.length){for(_=T=C=0;C<4;++C)(I=g[C])&&(P=Math.abs(I.value))&&(b+=I.value,y+=P,_+=P*I.x,T+=P*I.y);g.x=_/y,g.y=T/y}else{I=g,I.x=I.data.x,I.y=I.data.y;do b+=s[I.data.index];while(I=I.next)}g.value=b}function m(g,b,I,P){if(!g.value)return!0;var y=g.x-e.x,_=g.y-e.y,T=P-b,C=y*y+_*_;if(T*T/u<C)return C<a&&(y===0&&(y=Io(n),C+=y*y),_===0&&(_=Io(n),C+=_*_),C<o&&(C=Math.sqrt(o*C)),e.vx+=y*g.value*r/C,e.vy+=_*g.value*r/C),!0;if(g.length||C>=a)return;(g.data!==e||g.next)&&(y===0&&(y=Io(n),C+=y*y),_===0&&(_=Io(n),C+=_*_),C<o&&(C=Math.sqrt(o*C)));do g.data!==e&&(T=s[g.data.index]*r/C,e.vx+=y*T,e.vy+=_*T);while(g=g.next)}return c.initialize=function(g,b){t=g,n=b,h()},c.strength=function(g){return arguments.length?(i=typeof g=="function"?g:zn(+g),h(),c):i},c.distanceMin=function(g){return arguments.length?(o=g*g,c):Math.sqrt(o)},c.distanceMax=function(g){return arguments.length?(a=g*g,c):Math.sqrt(a)},c.theta=function(g){return arguments.length?(u=g*g,c):Math.sqrt(u)},c}function iC(t){var e=zn(.1),n,r,i;typeof t!="function"&&(t=zn(t==null?0:+t));function s(a){for(var u=0,c=n.length,h;u<c;++u)h=n[u],h.vx+=(i[u]-h.x)*r[u]*a}function o(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:zn(+a),o(),s):e},s.x=function(a){return arguments.length?(t=typeof a=="function"?a:zn(+a),o(),s):t},s}function sC(t){var e=zn(.1),n,r,i;typeof t!="function"&&(t=zn(t==null?0:+t));function s(a){for(var u=0,c=n.length,h;u<c;++u)h=n[u],h.vy+=(i[u]-h.y)*r[u]*a}function o(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:zn(+a),o(),s):e},s.y=function(a){return arguments.length?(t=typeof a=="function"?a:zn(+a),o(),s):t},s}const Ku=t=>()=>t;function oC(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Or(t,e,n){this.k=t,this.x=e,this.y=n}Or.prototype={constructor:Or,scale:function(t){return t===1?this:new Or(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Or(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Dl=new Or(1,0,0);io.prototype=Or.prototype;function io(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Dl;return t.__zoom}function Zd(t){t.stopImmediatePropagation()}function Na(t){t.preventDefault(),t.stopImmediatePropagation()}function aC(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function lC(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function vv(){return this.__zoom||Dl}function uC(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function cC(){return navigator.maxTouchPoints||"ontouchstart"in this}function hC(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function dC(){var t=aC,e=lC,n=hC,r=uC,i=cC,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,u=fR,c=qh("start","zoom","end"),h,f,m,g=500,b=150,I=0,P=10;function y(O){O.property("__zoom",vv).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",A).filter(i).on("touchstart.zoom",R).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",S).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(O,Z,H,ee){var B=O.selection?O.selection():O;B.property("__zoom",vv),O!==B?F(O,Z,H,ee):B.interrupt().each(function(){j(this,arguments).event(ee).start().zoom(null,typeof Z=="function"?Z.apply(this,arguments):Z).end()})},y.scaleBy=function(O,Z,H,ee){y.scaleTo(O,function(){var B=this.__zoom.k,K=typeof Z=="function"?Z.apply(this,arguments):Z;return B*K},H,ee)},y.scaleTo=function(O,Z,H,ee){y.transform(O,function(){var B=e.apply(this,arguments),K=this.__zoom,W=H==null?C(B):typeof H=="function"?H.apply(this,arguments):H,X=K.invert(W),se=typeof Z=="function"?Z.apply(this,arguments):Z;return n(T(_(K,se),W,X),B,o)},H,ee)},y.translateBy=function(O,Z,H,ee){y.transform(O,function(){return n(this.__zoom.translate(typeof Z=="function"?Z.apply(this,arguments):Z,typeof H=="function"?H.apply(this,arguments):H),e.apply(this,arguments),o)},null,ee)},y.translateTo=function(O,Z,H,ee,B){y.transform(O,function(){var K=e.apply(this,arguments),W=this.__zoom,X=ee==null?C(K):typeof ee=="function"?ee.apply(this,arguments):ee;return n(Dl.translate(X[0],X[1]).scale(W.k).translate(typeof Z=="function"?-Z.apply(this,arguments):-Z,typeof H=="function"?-H.apply(this,arguments):-H),K,o)},ee,B)};function _(O,Z){return Z=Math.max(s[0],Math.min(s[1],Z)),Z===O.k?O:new Or(Z,O.x,O.y)}function T(O,Z,H){var ee=Z[0]-H[0]*O.k,B=Z[1]-H[1]*O.k;return ee===O.x&&B===O.y?O:new Or(O.k,ee,B)}function C(O){return[(+O[0][0]+ +O[1][0])/2,(+O[0][1]+ +O[1][1])/2]}function F(O,Z,H,ee){O.on("start.zoom",function(){j(this,arguments).event(ee).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(ee).end()}).tween("zoom",function(){var B=this,K=arguments,W=j(B,K).event(ee),X=e.apply(B,K),se=H==null?C(X):typeof H=="function"?H.apply(B,K):H,ye=Math.max(X[1][0]-X[0][0],X[1][1]-X[0][1]),$=B.__zoom,ne=typeof Z=="function"?Z.apply(B,K):Z,de=u($.invert(se).concat(ye/$.k),ne.invert(se).concat(ye/ne.k));return function(ae){if(ae===1)ae=ne;else{var ge=de(ae),Me=ye/ge[2];ae=new Or(Me,se[0]-ge[0]*Me,se[1]-ge[1]*Me)}W.zoom(null,ae)}})}function j(O,Z,H){return!H&&O.__zooming||new E(O,Z)}function E(O,Z){this.that=O,this.args=Z,this.active=0,this.sourceEvent=null,this.extent=e.apply(O,Z),this.taps=0}E.prototype={event:function(O){return O&&(this.sourceEvent=O),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(O,Z){return this.mouse&&O!=="mouse"&&(this.mouse[1]=Z.invert(this.mouse[0])),this.touch0&&O!=="touch"&&(this.touch0[1]=Z.invert(this.touch0[0])),this.touch1&&O!=="touch"&&(this.touch1[1]=Z.invert(this.touch1[0])),this.that.__zoom=Z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(O){var Z=Ut(this.that).datum();c.call(O,this.that,new oC(O,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),Z)}};function w(O,...Z){if(!t.apply(this,arguments))return;var H=j(this,Z).event(O),ee=this.__zoom,B=Math.max(s[0],Math.min(s[1],ee.k*Math.pow(2,r.apply(this,arguments)))),K=ts(O);if(H.wheel)(H.mouse[0][0]!==K[0]||H.mouse[0][1]!==K[1])&&(H.mouse[1]=ee.invert(H.mouse[0]=K)),clearTimeout(H.wheel);else{if(ee.k===B)return;H.mouse=[K,ee.invert(K)],gc(this),H.start()}Na(O),H.wheel=setTimeout(W,b),H.zoom("mouse",n(T(_(ee,B),H.mouse[0],H.mouse[1]),H.extent,o));function W(){H.wheel=null,H.end()}}function k(O,...Z){if(m||!t.apply(this,arguments))return;var H=O.currentTarget,ee=j(this,Z,!0).event(O),B=Ut(O.view).on("mousemove.zoom",se,!0).on("mouseup.zoom",ye,!0),K=ts(O,H),W=O.clientX,X=O.clientY;z2(O.view),Zd(O),ee.mouse=[K,this.__zoom.invert(K)],gc(this),ee.start();function se($){if(Na($),!ee.moved){var ne=$.clientX-W,de=$.clientY-X;ee.moved=ne*ne+de*de>I}ee.event($).zoom("mouse",n(T(ee.that.__zoom,ee.mouse[0]=ts($,H),ee.mouse[1]),ee.extent,o))}function ye($){B.on("mousemove.zoom mouseup.zoom",null),U2($.view,ee.moved),Na($),ee.event($).end()}}function A(O,...Z){if(t.apply(this,arguments)){var H=this.__zoom,ee=ts(O.changedTouches?O.changedTouches[0]:O,this),B=H.invert(ee),K=H.k*(O.shiftKey?.5:2),W=n(T(_(H,K),ee,B),e.apply(this,Z),o);Na(O),a>0?Ut(this).transition().duration(a).call(F,W,ee,O):Ut(this).call(y.transform,W,ee,O)}}function R(O,...Z){if(t.apply(this,arguments)){var H=O.touches,ee=H.length,B=j(this,Z,O.changedTouches.length===ee).event(O),K,W,X,se;for(Zd(O),W=0;W<ee;++W)X=H[W],se=ts(X,this),se=[se,this.__zoom.invert(se),X.identifier],B.touch0?!B.touch1&&B.touch0[2]!==se[2]&&(B.touch1=se,B.taps=0):(B.touch0=se,K=!0,B.taps=1+!!h);h&&(h=clearTimeout(h)),K&&(B.taps<2&&(f=se[0],h=setTimeout(function(){h=null},g)),gc(this),B.start())}}function N(O,...Z){if(this.__zooming){var H=j(this,Z).event(O),ee=O.changedTouches,B=ee.length,K,W,X,se;for(Na(O),K=0;K<B;++K)W=ee[K],X=ts(W,this),H.touch0&&H.touch0[2]===W.identifier?H.touch0[0]=X:H.touch1&&H.touch1[2]===W.identifier&&(H.touch1[0]=X);if(W=H.that.__zoom,H.touch1){var ye=H.touch0[0],$=H.touch0[1],ne=H.touch1[0],de=H.touch1[1],ae=(ae=ne[0]-ye[0])*ae+(ae=ne[1]-ye[1])*ae,ge=(ge=de[0]-$[0])*ge+(ge=de[1]-$[1])*ge;W=_(W,Math.sqrt(ae/ge)),X=[(ye[0]+ne[0])/2,(ye[1]+ne[1])/2],se=[($[0]+de[0])/2,($[1]+de[1])/2]}else if(H.touch0)X=H.touch0[0],se=H.touch0[1];else return;H.zoom("touch",n(T(W,X,se),H.extent,o))}}function S(O,...Z){if(this.__zooming){var H=j(this,Z).event(O),ee=O.changedTouches,B=ee.length,K,W;for(Zd(O),m&&clearTimeout(m),m=setTimeout(function(){m=null},g),K=0;K<B;++K)W=ee[K],H.touch0&&H.touch0[2]===W.identifier?delete H.touch0:H.touch1&&H.touch1[2]===W.identifier&&delete H.touch1;if(H.touch1&&!H.touch0&&(H.touch0=H.touch1,delete H.touch1),H.touch0)H.touch0[1]=this.__zoom.invert(H.touch0[0]);else if(H.end(),H.taps===2&&(W=ts(W,this),Math.hypot(f[0]-W[0],f[1]-W[1])<P)){var X=Ut(this).on("dblclick.zoom");X&&X.apply(this,arguments)}}}return y.wheelDelta=function(O){return arguments.length?(r=typeof O=="function"?O:Ku(+O),y):r},y.filter=function(O){return arguments.length?(t=typeof O=="function"?O:Ku(!!O),y):t},y.touchable=function(O){return arguments.length?(i=typeof O=="function"?O:Ku(!!O),y):i},y.extent=function(O){return arguments.length?(e=typeof O=="function"?O:Ku([[+O[0][0],+O[0][1]],[+O[1][0],+O[1][1]]]),y):e},y.scaleExtent=function(O){return arguments.length?(s[0]=+O[0],s[1]=+O[1],y):[s[0],s[1]]},y.translateExtent=function(O){return arguments.length?(o[0][0]=+O[0][0],o[1][0]=+O[1][0],o[0][1]=+O[0][1],o[1][1]=+O[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(O){return arguments.length?(n=O,y):n},y.duration=function(O){return arguments.length?(a=+O,y):a},y.interpolate=function(O){return arguments.length?(u=O,y):u},y.on=function(){var O=c.on.apply(c,arguments);return O===c?y:O},y.clickDistance=function(O){return arguments.length?(I=(O=+O)*O,y):Math.sqrt(I)},y.tapDistance=function(O){return arguments.length?(P=+O,y):P},y}const ui=["#ef4444","#f97316","#ffb300","#22c55e","#3b82f6","#a855f7"],Co=20,gs=220,_v=50,wv=600,sE="transition-all duration-200 active:scale-95",ah=`p-3 rounded-2xl shadow-lg ${sE} bg-white/40 dark:bg-slate-900/40 backdrop-blur-xl border border-white/40 dark:border-white/10 text-slate-700 dark:text-white/80 hover:bg-white/60 dark:hover:bg-slate-900/60 hover:scale-105 hover:text-slate-900 dark:hover:text-white flex items-center justify-center`,xs="bg-white/60 dark:bg-slate-900/60 backdrop-blur-3xl border border-white/50 dark:border-white/10 shadow-2xl",oE="px-3 py-1.5 rounded-lg bg-white/90 dark:bg-slate-800/90 backdrop-blur-md shadow-lg border border-slate-200 dark:border-slate-700 text-slate-900 dark:text-white text-[10px] font-bold tracking-wide uppercase whitespace-nowrap",hg=`relative rounded-xl border flex items-center justify-center shrink-0 group outline-none overflow-hidden ${sE}`,qa=`${hg} bg-white/30 dark:bg-white/5 border-white/40 dark:border-white/10 text-slate-600 dark:text-white/60 hover:bg-white/50 dark:hover:bg-white/10 hover:text-slate-900 dark:hover:text-white hover:border-white/60 dark:hover:border-white/20`,ef=`${hg} bg-blue-500/10 dark:bg-blue-500/20 border-blue-500/30 dark:border-blue-400/30 text-blue-700 dark:text-blue-300 shadow-[0_0_15px_rgba(59,130,246,0.15)] backdrop-blur-md`,fC=`${hg} bg-red-500/10 border-red-500/20 text-red-600 dark:text-red-400 hover:bg-red-500/20 hover:border-red-500/30`,Pr="w-full text-left px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 border flex items-center gap-3",Es="bg-white/40 dark:bg-white/10 text-slate-900 dark:text-white shadow-sm border-white/40 dark:border-white/10 backdrop-blur-md",Cr="border-transparent text-slate-500 dark:text-white/60 hover:bg-white/20 dark:hover:bg-white/5 hover:text-slate-900 dark:hover:text-white hover:border-white/20 dark:hover:border-white/5",yc=(t,e)=>{if(!e)return t/3;const n=e.split(/\s+/),r=e.length,i=t*1.35,s=n.reduce((m,g)=>m.length>g.length?m:g,""),o=i/(s.length*.55),a=r<10?.9:1.2,u=Math.sqrt(i*i/(r*a));let c=Math.min(o,u);r<=3&&(c=t*.8);const h=Math.max(10,t*.15),f=t*.65;return Math.max(h,Math.min(c,f))};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Fe=(t,e)=>{const n=L.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:u,...c},h)=>L.createElement("svg",{ref:h,...pC,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${mC(t)}`,a].join(" "),...c},[...e.map(([f,m])=>L.createElement(f,m)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=Fe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=Fe("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=Fe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=Fe("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=Fe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=Fe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=Fe("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=Fe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=Fe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=Fe("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=Fe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=Fe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=Fe("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=Fe("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=Fe("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uE=Fe("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TC=Fe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=Fe("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=Fe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Fe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=Fe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=Fe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=Fe("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=Fe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=Fe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bv=Fe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=Fe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=Fe("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=Fe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=Fe("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=Fe("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dE=Fe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);class PC{constructor(){this.ctx=null,this.isMuted=!1;try{localStorage.getItem("soundEnabled")==="false"&&(this.isMuted=!0)}catch{}}getContext(){return this.ctx||(this.ctx=new(window.AudioContext||window.webkitAudioContext)),this.ctx}setMuted(e){this.isMuted=e,this.ctx&&(e&&this.ctx.state==="running"?this.ctx.suspend():!e&&this.ctx.state==="suspended"&&this.ctx.resume())}resume(){if(this.isMuted)return;const e=this.getContext();e.state!=="running"&&e.resume().catch(n=>console.error("Audio resume failed",n))}playPop(){if(this.isMuted)return;const e=this.getContext();e.state!=="running"&&e.resume().catch(()=>{});const n=e.currentTime,r=e.createOscillator(),i=e.createGain();r.type="sine";const s=200+Math.random()*400,o=s*(2.2+Math.random()*1.5),a=n+.005;r.frequency.setValueAtTime(s,a),r.frequency.exponentialRampToValueAtTime(o,a+.12),i.gain.setValueAtTime(0,a),i.gain.linearRampToValueAtTime(.6,a+.004),i.gain.setTargetAtTime(1e-4,a+.05,.03),r.connect(i),i.connect(e.destination),r.start(a),r.stop(a+.2)}playHover(){if(this.isMuted)return;const e=this.getContext();if(e.state==="suspended")return;const n=e.createOscillator(),r=e.createGain(),i=e.currentTime+.002;n.type="sine",n.frequency.setValueAtTime(1200,i),r.gain.setValueAtTime(0,i),r.gain.linearRampToValueAtTime(.015,i+.002),r.gain.setTargetAtTime(1e-4,i+.005,.01),n.connect(r),r.connect(e.destination),n.start(i),n.stop(i+.05)}playAlert(){if(this.isMuted)return;const e=this.getContext();e.state==="suspended"&&e.resume().catch(()=>{});const n=e.currentTime;[392,493.88,587.33].forEach((i,s)=>{const o=e.createOscillator(),a=e.createGain(),u=n+s*.08;o.type="sine",o.frequency.setValueAtTime(i,u),o.frequency.exponentialRampToValueAtTime(i*2.2,u+.15),a.gain.setValueAtTime(0,u),a.gain.linearRampToValueAtTime(.4,u+.01),a.gain.exponentialRampToValueAtTime(.001,u+.15),o.connect(a),a.connect(e.destination),o.start(u),o.stop(u+.2)})}}const Nr=new PC;class CC{constructor(){this.notifiedEvents=new Set,this.enabled=!1;try{this.enabled=localStorage.getItem("notificationsEnabled")==="true";const e=localStorage.getItem("notifiedEvents");e&&(this.notifiedEvents=new Set(JSON.parse(e)))}catch{this.enabled=!1}}setEnabled(e){this.enabled=e}async requestPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.warn("Notifications not supported in this browser."),!1)}async checkAndNotify(e){if(!this.enabled||!("Notification"in window)||Notification.permission!=="granted")return;const n=new Date,r=24*60*60*1e3;for(const i of e){if(i.completed||!i.dueDate)continue;const s=new Date(i.dueDate),o=n.getTime()-s.getTime(),a=`${i.id}_${i.dueDate}`;o>=0&&o<r&&(this.notifiedEvents.has(a)||(await this.sendNotificationNow(i),this.notifiedEvents.add(a),this.saveNotifiedEvents()))}this.cleanupStaleEvents(e),this.syncWithServiceWorker(e)}async syncWithServiceWorker(e){if("serviceWorker"in navigator)try{const n=await navigator.serviceWorker.ready;if(!n||!n.active)return;const i=e.filter(s=>!s.completed&&s.dueDate).map(s=>({title:s.title||"Untitled Bubble",body:" It's time to pop this bubble!",icon:this.getBubbleIcon(s),timestamp:new Date(s.dueDate).getTime(),tag:s.id,actions:[{action:"complete",title:"Mark as Done"}]}));if(n.active.postMessage({type:"SCHEDULE_NOTIFICATIONS",payload:i}),"periodicSync"in n)try{(await navigator.permissions.query({name:"periodic-background-sync"})).state==="granted"&&await n.periodicSync.register("check-tasks",{minInterval:60*60*1e3})}catch(s){console.debug("Periodic sync registration failed",s)}}catch(n){console.error("Error syncing with service worker",n)}}cleanupStaleEvents(e){const n=new Set(e.map(i=>i.id));let r=!1;this.notifiedEvents.forEach(i=>{const[s]=i.split("_");n.has(s)||(this.notifiedEvents.delete(i),r=!0)}),r&&this.saveNotifiedEvents()}saveNotifiedEvents(){try{localStorage.setItem("notifiedEvents",JSON.stringify(Array.from(this.notifiedEvents)))}catch{}}getBubbleIcon(e){var F,j;const n=Co,r=gs,i=40,s=90,a=(Math.max(n,Math.min(r,e.size))-n)/(r-n),u=i+a*(s-i),c=e.color,h=((j=(F=Li(e.color))==null?void 0:F.brighter(.8))==null?void 0:j.toString())||e.color,f=(e.title||"").split(/\s+/),m=[];let g=f[0]||"";for(let E=1;E<f.length;E++)if((g+" "+f[E]).length<=12)g+=" "+f[E];else if(m.push(g),g=f[E],m.length>=2)break;g&&m.push(g);const b=m.slice(0,3),I=Math.max(16,26-b.length*3),P=I*1.2,_=96-(b.length-1)*P/2,T=b.map((E,w)=>{const k=E.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return`<text x="96" y="${_+w*P}" text-anchor="middle" dominant-baseline="middle" fill="white" font-family="system-ui, -apple-system, sans-serif" font-weight="bold" font-size="${I}" style="text-shadow: 0 1px 3px rgba(0,0,0,0.4);">${k}</text>`}).join(""),C=`
    <svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" viewBox="0 0 192 192">
      <defs>
        <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="${c}" stop-opacity="1"/>
          <stop offset="100%" stop-color="${h}" stop-opacity="1"/>
        </linearGradient>
      </defs>
      <circle cx="96" cy="96" r="${u}" fill="url(#grad)" />
      ${T}
    </svg>`.trim();return`data:image/svg+xml;base64,${btoa(C)}`}async sendNotificationNow(e){const n=e.title||"Untitled Bubble",i={body:" It's time to pop this bubble!",icon:this.getBubbleIcon(e),badge:"./favicon.svg",tag:e.id,requireInteraction:!0,renotify:!0,data:{taskId:e.id},vibrate:[100,50,100,50,300],actions:[{action:"complete",title:"Mark as Done"}]};try{Nr.playAlert();let s;if("serviceWorker"in navigator)try{s=await navigator.serviceWorker.ready}catch{}if(s)await s.showNotification(n,i);else{const o=new Notification(n,i);o.onclick=()=>{window.focus(),o.close()}}}catch(s){console.error("Failed to send notification",s)}}}const Ho=new CC,NC=t=>{if(!t)return"";try{const e=new Date(t);if(isNaN(e.getTime()))return"";const n=e.getTimezoneOffset()*6e4;return new Date(e.getTime()-n).toISOString().slice(0,16)}catch{return""}},Cv="relative border flex items-center justify-center shrink-0 group outline-none overflow-hidden transition-all duration-200 active:scale-95 bg-white/60 dark:bg-slate-700/60 border-white/50 dark:border-white/10 text-slate-900 dark:text-white shadow-lg hover:bg-white/80 dark:hover:bg-slate-600/80 backdrop-blur-xl font-bold tracking-wide",DC=({task:t,boards:e,startPos:n,onUpdate:r,onDelete:i,onClose:s,onPop:o})=>{var mt,Vt,mn;const[a,u]=L.useState(!1),[c,h]=L.useState(!1),[f,m]=L.useState(!1),[g,b]=L.useState(!1),[I,P]=L.useState(!1),[y,_]=L.useState(!1),[T,C]=L.useState(""),[F,j]=L.useState(!1),[E,w]=L.useState(!1),[k,A]=L.useState(!!t.title),[R,N]=L.useState({w:window.innerWidth,h:window.innerHeight}),S=R.w<768,O=L.useRef(window.innerHeight),Z=L.useRef(0),[H,ee]=L.useState(!1),[B,K]=L.useState(null),W=L.useRef(null),X=L.useRef(null),se=L.useRef(!1),ye=L.useRef(null),$=L.useRef(!1),ne=L.useRef(null),de=L.useRef(null),ae=L.useRef(null),ge=L.useRef(null),Me=L.useRef(null),U=L.useRef(null),me=L.useRef(null),fe=L.useRef(null),xe=L.useRef(null),Ce=L.useRef(t.size),qe=L.useRef(0),dt=L.useRef(0),ft=((mt=e.find(q=>q.id===t.boardId))==null?void 0:mt.name)||"Select Board";L.useEffect(()=>{const q=()=>{const V=window.innerWidth,ce=window.innerHeight;N({w:V,h:ce}),ce>O.current&&(O.current=ce),S&&F&&Date.now()-Z.current>500&&ce>O.current*.85&&(ge.current&&ge.current.blur(),j(!1))};return window.addEventListener("resize",q),window.visualViewport&&window.visualViewport.addEventListener("resize",q),()=>{window.removeEventListener("resize",q),window.visualViewport&&window.visualViewport.removeEventListener("resize",q)}},[F,S]),L.useEffect(()=>{const q=setTimeout(()=>u(!0),20),V=setTimeout(()=>w(!0),300);return()=>{clearTimeout(q),clearTimeout(V)}},[]),L.useEffect(()=>{A(!!t.title)},[t.title]),L.useEffect(()=>{F&&ge.current&&setTimeout(()=>{ge.current&&document.activeElement!==ge.current&&ge.current.focus()},100)},[F]),L.useEffect(()=>{me.current&&I&&(me.current.style.height="auto",me.current.style.height=me.current.scrollHeight+"px")},[t.description,I]),L.useEffect(()=>{y&&fe.current&&setTimeout(()=>{var q;return(q=fe.current)==null?void 0:q.focus()},100)},[y]),L.useEffect(()=>{c||(Ce.current=t.size)},[t.size,c]),L.useEffect(()=>{const q=V=>{var we,Ge;if(!H)return;const ce=V.target;!((we=W.current)!=null&&we.contains(ce))&&!((Ge=X.current)!=null&&Ge.contains(ce))&&ee(!1)};return H&&document.addEventListener("pointerdown",q,!0),()=>document.removeEventListener("pointerdown",q,!0)},[H]);const _t=q=>{q.stopPropagation(),q.preventDefault(),h(!0),j(!1);const V=window.innerWidth/2,ce=S?window.innerHeight*.35:window.innerHeight/2;qe.current=Math.hypot(q.clientX-V,q.clientY-ce),dt.current=Ce.current,q.currentTarget.setPointerCapture(q.pointerId)},ot=q=>{if(!c)return;q.stopPropagation(),q.preventDefault();const V=window.innerWidth/2,ce=S?window.innerHeight*.35:window.innerHeight/2,we=Math.hypot(q.clientX-V,q.clientY-ce),Ge=dt.current+(we-qe.current),Ne=Math.max(Co,Math.min(gs,Ge));Ce.current=Ne,Ge!==Ne&&(qe.current=we-(Ne-dt.current));const He=de.current,Kt=ae.current,gn=Ne*2,ar=gn+60;if(He){He.style.width=`${gn}px`,He.style.height=`${gn}px`;const Wt=He.querySelector(".bubble-text-inner");if(Wt){const Ws=(Wt.innerText||"").trim(),Tt=yc(Ne,Ws||"Task Name");Wt.style.fontSize=`${Tt}px`;const Qe=He.querySelector(".placeholder-text");Qe&&(Qe.style.fontSize=`${Tt}px`)}}Kt&&(Kt.style.width=`${ar}px`,Kt.style.height=`${ar}px`)},rn=q=>{if(c){h(!1),r({...t,size:Ce.current});try{q.currentTarget.releasePointerCapture(q.pointerId)}catch{}}},Ks=q=>{se.current=H,ee(!0),ye.current={x:q.clientX,y:q.clientY},$.current=!1,q.currentTarget.setPointerCapture(q.pointerId)},fa=q=>{if(!ye.current)return;const V=q.clientX-ye.current.x,ce=q.clientY-ye.current.y;if(!$.current&&Math.hypot(V,ce)>10&&($.current=!0),$.current){const Ge=document.elementsFromPoint(q.clientX,q.clientY).find(Ne=>Ne.dataset.boardId);K(Ge&&Ge.dataset.boardId||null)}},wr=q=>{$.current&&B&&(r({...t,boardId:B}),ee(!1)),ye.current=null,$.current=!1,K(null);try{q.currentTarget.releasePointerCapture(q.pointerId)}catch{}},xr=q=>{$.current||se.current&&ee(!1)},Ki=q=>{if(q.preventDefault(),!T.trim())return;const V={id:gp(),title:T.trim(),completed:!1};r({...t,subtasks:[...t.subtasks||[],V]}),C("")},It=q=>{r({...t,subtasks:(t.subtasks||[]).map(V=>V.id===q?{...V,completed:!V.completed}:V)})},wt=q=>{r({...t,subtasks:(t.subtasks||[]).filter(V=>V.id!==q)})},Wi=q=>{q.key==="Enter"&&!S&&!q.shiftKey&&(q.preventDefault(),q.currentTarget.blur())},Er=q=>{q.stopPropagation(),E&&(j(!0),Z.current=Date.now(),ge.current&&(ge.current.contentEditable="true",ge.current.focus()))},Ir=async q=>{const V=q.target.value,ce=V?new Date(V).toISOString():void 0;ce&&"Notification"in window&&Notification.permission==="default"&&await Ho.requestPermission()&&(Ho.setEnabled(!0),localStorage.setItem("notificationsEnabled","true")),r({...t,dueDate:ce})},J=t.size*2+60,ue=t.size*2,Te=Math.min(R.w,R.h)*.85,_e=ue>Te?Te/ue:1,oe=n?{left:`${n.x}px`,top:`${n.y}px`,transform:`translate(-50%, -50%) scale(${n.k})`}:{left:"50%",top:"50%",transform:`translate(-50%, -50%) scale(${_e})`},xt={left:"50%",top:S?F?"45%":"35%":"50%",transform:`translate(-50%, -50%) scale(${_e})`},tt=S?`fixed bottom-0 left-0 w-full px-5 pt-6 pb-[max(2rem,calc(env(safe-area-inset-bottom)+1.5rem))] rounded-t-[2.5rem] z-[60] max-h-[85vh] flex flex-col no-scrollbar ${xs}`:`absolute left-1/2 -translate-x-1/2 z-50 bottom-12 min-w-[360px] max-w-[95vw] rounded-[2rem] p-5 ${xs}`,Oe=S?{transform:a&&!F?"translateY(0)":"translateY(150%)",transition:"transform 0.5s cubic-bezier(0.16, 1, 0.3, 1)"}:{opacity:a?1:0,transform:a?"translate(-50%, 0)":"translate(-50%, 20px)",transition:"all 0.4s ease-out"},Xe=(q,V)=>v.jsx("div",{onPointerDown:_t,onPointerMove:ot,onPointerUp:rn,className:`absolute w-20 h-20 flex items-center justify-center pointer-events-auto z-[100] group ${q}`,style:{cursor:V,touchAction:"none"},children:v.jsx("div",{className:"w-6 h-6 bg-white rounded-full shadow-lg border-2 border-indigo-500 transition-transform group-active:scale-110 pointer-events-none"})}),pt=`linear-gradient(135deg, ${t.color} 0%, ${((mn=(Vt=Li(t.color))==null?void 0:Vt.brighter(.8))==null?void 0:mn.toString())||t.color} 100%)`,be=t.subtasks||[],We=be.length>0?be.filter(q=>q.completed).length/be.length*100:0,Dt=!k,nt=yc(t.size,t.title||"Task Name"),On=()=>v.jsxs("div",{className:"w-full flex flex-col gap-3 animate-in fade-in zoom-in-95 duration-200",children:[I&&v.jsxs("div",{className:"w-full relative group",children:[v.jsx("div",{className:"absolute top-3 left-3 text-slate-500 dark:text-white/40 pointer-events-none",children:v.jsx(xv,{size:16})}),v.jsx("textarea",{ref:me,rows:t.description?3:1,placeholder:"Add a description...",value:t.description||"",onChange:q=>r({...t,description:q.target.value}),className:"w-full transition-colors rounded-xl py-3 pl-10 pr-4 text-sm resize-none outline-none leading-relaxed custom-scrollbar bg-white/20 dark:bg-white/5 hover:bg-white/30 dark:hover:bg-white/10 focus:bg-white/40 dark:focus:bg-white/10 border border-white/30 dark:border-white/5 focus:border-slate-300 dark:focus:border-white/20 text-slate-900 dark:text-white placeholder:text-slate-500 dark:placeholder:text-white/30",style:{minHeight:"46px",maxHeight:"120px"}})]}),y&&v.jsxs("div",{className:"w-full bg-white/20 dark:bg-white/5 rounded-xl border border-white/30 dark:border-white/5 overflow-hidden flex flex-col",children:[be.length>0&&v.jsx("div",{className:"w-full h-1 bg-slate-200 dark:bg-white/10",children:v.jsx("div",{className:"h-full bg-green-500 dark:bg-green-400 transition-all duration-300",style:{width:`${We}%`}})}),v.jsxs("div",{className:"p-1 max-h-[150px] overflow-y-auto custom-scrollbar",children:[be.map(q=>v.jsxs("div",{className:"flex items-center gap-2 p-2 hover:bg-white/30 dark:hover:bg-white/5 rounded-lg group",children:[v.jsx("button",{onClick:()=>It(q.id),className:`shrink-0 transition-colors ${q.completed?"text-green-500 dark:text-green-400":"text-slate-400 dark:text-white/30 hover:text-slate-600 dark:hover:text-white/60"}`,children:q.completed?v.jsx(lE,{size:16}):v.jsx(hE,{size:16})}),v.jsx("input",{type:"text",value:q.title,onChange:V=>r({...t,subtasks:be.map(ce=>ce.id===q.id?{...ce,title:V.target.value}:ce)}),className:`flex-1 bg-transparent outline-none text-sm ${q.completed?"text-slate-500 dark:text-white/40 line-through":"text-slate-900 dark:text-white/90"}`}),v.jsx("button",{onClick:()=>wt(q.id),className:"opacity-0 group-hover:opacity-100 text-slate-400 dark:text-white/20 hover:text-red-500 dark:hover:text-red-400 transition-all px-1",children:v.jsx(dE,{size:14})})]},q.id)),v.jsxs("form",{onSubmit:Ki,className:"flex items-center gap-2 p-2",children:[v.jsx(cE,{size:16,className:"text-slate-400 dark:text-white/30 shrink-0"}),v.jsx("input",{ref:fe,type:"text",value:T,onChange:q=>C(q.target.value),placeholder:"Add subtask...",className:"flex-1 bg-transparent outline-none text-sm text-slate-900 dark:text-white placeholder:text-slate-500 dark:placeholder:text-white/30"})]})]})]})]}),ti=()=>v.jsxs("div",{className:`relative group shrink-0 z-20 ${S?"flex-1":"w-full"}`,children:[v.jsx("div",{ref:W,role:"menu","aria-label":"Select board",className:`absolute bottom-full left-0 mb-3 w-48 rounded-2xl overflow-hidden transition-all duration-300 origin-bottom z-50 ${xs}
           ${H?"opacity-100 scale-100 translate-y-0 pointer-events-auto":"opacity-0 scale-90 translate-y-4 pointer-events-none"}`,children:v.jsx("div",{className:"p-1.5 flex flex-col gap-0.5",children:e.map(q=>v.jsx("button",{"data-board-id":q.id,role:"menuitem",onClick:V=>{V.stopPropagation(),r({...t,boardId:q.id}),ee(!1)},className:`${Pr} ${t.boardId===q.id||B===q.id?Es:Cr}`,children:q.name},q.id))})}),v.jsxs("button",{ref:X,onPointerDown:Ks,onPointerMove:fa,onPointerUp:wr,onClick:xr,"aria-haspopup":"menu","aria-expanded":H,className:`w-full px-5 py-2.5 ${qa} !justify-between gap-2 cursor-pointer group-hover:text-black dark:group-hover:text-white`,children:[v.jsx("span",{className:"text-sm font-bold truncate max-w-[120px] text-left flex-1",children:ft}),v.jsx(Tv,{size:14,className:`text-slate-500 dark:text-white/40 transition-transform duration-300 ${H?"rotate-180":""}`})]})]}),Tr=()=>v.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[v.jsxs("button",{type:"button",className:`px-3 py-2.5 ${t.dueDate?ef:qa}`,children:[v.jsxs("div",{className:"flex items-center gap-1.5 pointer-events-none relative z-0",children:[v.jsx(yC,{size:18}),t.dueDate&&!S&&v.jsxs("span",{className:"ml-0.5 text-[10px] font-bold whitespace-nowrap",children:[new Date(t.dueDate).toLocaleDateString(void 0,{month:"numeric",day:"numeric"})," ",new Date(t.dueDate).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})]})]}),v.jsx("input",{ref:xe,type:"datetime-local",className:"absolute inset-0 opacity-0 w-full h-full z-10 cursor-pointer date-trigger",value:NC(t.dueDate),onChange:Ir,onClick:q=>{q.stopPropagation();try{q.currentTarget&&"showPicker"in q.currentTarget&&q.currentTarget.showPicker()}catch{}}}),v.jsx("style",{children:".date-trigger::-webkit-calendar-picker-indicator { position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: 0; margin: 0; opacity: 0; cursor: pointer; }"})]}),v.jsx("button",{onClick:()=>{P(!I),I||setTimeout(()=>{var q;return(q=me.current)==null?void 0:q.focus()},50)},className:`px-3 py-2.5 ${I||t.description?ef:qa}`,children:v.jsx(xv,{size:18})}),v.jsxs("button",{onClick:()=>_(!y),className:`px-3 py-2.5 ${y||t.subtasks&&t.subtasks.length>0?ef:qa}`,children:[v.jsx(IC,{size:18}),be.length>0&&v.jsxs("span",{className:"ml-1 text-[10px] font-bold",children:[be.filter(q=>q.completed).length,"/",be.length]})]})]}),Hn=()=>v.jsx("div",{ref:U,className:`relative z-10 shrink-0 ${S?"w-full":""}`,children:v.jsxs("div",{className:`flex items-center ${S?"justify-between px-2 py-2":"gap-2 justify-center py-2"}`,children:[ui.map(q=>v.jsx("button",{onClick:()=>r({...t,color:q}),className:`rounded-full transition-all duration-300 relative flex items-center justify-center ${S?"w-10 h-10":"w-7 h-7"} ${t.color===q?"scale-110 ring-2 ring-offset-1 ring-offset-transparent ring-white shadow-md":"hover:scale-105"}`,style:{backgroundColor:q},children:t.color===q&&v.jsx("div",{className:"absolute -bottom-2.5 w-1 h-1 bg-slate-800 dark:bg-white rounded-full opacity-60"})},q)),v.jsxs("label",{className:`rounded-full transition-transform hover:scale-110 relative flex items-center justify-center cursor-pointer overflow-hidden bg-gradient-to-br from-pink-500 via-red-500 to-yellow-500 shadow-sm ${S?"w-10 h-10":"w-7 h-7 ml-1"}`,children:[v.jsx("input",{type:"color",className:"absolute inset-0 opacity-0 cursor-pointer",value:t.color,onChange:q=>r({...t,color:q.target.value})}),v.jsx(bC,{size:S?18:12,className:"text-white drop-shadow-md"})]})]})}),ni=()=>v.jsx("button",{onClick:()=>b(!0),className:`${fC} ${S?"w-14 h-14":"p-2.5"}`,children:v.jsx(sl,{size:S?22:18})});return v.jsxs("div",{className:"absolute inset-0 z-40 overflow-hidden",onPointerUp:rn,onPointerLeave:rn,onPointerDown:()=>Nr.resume(),children:[v.jsx("div",{className:`absolute inset-0 bg-slate-200/40 dark:bg-black/40 backdrop-blur-[4px] transition-opacity duration-300 ${f?"opacity-0":"opacity-100"}`,onClick:s}),v.jsxs("div",{ref:ne,className:`absolute pointer-events-none z-40 ${c?"":"transition-all duration-500 cubic-bezier(0.2, 0.8, 0.2, 1)"}`,style:a?xt:oe,children:[!g&&!f&&v.jsxs("div",{ref:ae,className:"resize-ring absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 border-2 border-dashed border-slate-400/30 dark:border-white/40 rounded-full pointer-events-auto",style:{width:J,height:J,touchAction:"none"},children:[Xe("-top-10 left-1/2 -translate-x-1/2","ns-resize"),Xe("-bottom-10 left-1/2 -translate-x-1/2","ns-resize"),Xe("top-1/2 -left-10 -translate-y-1/2","ew-resize"),Xe("top-1/2 -right-10 -translate-y-1/2","ew-resize")]}),v.jsx("div",{ref:de,onClick:Er,className:`bubble-main pointer-events-auto absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full flex items-center justify-center cursor-text ${c?"transition-none":"transition-all duration-300"}`,style:{width:ue,height:ue,background:pt,boxShadow:"0 15px 30px rgba(0,0,0,0.3)",...f?{transform:"translate(-50%, -50%) scale(1.2)",opacity:0}:{}},children:v.jsx("div",{className:"w-[65%] h-[65%] flex items-center justify-center relative",children:v.jsxs("div",{className:"relative w-full flex flex-col items-center justify-center",children:[!F&&!c&&!f&&!g&&v.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2.5 pointer-events-none z-30 animate-in fade-in slide-in-from-bottom-1 duration-500 whitespace-nowrap",children:[v.jsx("div",{className:`${oE} shadow-sm`,children:"Tap to edit"}),v.jsx("div",{className:"w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[6px] border-t-white/90 dark:border-t-slate-800/90 absolute left-1/2 -translate-x-1/2 -bottom-[6px]"})]}),Dt&&v.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10",children:v.jsx("span",{className:"placeholder-text text-white font-bold italic opacity-50 text-center leading-[1.1]",style:{fontSize:`${nt}px`},children:"Task Name"})}),v.jsx("div",{ref:ge,contentEditable:F,suppressContentEditableWarning:!0,onBlur:q=>{j(!1),r({...t,title:q.currentTarget.innerText.trim()})},onInput:q=>{var we;A(!!q.currentTarget.innerText);const V=yc(Ce.current,q.currentTarget.innerText||"Task Name");q.currentTarget.style.fontSize=`${V}px`;const ce=(we=ne.current)==null?void 0:we.querySelector(".placeholder-text");ce&&(ce.style.fontSize=`${V}px`)},onKeyDown:Wi,className:"bubble-text-inner w-full text-center text-white font-bold outline-none pointer-events-auto drop-shadow-lg transition-opacity duration-200 z-20",style:{fontSize:nt,overflowWrap:"break-word",wordWrap:"break-word",hyphens:"manual",wordBreak:"normal",whiteSpace:"normal",lineHeight:1.05,textShadow:"0 1px 3px rgba(0,0,0,0.3)",minWidth:"20px",minHeight:"1.2em"},children:t.title})]})})})]}),!f&&v.jsx("div",{ref:Me,className:`${tt} pointer-events-auto`,style:Oe,onPointerDown:q=>q.stopPropagation(),children:v.jsx("div",{className:"w-full h-full relative flex flex-col",children:g?v.jsxs("div",{className:"w-full max-w-md mx-auto p-4 bg-white/50 dark:bg-white/10 backdrop-blur-xl rounded-[2rem] border border-red-500/30 shadow-2xl animate-in fade-in zoom-in-95 duration-200",children:[v.jsxs("div",{className:"flex flex-col items-center text-center gap-3 mb-5",children:[v.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/10 dark:bg-red-500/20 flex items-center justify-center text-red-500",children:v.jsx(aE,{size:24})}),v.jsx("h3",{className:"text-slate-900 dark:text-white font-bold text-lg",children:"Delete Task?"})]}),v.jsxs("div",{className:"flex gap-3 w-full",children:[v.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-3 bg-slate-200 dark:bg-white/10 hover:bg-slate-300 dark:hover:bg-white/20 rounded-xl text-slate-800 dark:text-white font-semibold transition-colors",children:"Cancel"}),v.jsx("button",{onClick:()=>{i(t.id),s()},className:"flex-1 py-3 bg-red-600 hover:bg-red-500 rounded-xl text-white font-bold shadow-lg shadow-red-500/20 transition-colors",children:"Delete"})]})]}):v.jsx(v.Fragment,{children:S?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex items-center justify-between gap-2 shrink-0 mb-4 z-20 relative",children:[ti(),Tr()]}),v.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar -mx-5 px-5 min-h-0",children:[(I||y)&&v.jsx("div",{className:"mb-3",children:On()}),v.jsx("div",{className:"flex items-center justify-center mb-4",children:v.jsx("div",{className:"overflow-x-visible w-full",children:Hn()})}),v.jsxs("div",{className:"flex items-center gap-3 pb-1",children:[ni(),v.jsxs("button",{onClick:s,className:`flex-1 h-14 rounded-2xl ${Cv} flex items-center justify-center gap-2`,children:[v.jsx(kp,{size:20}),v.jsx("span",{children:"Done"})]})]})]})]}):v.jsxs("div",{className:"flex flex-col gap-4",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3",children:[v.jsx("div",{className:"flex-1 min-w-[140px] max-w-[200px] z-20 relative",children:ti()}),Tr()]}),(I||y)&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"w-full h-px bg-slate-200 dark:bg-white/10"}),On()]}),v.jsx("div",{className:"w-full h-px bg-slate-200 dark:bg-white/10"}),v.jsxs("div",{className:"flex items-center justify-between gap-4",children:[v.jsx("div",{className:"relative z-10",children:Hn()}),v.jsxs("div",{className:"flex items-center gap-3",children:[ni(),v.jsxs("button",{onClick:s,className:`h-10 px-5 rounded-xl ${Cv} flex items-center justify-center gap-2`,children:[v.jsx(kp,{size:18}),v.jsx("span",{children:"Done"})]})]})]})]})})})}),S&&F&&v.jsx("button",{className:"fixed bottom-6 right-6 z-[100] bg-white/60 dark:bg-slate-800/60 text-slate-900 dark:text-white backdrop-blur-xl w-14 h-14 rounded-full shadow-2xl border border-white/40 dark:border-white/10 flex items-center justify-center animate-in fade-in zoom-in duration-300 pointer-events-auto active:scale-90 transition-all hover:bg-white/80 dark:hover:bg-slate-700/60",onPointerDown:q=>{var V;q.preventDefault(),q.stopPropagation(),(V=ge.current)==null||V.blur(),j(!1)},"aria-label":"Close keyboard",children:v.jsx(Tv,{size:32,strokeWidth:2.5})})]})},tf={centerX:.12,centerY:.12,vDecay:.35},nf=4,Nv=.02,Dv=60,Vv=350,VC=7e3,MC=({tasks:t,activeTask:e,boards:n,onEditTask:r,onAddTask:i,onToggleComplete:s,onDeleteTask:o,selectedTaskId:a,showCompleted:u,onToggleShowCompleted:c,isShowingCompleted:h,theme:f="dark",hideTrash:m=!1})=>{const g=L.useRef(null),b=L.useRef(null),I=L.useRef(null),P=L.useRef(null),[y,_]=L.useState({width:window.innerWidth,height:window.innerHeight}),T=L.useRef(new Set),C=L.useRef(null),[F,j]=L.useState(!1),E=L.useRef(!1),w=L.useRef(null),k=L.useRef(!1),A=L.useRef(null),R=L.useRef(null),N=L.useRef(null),[S,O]=L.useState(null),Z=L.useRef(null),H=L.useRef(!1),ee=L.useRef(null),B=L.useRef(!0),[K,W]=L.useState(!0),X=L.useRef(t.length),se=L.useRef(""),ye=L.useRef(0),$=L.useRef(.1),[ne,de]=L.useState(!1),ae=L.useRef(!1),[ge,Me]=L.useState(!1),[U,me]=L.useState(!1),[fe,xe]=L.useState(!1),[Ce,qe]=L.useState(!1),dt=L.useRef(null),ft=L.useRef(!1),_t=()=>{ft.current||(Nr.resume(),ft.current=!0)},ot=L.useCallback(()=>{_t(),B.current=!0,W(!0),qe(!1),P.current&&P.current.alpha(.3).restart()},[]);L.useEffect(()=>{B.current=!0,W(!0)},[u,n]),L.useEffect(()=>(ne&&!K?dt.current=setTimeout(()=>{qe(!0)},VC):(dt.current&&clearTimeout(dt.current),qe(!1)),()=>{dt.current&&clearTimeout(dt.current)}),[ne,K]);const rn=L.useCallback(()=>{if(A.current&&(clearTimeout(A.current),A.current=null),N.current){const J=Ut(`#node-${N.current}`);if(!J.empty()){const ue=J.datum();J.select(".pop-ring").interrupt().transition().duration(300).attr("stroke-dashoffset",2*Math.PI*(ue.r+3)),J.select(".shake-group").classed("charging-shake",!1);const Te=J.select(".inner-scale");Te.classed("is-popping")||Te.interrupt().transition().duration(400).ease(kP).attr("transform","scale(1)")}N.current=null}},[]);L.useEffect(()=>{const J=()=>{b.current&&_({width:b.current.clientWidth,height:b.current.clientHeight})};return window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]),L.useEffect(()=>(ge?R.current=setTimeout(()=>{me(!0),navigator.vibrate&&navigator.vibrate([15]),Nr.playHover()},Vv):(R.current&&clearTimeout(R.current),me(!1)),()=>{R.current&&clearTimeout(R.current)}),[ge]),L.useEffect(()=>{t.length>X.current&&(B.current=!0,W(!0)),X.current=t.length},[t.length]),L.useEffect(()=>{if(!g.current)return;const J=Ut(g.current),ue=J.select(".canvas-content");Z.current=dC().scaleExtent([Nv,nf]).filter(Te=>Te.type==="touchstart"&&Te.touches.length>1||Te.type==="wheel"?!0:!(Te.target&&Te.target.closest(".node"))).on("start",Te=>{Te.sourceEvent&&(ee.current&&(clearTimeout(ee.current),ee.current=null),H.current=!0,B.current=!1,W(!1))}).on("end",Te=>{Te.sourceEvent&&(ee.current=setTimeout(()=>{H.current=!1,ee.current=null},150))}).on("zoom",Te=>{ue.attr("transform",Te.transform.toString());const oe=Te.transform.k>$.current*1.1;oe!==ae.current&&(ae.current=oe,de(oe))}),J.call(Z.current).on("dblclick.zoom",null)},[]);const Ks=J=>{var xt;if(_t(),T.current.add(J.pointerId),T.current.size>1){if(C.current){const tt=C.current;tt.fx=null,tt.fy=null,C.current=null,E.current=!1,j(!1),Me(!1),xe(!1),rn(),P.current&&P.current.alphaTarget(0)}return}const ue=io(g.current),Te=(J.nativeEvent.offsetX-ue.x)/ue.k,_e=(J.nativeEvent.offsetY-ue.y)/ue.k;let oe;if(P.current&&(oe=P.current.find(Te,_e,gs),oe)){const tt=Te-(oe.x||0),Oe=_e-(oe.y||0);tt*tt+Oe*Oe>oe.r*oe.r&&(oe=void 0)}if(oe){if(J.stopPropagation(),J.target.setPointerCapture(J.pointerId),a&&oe.id===a)return;if(C.current=oe,xe(((xt=oe.originalTask)==null?void 0:xt.completed)||!1),w.current={x:J.clientX,y:J.clientY},E.current=!1,j(!1),k.current=!1,oe.isCenter||(oe.fx=oe.x,oe.fy=oe.y),P.current&&P.current.alphaTarget(.3).restart(),!oe.isCenter&&oe.id!==a){N.current=oe.id;const tt=Ut(`#node-${oe.id}`),Oe=tt.select(".inner-scale"),Xe=tt.select(".shake-group"),pt=tt.select(".pop-ring"),be=oe.originalTask.completed?"#22c55e":"#ef4444";pt.attr("stroke",be),Oe.transition().duration(250).ease(TP).attr("transform","scale(0.95)"),Xe.classed("charging-shake",!0),pt.style("opacity",1).transition().duration(wv).ease(EP).attr("stroke-dashoffset",0),A.current=setTimeout(()=>{!C.current||C.current.id!==(oe==null?void 0:oe.id)||(k.current=!0,Nr.playPop(),xr((oe==null?void 0:oe.x)||0,(oe==null?void 0:oe.y)||0,(oe==null?void 0:oe.originalTask.color)||"#fff",(oe==null?void 0:oe.r)||50,be),Xe.classed("charging-shake",!1),Oe.classed("is-popping",!0),Oe.interrupt().transition().duration(100).ease(Jd.overshoot(3)).attr("transform","scale(1.2)").style("opacity",0).on("end",()=>{oe&&s(oe.originalTask),Oe.classed("is-popping",!1),N.current=null,C.current=null}))},wv)}}},fa=J=>{if(!k.current&&C.current&&T.current.size===1){if(w.current){const oe=J.clientX-w.current.x,xt=J.clientY-w.current.y;Math.hypot(oe,xt)>10&&(E.current=!0,j(!0),rn())}if(C.current.isCenter)return;const ue=io(g.current);let Te=(J.nativeEvent.offsetX-ue.x)/ue.k,_e=(J.nativeEvent.offsetY-ue.y)/ue.k;if(I.current){const oe=I.current.getBoundingClientRect(),xt=J.clientX,tt=J.clientY,Oe=80,Xe=xt>=oe.left-Oe&&xt<=oe.right+Oe&&tt>=oe.top-Oe&&tt<=oe.bottom+Oe;if(Xe){const pt=oe.left+oe.width/2,be=oe.top+oe.height/2,We=(pt-ue.x)/ue.k,Dt=(be-ue.y)/ue.k,nt=.5;Te=Te*(1-nt)+We*nt,_e=_e*(1-nt)+Dt*nt}if(Xe!==ge){Me(Xe);const pt=Ut(`#node-${C.current.id}`),be=pt.select(".pop-ring"),We=pt.select(".shake-group"),Dt=C.current,nt=Dt.originalTask.completed;if(Xe){navigator.vibrate&&navigator.vibrate(20),We.classed("harsh-shake",!0);const On=nt?"#22c55e":"#ef4444";be.interrupt().style("opacity",1).attr("stroke",On).attr("stroke-dashoffset",2*Math.PI*(Dt.r+3)).transition().duration(Vv).ease(xP).attr("stroke-dashoffset",0)}else navigator.vibrate&&navigator.vibrate(10),We.classed("harsh-shake",!1),be.interrupt().transition().duration(200).attr("stroke-dashoffset",2*Math.PI*(Dt.r+3)).on("end",function(){Ut(this).style("opacity",0)})}}J.preventDefault(),J.stopPropagation(),C.current.fx=Te,C.current.fy=_e,P.current&&P.current.restart()}},wr=J=>{if(T.current.delete(J.pointerId),k.current){try{J.target.releasePointerCapture(J.pointerId)}catch{}return}if(C.current){const ue=C.current,Te=Ut(`#node-${ue.id}`);if(Te.select(".shake-group").classed("harsh-shake",!1),ge&&U){Ki(ue.originalTask,void 0,!0),Me(!1),me(!1),C.current=null,E.current=!1,j(!1),xe(!1),ue.fx=null,ue.fy=null;try{J.target.releasePointerCapture(J.pointerId)}catch{}return}else ge&&Te.select(".pop-ring").interrupt().transition().duration(200).attr("stroke-dashoffset",2*Math.PI*(ue.r+3)).style("opacity",0);if(!E.current&&!k.current&&T.current.size===0){if(ue.isCenter)a||i();else if(ue.id!==a){if(ue.x!==void 0&&ue.y!==void 0){const _e=io(g.current),oe=_e.x+ue.x*_e.k,xt=_e.y+ue.y*_e.k;O({x:oe,y:xt,k:_e.k})}r(ue.originalTask)}}!ue.isCenter&&ue.id!==a&&(ue.fx=null,ue.fy=null),C.current=null,E.current=!1,j(!1),xe(!1),Me(!1),rn(),P.current&&(P.current.alphaTarget(0),P.current.alpha(.8).restart());try{J.target.releasePointerCapture(J.pointerId)}catch{}}};L.useEffect(()=>{if(!g.current||!Z.current)return;const J=Ut(g.current);a?(J.on(".zoom",null),J.transition().duration(800).call(Z.current.transform,Dl)):(J.call(Z.current),O(null))},[a]);const xr=(J,ue,Te,_e,oe="#ef4444")=>{if(!g.current)return;const xt=Ut(g.current).select(".canvas-content"),tt=Te||"#ffffff";xt.append("circle").attr("cx",J).attr("cy",ue).attr("r",_e).attr("fill","none").attr("stroke",oe).attr("stroke-width",3).style("opacity",.6).transition().duration(500).ease(mv).attr("r",_e*2).style("opacity",0).attr("stroke-width",0).remove(),rA(16).forEach(()=>{const Xe=Math.random()*Math.PI*2,pt=_e*(.8+Math.random()*.8);xt.append("circle").attr("cx",J).attr("cy",ue).attr("r",2+Math.random()*4).attr("fill",tt).style("opacity",1).transition().delay(Math.random()*50).duration(600).ease(mv).attr("cx",J+Math.cos(Xe)*pt).attr("cy",ue+Math.sin(Xe)*pt).attr("r",0).remove()}),xt.append("circle").attr("cx",J).attr("cy",ue).attr("r",_e*.8).attr("fill","white").style("opacity",.4).transition().duration(200).ease(IP).attr("r",_e*1.4).style("opacity",0).remove()},Ki=(J,ue,Te=!1)=>{const _e=Ut(`#node-${J.id}`);if(_e.empty())return;const oe=_e.select(".inner-scale"),xt=_e.select(".pop-ring"),tt=J.completed?"#22c55e":"#ef4444";let Oe=0,Xe=0;const pt=_e.attr("transform");if(pt){const be=pt.match(/translate\(([^,]+),([^)]+)\)/);be&&(Oe=parseFloat(be[1]),Xe=parseFloat(be[2]))}if(Te&&I.current&&g.current){Nr.playPop(),xr(Oe,Xe,J.color,J.size,tt);const be=I.current.getBoundingClientRect(),We=io(g.current),Dt=(be.left+be.width/2-We.x)/We.k,nt=(be.top+be.height/2-We.y)/We.k;_e.transition().duration(400).ease(Jd.overshoot(1.5)).attr("transform",`translate(${Dt},${nt}) scale(0.1)`).style("opacity",0).on("end",()=>{s(J),r(null)});return}ue&&(Oe=ue.x,Xe=ue.y),Nr.playPop(),xr(Oe,Xe,J.color,J.size,tt),ue?setTimeout(()=>{s(J),r(null)},150):(xt.attr("stroke",tt).style("opacity",1).transition().duration(200).attr("stroke-dashoffset",0),oe.transition().duration(150).ease(Jd.overshoot(2)).attr("transform","scale(1.2)").style("opacity",0).on("end",()=>{s(J),r(null),oe.style("opacity",1).attr("transform","scale(1)")}))},It=(J,ue)=>{const Te=Math.random()*Math.PI*2,_e=Math.max(J,ue)*(1+Math.random()*.5);return{x:J/2+Math.cos(Te)*_e,y:ue/2+Math.sin(Te)*_e}};L.useEffect(()=>{var q;if(!g.current||!b.current)return;const J=y.width,ue=y.height,Te=u?t:t.filter(V=>!V.completed),_e=Te.map(V=>V.id+V.completed).join("|"),oe=_e!==se.current;se.current=_e;const xt=((q=P.current)==null?void 0:q.nodes())||[],tt=new Map(xt.map(V=>[V.id,V]));C.current&&!Te.find(V=>{var ce;return V.id===((ce=C.current)==null?void 0:ce.id)})&&(C.current=null,E.current=!1,j(!1),xe(!1),rn());const Oe=Te.map(V=>{const ce=tt.get(V.id);let we,Ge;const Ne=ce&&ce.originalTask.completed!==V.completed;if(ce&&!Ne)we=ce.x,Ge=ce.y;else{const He=It(J,ue);we=He.x,Ge=He.y}return{id:V.id,r:V.size,originalTask:V,x:we,y:Ge,vx:ce?ce.vx:0,vy:ce?ce.vy:0}}),Xe={id:"CENTER_BTN",r:_v,originalTask:{},isCenter:!0,fx:J/2,fy:ue/2,x:J/2,y:ue/2};Oe.find(V=>V.id==="CENTER_BTN")||Oe.push(Xe),P.current?(P.current.nodes(Oe),P.current.alpha(oe?.8:.3).restart()):P.current=nC(Oe).alphaMin(1e-4).alphaDecay(.02);const pt=P.current,be=Ut(g.current);let We=be.select("defs");We.empty()&&(We=be.append("defs")),We.select("#center-glass-gradient").remove(),We.select("#center-glass-gradient-hover").remove(),We.select("#center-glass-stroke").remove();const Dt=We.append("linearGradient").attr("id","center-glass-gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");f==="dark"?(Dt.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",.25),Dt.append("stop").attr("offset","100%").attr("stop-color","#94a3b8").attr("stop-opacity",.05)):(Dt.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",.9),Dt.append("stop").attr("offset","100%").attr("stop-color","#cbd5e1").attr("stop-opacity",.6));const nt=We.append("linearGradient").attr("id","center-glass-gradient-hover").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");f==="dark"?(nt.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",.35),nt.append("stop").attr("offset","100%").attr("stop-color","#cbd5e1").attr("stop-opacity",.15)):(nt.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",1),nt.append("stop").attr("offset","100%").attr("stop-color","#e2e8f0").attr("stop-opacity",.8));const On=We.append("linearGradient").attr("id","center-glass-stroke").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");f==="dark"?(On.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",.8),On.append("stop").attr("offset","100%").attr("stop-color","#ffffff").attr("stop-opacity",.1)):(On.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",1),On.append("stop").attr("offset","100%").attr("stop-color","#64748b").attr("stop-opacity",.4)),Array.from(new Set(t.map(V=>V.color).filter(Boolean))).forEach(V=>{var we,Ge;const ce=`grad-${V.replace("#","")}`;if(We.select(`#${ce}`).empty()){const Ne=We.append("linearGradient").attr("id",ce).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");Ne.append("stop").attr("offset","0%").attr("stop-color",V).attr("stop-opacity",1),Ne.append("stop").attr("offset","100%").attr("stop-color",((Ge=(we=Li(V))==null?void 0:we.brighter(.8))==null?void 0:Ge.toString())||V).attr("stop-opacity",1)}});const Tr=be.select(".canvas-content").selectAll(".node").data(Oe,V=>V.id);Tr.exit().interrupt().transition().duration(600).style("opacity",0).attr("transform",V=>`translate(${V.x},${V.y}) scale(0.1)`).remove();const Hn=Tr.enter().append("g").attr("class",V=>`node cursor-pointer group ${V.isCenter?"center-node":""}`).attr("id",V=>`node-${V.id}`),ni=Hn.append("g").attr("class","inner-scale transition-transform duration-75"),mt=ni.append("g").attr("class","shake-group");mt.append("circle").attr("class","pop-ring").attr("fill","none").attr("stroke","#ef4444").attr("stroke-width",6).attr("opacity",0).style("pointer-events","none").attr("transform","rotate(-90)"),mt.append("circle").attr("class",V=>`main-bubble transition-colors duration-300 ${V.isCenter?"backdrop-blur-xl":"backdrop-blur-sm"}`).attr("stroke-width",0),mt.append("g").attr("class","text-content pointer-events-none").append("foreignObject").append("xhtml:div").attr("class","w-full h-full flex flex-col items-center justify-center text-center overflow-visible bubble-text-container").html(V=>'<div class="bubble-text font-bold leading-tight select-none px-0.5" style="overflow-wrap: break-word; word-wrap: break-word; hyphens: manual; word-break: normal; white-space: pre-wrap; line-height: 1.1; text-shadow: 0 1px 2px rgba(0,0,0,0.3);"></div>'),ni.filter(V=>!!V.isCenter).append("foreignObject").attr("class","center-btn-container pointer-events-none").append("xhtml:div").attr("class","w-full h-full flex items-center justify-center text-white center-icon").html("");const Vt=Hn.merge(Tr);Vt.filter(V=>!!V.isCenter).raise(),Vt.interrupt().style("opacity",1),Vt.select(".inner-scale").interrupt().style("opacity",V=>V.id===a?0:1).attr("transform","scale(1)");const mn=y.width<768;return Vt.filter(V=>!!V.isCenter).select(".center-btn-container").attr("width",mn?80:48).attr("height",mn?80:48).attr("x",mn?-40:-24).attr("y",mn?-40:-24),Vt.filter(V=>!!V.isCenter).select(".center-icon").style("color",f==="dark"?"#ffffff":"#334155").html(`<div style="font-family: inherit; font-weight: 200; font-size: ${mn?56:42}px; line-height: 1; margin-top: -4px;">+</div>`),Vt.select(".main-bubble").attr("r",V=>V.r).attr("fill",V=>{if(V.isCenter)return"url(#center-glass-gradient)";if(V.originalTask.completed)return f==="dark"?"#1e293b":"#cbd5e1";const ce=V.originalTask.color;return ce?`url(#grad-${ce.replace("#","")})`:"#cccccc"}).attr("stroke",V=>V.isCenter?"url(#center-glass-stroke)":"none").attr("stroke-width",V=>V.isCenter?1.5:0).style("filter",V=>V.isCenter?f==="dark"?"drop-shadow(0px 0px 20px rgba(255,255,255,0.1)) drop-shadow(0px 15px 30px rgba(0,0,0,0.6))":"drop-shadow(0px 20px 40px rgba(0, 0, 0, 0.2)) drop-shadow(0px 10px 20px rgba(0,0,0,0.1))":f==="dark"?"drop-shadow(0px 10px 20px rgba(0,0,0,0.2))":"drop-shadow(0px 4px 16px rgba(148, 163, 184, 0.4))").attr("class",V=>`main-bubble transition-colors duration-300 ${V.isCenter?"backdrop-blur-xl":"backdrop-blur-sm"}`),Vt.select(".pop-ring").attr("r",V=>V.r+3).attr("stroke",V=>V.originalTask.completed?"#22c55e":"#ef4444").attr("stroke-dasharray",V=>2*Math.PI*(V.r+3)).attr("stroke-dashoffset",V=>2*Math.PI*(V.r+3)),Vt.select(".text-content foreignObject").attr("width",V=>V.r*1.42).attr("height",V=>V.r*1.42).attr("x",V=>-V.r*.71).attr("y",V=>-V.r*.71),Vt.select(".bubble-text-container").html(V=>{if(V.isCenter)return"";let ce='<div style="display: flex; flex-direction: column; height: 100%; justify-content: center; align-items: center; position: relative;">';const we=V.originalTask.dueDate||V.originalTask.description||V.originalTask.subtasks&&V.originalTask.subtasks.length>0;if(ce+=`<div class="bubble-text font-bold leading-tight select-none px-0.5" style="overflow-wrap: break-word; word-wrap: break-word; hyphens: manual; word-break: normal; white-space: normal; line-height: 1.05; text-shadow: 0 1px 3px rgba(0,0,0,0.3); ${we?"margin-bottom: 20px;":""}">${V.originalTask.title}</div>`,we&&V.r>40){if(ce+=`<div style="position: absolute; bottom: 4%; display: flex; align-items: center; gap: 6px; background: rgba(0,0,0,0.15); backdrop-filter: blur(4px); padding: 3px 8px; border-radius: 20px; color: white; font-weight: 600; font-size: ${Math.max(9,V.r*.14)}px; white-space: nowrap; border: 1px solid rgba(255,255,255,0.1);">`,V.originalTask.dueDate){const Ne=new Date(V.originalTask.dueDate),He=new Date,gn=Ne.getDate()===He.getDate()&&Ne.getMonth()===He.getMonth()?Ne.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):Ne.toLocaleDateString("en-US",{month:"short",day:"numeric"}),Wt=Ne<He&&!V.originalTask.completed?"color: #fca5a5;":"";ce+=`<span style="${Wt}">${gn}</span>`}if(V.originalTask.dueDate&&(V.originalTask.description||V.originalTask.subtasks&&V.originalTask.subtasks.length>0)&&(ce+='<div style="width: 3px; height: 3px; background: rgba(255,255,255,0.5); border-radius: 50%;"></div>'),V.originalTask.description){const Ne=Math.max(10,V.r*.16);ce+=`<svg width="${Ne}" height="${Ne}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.9"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>`}if(V.originalTask.subtasks&&V.originalTask.subtasks.length>0){V.originalTask.description&&(ce+='<div style="width: 3px; height: 3px; background: rgba(255,255,255,0.5); border-radius: 50%;"></div>');const Ne=V.originalTask.subtasks.filter(Kt=>Kt.completed).length,He=V.originalTask.subtasks.length;ce+=`<span>${Ne}/${He}</span>`}ce+="</div>"}return ce+="</div>",ce}),Vt.select(".bubble-text").style("color",V=>V.originalTask.completed?f==="dark"?"#94a3b8":"#64748b":"#ffffff").style("font-size",V=>{let ce=yc(V.r,V.originalTask.title);return(V.originalTask.dueDate||V.originalTask.description||V.originalTask.subtasks&&V.originalTask.subtasks.length>0)&&(ce=ce*.85),`${ce}px`}).style("opacity",V=>V.originalTask.completed?.6:1).style("text-decoration",V=>V.originalTask.completed?"line-through":"none"),Vt.style("pointer-events",V=>V.id===a?"none":"all"),pt.on("tick",()=>{if(pt.alpha()<.005&&!E.current&&!H.current&&!B.current)return;const V=y.width/2,ce=y.height/2;if(Oe.forEach(we=>{if(we.isCenter||we.id===a||we.x===void 0||we.y===void 0)return;const Ge=we.x-V,Ne=we.y-ce,He=Math.sqrt(Ge*Ge+Ne*Ne),Kt=_v+we.r+10;if(He<Kt){const gn=He===0?Math.random()*Math.PI*2:Math.atan2(Ne,Ge);we.x=V+Math.cos(gn)*Kt,we.y=ce+Math.sin(gn)*Kt,we.vx&&we.vy&&(we.vx*=.5,we.vy*=.5)}}),Vt.attr("transform",we=>`translate(${we.x},${we.y})`),Z.current&&g.current){const we=y.width/2,Ge=y.height/2;let Ne=0,He=0,Kt=!1;Oe.forEach(Qe=>{if(Qe.x===void 0||Qe.y===void 0)return;Kt=!0;const Kn=Qe.r+20,Qi=Math.abs(Qe.x-we)+Kn,Yi=Math.abs(Qe.y-Ge)+Kn;Qi>Ne&&(Ne=Qi),Yi>He&&(He=Yi)}),Kt||(Ne=100,He=100);const gn=(Ne+Dv)*2,ar=(He+Dv)*2,Wt=y.width/gn,Ws=y.height/ar;let Tt=Math.min(Wt,Ws);if(Tt=Math.min(Tt,nf),Tt=Math.max(Tt,Nv),$.current=Tt,!H.current&&Z.current&&Math.abs(Tt-ye.current)>.005){ye.current=Tt,Z.current.scaleExtent([Tt,nf]);const Qe=y.width/Tt,Kn=y.height/Tt;Z.current.translateExtent([[we-Qe/2,Ge-Kn/2],[we+Qe/2,Ge+Kn/2]])}if(!H.current&&!a){const Qe=io(be.node()),Kn=Qe.k<Tt*1.01;if(B.current||Kn){const Qi=y.width/2-we*Tt,Yi=y.height/2-Ge*Tt,pu=Qe.k+(Tt-Qe.k)*.1,Xi=Qe.x+(Qi-Qe.x)*.1,pa=Qe.y+(Yi-Qe.y)*.1;(Math.abs(pu-Qe.k)>1e-4||Math.hypot(Xi-Qe.x,pa-Qe.y)>.1)&&Z.current.transform(be,Dl.translate(Xi,pa).scale(pu))}}}}),()=>{pt.stop()}},[t,u,a,y,rn,f]),L.useEffect(()=>{if(!P.current)return;const J=P.current,ue=y.width,Te=y.height;J.force("x",iC(ue/2).strength(a?.005:tf.centerX)),J.force("y",sC(Te/2).strength(a?.005:tf.centerY)),J.force("charge",rC().strength(_e=>_e.isCenter?-600:_e.id===a?-40:-100-(_e.r?_e.r*.2:0))),J.force("collide",WP().radius(_e=>_e.id===a?Co+10:_e.isCenter?_e.r+25:_e.r+6).strength(1).iterations(40)),J.velocityDecay(tf.vDecay),J.alpha(.8).restart()},[y,a]);const wt=e||t.find(J=>J.id===a),Er=!t.some(J=>J.completed)&&!F,Ir=t.filter(J=>J.completed).length;return v.jsxs("div",{ref:b,className:"w-full h-full relative bg-slate-50 dark:bg-[#020617] overflow-hidden transition-colors duration-500",onPointerDown:_t,children:[v.jsx("style",{children:`
        @keyframes shake-charge { 0% { transform: translate(0, 0); } 25% { transform: translate(1.5px, 1.5px); } 50% { transform: translate(-1.5px, -2px); } 75% { transform: translate(-2px, 1.5px); } 100% { transform: translate(1.5px, -1.5px); } }
        @keyframes harsh-shake { 0% { transform: translate(0, 0); } 15% { transform: translate(6px, -6px); } 30% { transform: translate(-6px, 4px); } 45% { transform: translate(5px, 5px); } 60% { transform: translate(-5px, -5px); } 75% { transform: translate(4px, -3px); } 100% { transform: translate(0, 0); } }
        .charging-shake { animation: shake-charge 0.08s infinite linear; }
        .harsh-shake { animation: harsh-shake 0.1s infinite linear; }
        .center-node .main-bubble { stroke-width: 1px; transition: all 0.3s ease; }
        .center-node:hover .main-bubble { fill: url(#center-glass-gradient-hover) !important; stroke: ${f==="dark"?"#ffffff":"#94a3b8"} !important; stroke-width: 2px !important; }
        .center-node .center-icon { transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .center-node:hover .center-icon { transform: scale(1.1); }
      `}),v.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0 overflow-hidden",children:[v.jsx("div",{className:`absolute top-[-10%] right-[-10%] w-[50%] h-[50%] rounded-full bg-[#E879F9] blur-[120px] transition-opacity duration-500 ${f==="dark"?"opacity-20":"opacity-40"}`}),v.jsx("div",{className:`absolute bottom-[-10%] left-[-10%] w-[60%] h-[60%] rounded-full bg-[#22D3EE] blur-[140px] transition-opacity duration-500 ${f==="dark"?"opacity-20":"opacity-40"}`}),v.jsx("div",{className:`absolute bottom-[-20%] right-[10%] w-[40%] h-[40%] rounded-full bg-[#818CF8] blur-[100px] transition-opacity duration-500 ${f==="dark"?"opacity-20":"opacity-40"}`})]}),v.jsx("div",{className:`absolute inset-0 pointer-events-none z-20 transition-all duration-300 ease-out ${ge?"opacity-100":"opacity-0"}`,children:v.jsx("div",{className:`absolute inset-0 transition-shadow duration-300 ${fe?"shadow-[inset_0_-100px_150px_-50px_rgba(34,197,94,0.2)] dark:shadow-[inset_0_-100px_150px_-50px_rgba(34,197,94,0.3)]":"shadow-[inset_0_-100px_150px_-50px_rgba(239,68,68,0.2)] dark:shadow-[inset_0_-100px_150px_-50px_rgba(239,68,68,0.3)]"}`})}),v.jsx("div",{className:`absolute top-12 left-1/2 -translate-x-1/2 z-40 pointer-events-none transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275) ${U?"opacity-100 translate-y-0 scale-100":"opacity-0 -translate-y-8 scale-90"}`,children:v.jsxs("div",{className:`flex items-center gap-2 px-5 py-2.5 rounded-full shadow-lg border border-white/20 backdrop-blur-md transition-colors duration-300 ${fe?"bg-green-500 shadow-green-500/40":"bg-red-500 shadow-red-500/40"}`,children:[fe?v.jsx(kv,{className:"w-5 h-5 animate-spin",style:{animationDuration:"3s"}}):v.jsx(Av,{className:"w-5 h-5 animate-bounce"}),v.jsx("span",{className:"font-bold tracking-wide text-sm whitespace-nowrap text-white",children:fe?"Release to Restore":"Release to Pop"})]})}),v.jsx("svg",{ref:g,className:`absolute inset-0 w-full h-full z-10 ${a?"cursor-default":"cursor-grab active:cursor-grabbing"}`,onPointerDown:Ks,onPointerMove:fa,onPointerUp:wr,onPointerCancel:wr,onPointerLeave:wr,style:{touchAction:"none"},children:v.jsx("g",{className:"canvas-content"})}),a&&wt&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:`absolute inset-0 z-20 animate-fade-in cursor-pointer ${f==="dark"?"bg-black/40 backdrop-blur-sm":"bg-slate-200/40 backdrop-blur-sm"}`,onClick:()=>r(null)}),v.jsx("div",{className:"absolute inset-0 z-30 pointer-events-none",children:v.jsx(DC,{task:wt,boards:n,startPos:S,onUpdate:J=>r(J),onDelete:o,onClose:()=>r(null),onPop:J=>Ki(wt,J)})})]}),!a&&v.jsxs(v.Fragment,{children:[!m&&v.jsx("div",{className:"absolute bottom-[max(2.5rem,calc(env(safe-area-inset-bottom)+1.5rem))] left-8 z-30",children:v.jsxs("div",{className:"relative group",children:[v.jsx("div",{className:`absolute inset-0 rounded-full blur-xl transition-all duration-500 pointer-events-none ${ge?fe?"bg-green-500/40 scale-150":"bg-red-500/40 scale-150":"bg-transparent scale-100"}`}),v.jsx("button",{ref:I,onClick:Er?void 0:c,className:`${ah} relative z-10 transition-all duration-300 
                        ${F?fe?"bg-green-500/90 border-green-500/50 text-white shadow-xl shadow-green-500/20":"bg-red-500/90 border-red-500/50 text-white shadow-xl shadow-red-500/20":h&&!Er?f==="dark"?"bg-white/10 text-white border-white/30":"bg-white text-slate-900 border-white/60":""} 
                        ${U?fe?"scale-[1.35] rotate-[-12deg] bg-green-600 border-green-400":"scale-[1.35] rotate-12 bg-red-600 border-red-400":""} 
                        ${ge&&!U?"scale-125":""}
                        ${Er?"opacity-40 cursor-default hover:scale-100 active:scale-100 hover:bg-white/40 dark:hover:bg-slate-900/40 hover:text-slate-700 dark:hover:text-white/80":""}`,children:v.jsx("div",{className:`transition-transform duration-300 relative ${h&&!ge&&!Er?"rotate-[135deg]":"rotate-0"}`,children:ge?fe?v.jsx(kv,{size:24,className:U?"animate-spin":"",style:{animationDuration:"2s"}}):v.jsx(sl,{size:24,className:U?"animate-bounce":"",strokeWidth:U?2.5:2}):v.jsxs("div",{className:"relative flex items-center justify-center",children:[v.jsx(Av,{size:22}),Ir>0&&v.jsx("div",{className:"absolute inset-0 pt-[5px] flex items-center justify-center pointer-events-none",children:v.jsx("span",{className:"font-bold leading-none select-none",style:{fontSize:Ir>99?"8px":Ir>9?"9px":"10px"},children:Ir})})]})})})]})}),v.jsxs("div",{className:`absolute bottom-[max(2.5rem,calc(env(safe-area-inset-bottom)+1.5rem))] right-8 z-30 flex flex-col items-center transition-all duration-300 ${ne&&!K?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-2 pointer-events-none"}`,children:[v.jsx("div",{className:`${oE} absolute bottom-full mb-3 left-1/2 -translate-x-1/2 pointer-events-none transition-all duration-500 ${Ce?"opacity-100 translate-y-0":"opacity-0 translate-y-2"}`,children:"Reset View"}),v.jsx("button",{onClick:ot,className:ah,title:"Reset View",children:v.jsx(SC,{size:22})})]})]})]})};var Mv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},OC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},pE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let m=(a&15)<<2|c>>6,g=c&63;u||(g=64,o||(m=64)),r.push(n[h],n[f],n[m],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):OC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||f==null)throw new LC;const m=s<<2|a>>4;if(r.push(m),c!==64){const g=a<<4&240|c>>2;if(r.push(g),f!==64){const b=c<<6&192|f;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class LC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FC=function(t){const e=fE(t);return pE.encodeByteArray(e,!0)},lh=function(t){return FC(t).replace(/\./g,"")},mE=function(t){try{return pE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zC=()=>jC().__FIREBASE_DEFAULTS__,UC=()=>{if(typeof process>"u"||typeof Mv>"u")return;const t=Mv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&mE(t[1]);return e&&JSON.parse(e)},Wh=()=>{try{return zC()||UC()||BC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gE=t=>{var e,n;return(n=(e=Wh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},$C=t=>{const e=gE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},yE=()=>{var t;return(t=Wh())===null||t===void 0?void 0:t.config},vE=t=>{var e;return(e=Wh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lh(JSON.stringify(n)),lh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pt())}function KC(){var t;const e=(t=Wh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function YC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XC(){const t=Pt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _E(){return!KC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wE(){try{return typeof indexedDB=="object"}catch{return!1}}function JC(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="FirebaseError";class Zr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=ZC,Object.setPrototypeOf(this,Zr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zl.prototype.create)}}class Zl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?eN(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Zr(i,a,r)}}function eN(t,e){return t.replace(tN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const tN=/\{\$([^}]+)}/g;function nN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function uh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Ov(s)&&Ov(o)){if(!uh(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ov(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function rN(t,e){const n=new iN(t,e);return n.subscribe.bind(n)}class iN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");sN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=rf),i.error===void 0&&(i.error=rf),i.complete===void 0&&(i.complete=rf);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function rf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t){return t&&t._delegate?t._delegate:t}class Ns{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new qC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lN(e))try{this.getOrInitializeService({instanceIdentifier:ss})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ss){return this.instances.has(e)}getOptions(e=ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ss){return this.component?this.component.multipleInstances?e:ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aN(t){return t===ss?void 0:t}function lN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new oN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Re||(Re={}));const cN={debug:Re.DEBUG,verbose:Re.VERBOSE,info:Re.INFO,warn:Re.WARN,error:Re.ERROR,silent:Re.SILENT},hN=Re.INFO,dN={[Re.DEBUG]:"log",[Re.VERBOSE]:"log",[Re.INFO]:"info",[Re.WARN]:"warn",[Re.ERROR]:"error"},fN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=dN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dg{constructor(e){this.name=e,this._logLevel=hN,this._logHandler=fN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Re.DEBUG,...e),this._logHandler(this,Re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Re.VERBOSE,...e),this._logHandler(this,Re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Re.INFO,...e),this._logHandler(this,Re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Re.WARN,...e),this._logHandler(this,Re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Re.ERROR,...e),this._logHandler(this,Re.ERROR,...e)}}const pN=(t,e)=>e.some(n=>t instanceof n);let Lv,Fv;function mN(){return Lv||(Lv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gN(){return Fv||(Fv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xE=new WeakMap,bp=new WeakMap,EE=new WeakMap,sf=new WeakMap,fg=new WeakMap;function yN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Pi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&xE.set(n,t)}).catch(()=>{}),fg.set(e,t),e}function vN(t){if(bp.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});bp.set(t,e)}let Ap={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return bp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||EE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _N(t){Ap=t(Ap)}function wN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(of(this),e,...n);return EE.set(r,e.sort?e.sort():[e]),Pi(r)}:gN().includes(t)?function(...e){return t.apply(of(this),e),Pi(xE.get(this))}:function(...e){return Pi(t.apply(of(this),e))}}function xN(t){return typeof t=="function"?wN(t):(t instanceof IDBTransaction&&vN(t),pN(t,mN())?new Proxy(t,Ap):t)}function Pi(t){if(t instanceof IDBRequest)return yN(t);if(sf.has(t))return sf.get(t);const e=xN(t);return e!==t&&(sf.set(t,e),fg.set(e,t)),e}const of=t=>fg.get(t);function EN(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Pi(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Pi(o.result),u.oldVersion,u.newVersion,Pi(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const IN=["get","getKey","getAll","getAllKeys","count"],TN=["put","add","delete","clear"],af=new Map;function jv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(af.get(e))return af.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=TN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||IN.includes(n)))return;const s=async function(o,...a){const u=this.transaction(o,i?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&u.done]))[0]};return af.set(e,s),s}_N(t=>({...t,get:(e,n,r)=>jv(e,n)||t.get(e,n,r),has:(e,n)=>!!jv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(kN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function kN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Rp="@firebase/app",zv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new dg("@firebase/app"),bN="@firebase/app-compat",AN="@firebase/analytics-compat",RN="@firebase/analytics",PN="@firebase/app-check-compat",CN="@firebase/app-check",NN="@firebase/auth",DN="@firebase/auth-compat",VN="@firebase/database",MN="@firebase/data-connect",ON="@firebase/database-compat",LN="@firebase/functions",FN="@firebase/functions-compat",jN="@firebase/installations",zN="@firebase/installations-compat",UN="@firebase/messaging",BN="@firebase/messaging-compat",$N="@firebase/performance",qN="@firebase/performance-compat",GN="@firebase/remote-config",HN="@firebase/remote-config-compat",KN="@firebase/storage",WN="@firebase/storage-compat",QN="@firebase/firestore",YN="@firebase/vertexai-preview",XN="@firebase/firestore-compat",JN="firebase",ZN="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp="[DEFAULT]",eD={[Rp]:"fire-core",[bN]:"fire-core-compat",[RN]:"fire-analytics",[AN]:"fire-analytics-compat",[CN]:"fire-app-check",[PN]:"fire-app-check-compat",[NN]:"fire-auth",[DN]:"fire-auth-compat",[VN]:"fire-rtdb",[MN]:"fire-data-connect",[ON]:"fire-rtdb-compat",[LN]:"fire-fn",[FN]:"fire-fn-compat",[jN]:"fire-iid",[zN]:"fire-iid-compat",[UN]:"fire-fcm",[BN]:"fire-fcm-compat",[$N]:"fire-perf",[qN]:"fire-perf-compat",[GN]:"fire-rc",[HN]:"fire-rc-compat",[KN]:"fire-gcs",[WN]:"fire-gcs-compat",[QN]:"fire-fst",[XN]:"fire-fst-compat",[YN]:"fire-vertex","fire-js":"fire-js",[JN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new Map,tD=new Map,Cp=new Map;function Uv(t,e){try{t.container.addComponent(e)}catch(n){Qr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ko(t){const e=t.name;if(Cp.has(e))return Qr.debug(`There were multiple attempts to register component ${e}.`),!1;Cp.set(e,t);for(const n of ch.values())Uv(n,t);for(const n of tD.values())Uv(n,t);return!0}function pg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Lr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ci=new Zl("app","Firebase",nD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ns("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ci.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=ZN;function IE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Pp,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ci.create("bad-app-name",{appName:String(i)});if(n||(n=yE()),!n)throw Ci.create("no-options");const s=ch.get(i);if(s){if(uh(n,s.options)&&uh(r,s.config))return s;throw Ci.create("duplicate-app",{appName:i})}const o=new uN(i);for(const u of Cp.values())o.addComponent(u);const a=new rD(n,r,o);return ch.set(i,a),a}function TE(t=Pp){const e=ch.get(t);if(!e&&t===Pp&&yE())return IE();if(!e)throw Ci.create("no-app",{appName:t});return e}function Ni(t,e,n){var r;let i=(r=eD[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qr.warn(a.join(" "));return}Ko(new Ns(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD="firebase-heartbeat-database",sD=1,Vl="firebase-heartbeat-store";let lf=null;function SE(){return lf||(lf=EN(iD,sD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ci.create("idb-open",{originalErrorMessage:t.message})})),lf}async function oD(t){try{const n=(await SE()).transaction(Vl),r=await n.objectStore(Vl).get(kE(t));return await n.done,r}catch(e){if(e instanceof Zr)Qr.warn(e.message);else{const n=Ci.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qr.warn(n.message)}}}async function Bv(t,e){try{const r=(await SE()).transaction(Vl,"readwrite");await r.objectStore(Vl).put(e,kE(t)),await r.done}catch(n){if(n instanceof Zr)Qr.warn(n.message);else{const r=Ci.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Qr.warn(r.message)}}}function kE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=1024,lD=30*24*60*60*1e3;class uD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new hD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$v();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=lD}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Qr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=$v(),{heartbeatsToSend:r,unsentEntries:i}=cD(this._heartbeatsCache.heartbeats),s=lh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Qr.warn(n),""}}}function $v(){return new Date().toISOString().substring(0,10)}function cD(t,e=aD){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),qv(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),qv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class hD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wE()?JC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await oD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Bv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Bv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function qv(t){return lh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(t){Ko(new Ns("platform-logger",e=>new SN(e),"PRIVATE")),Ko(new Ns("heartbeat",e=>new uD(e),"PRIVATE")),Ni(Rp,zv,t),Ni(Rp,zv,"esm2017"),Ni("fire-js","")}dD("");var fD="firebase",pD="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ni(fD,pD,"app");function mg(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function bE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mD=bE,AE=new Zl("auth","Firebase",bE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=new dg("@firebase/auth");function gD(t,...e){hh.logLevel<=Re.WARN&&hh.warn(`Auth (${aa}): ${t}`,...e)}function vc(t,...e){hh.logLevel<=Re.ERROR&&hh.error(`Auth (${aa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(t,...e){throw yg(t,...e)}function rr(t,...e){return yg(t,...e)}function gg(t,e,n){const r=Object.assign(Object.assign({},mD()),{[e]:n});return new Zl("auth","Firebase",r).create(e,{appName:t.name})}function Is(t){return gg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yD(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&yr(t,"argument-error"),gg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return AE.create(t,...e)}function Ee(t,e,...n){if(!t)throw yg(e,...n)}function Fr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw vc(e),new Error(e)}function Yr(t,e){t||Fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function vD(){return Gv()==="http:"||Gv()==="https:"}function Gv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vD()||QC()||"connection"in navigator)?navigator.onLine:!0}function wD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Yr(n>e,"Short delay should be less than long delay!"),this.isMobile=HC()||YC()}get(){return _D()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(t,e){Yr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED=new tu(3e4,6e4);function _g(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function la(t,e,n,r,i={}){return PE(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=eu(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:u},s);return WC()||(c.referrerPolicy="no-referrer"),RE.fetch()(CE(t,t.config.apiHost,n,a),c)})}async function PE(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},xD),e);try{const i=new TD(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Wu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[u,c]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Wu(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Wu(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Wu(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw gg(t,h,c);yr(t,h)}}catch(i){if(i instanceof Zr)throw i;yr(t,"network-request-failed",{message:String(i)})}}async function ID(t,e,n,r,i={}){const s=await la(t,e,n,r,i);return"mfaPendingCredential"in s&&yr(t,"multi-factor-auth-required",{_serverResponse:s}),s}function CE(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?vg(t.config,i):`${t.config.apiScheme}://${i}`}class TD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(rr(this.auth,"network-request-failed")),ED.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Wu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=rr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SD(t,e){return la(t,"POST","/v1/accounts:delete",e)}async function NE(t,e){return la(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kD(t,e=!1){const n=Ct(t),r=await n.getIdToken(e),i=wg(r);Ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ol(uf(i.auth_time)),issuedAtTime:ol(uf(i.iat)),expirationTime:ol(uf(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function uf(t){return Number(t)*1e3}function wg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return vc("JWT malformed, contained fewer than 3 sections"),null;try{const i=mE(n);return i?JSON.parse(i):(vc("Failed to decode base64 JWT payload"),null)}catch(i){return vc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Hv(t){const e=wg(t);return Ee(e,"internal-error"),Ee(typeof e.exp<"u","internal-error"),Ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Zr&&bD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function bD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ol(this.lastLoginAt),this.creationTime=ol(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ml(t,NE(n,{idToken:r}));Ee(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?DE(s.providerUserInfo):[],a=PD(t.providerData,o),u=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),h=u?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Dp(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function RD(t){const e=Ct(t);await dh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PD(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function DE(t){return t.map(e=>{var{providerId:n}=e,r=mg(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CD(t,e){const n=await PE(t,{},async()=>{const r=eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=CE(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",RE.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function ND(t,e){return la(t,"POST","/v2/accounts:revokeToken",_g(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ee(e.idToken,"internal-error"),Ee(typeof e.idToken<"u","internal-error"),Ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Hv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ee(e.length!==0,"internal-error");const n=Hv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await CD(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new No;return r&&(Ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Ee(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Ee(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new No,this.toJSON())}_performRefresh(){return Fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t,e){Ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class jr{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=mg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new AD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Dp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ml(this,this.stsTokenManager.getToken(this.auth,e));return Ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return kD(this,e)}reload(){return RD(this)}_assign(e){this!==e&&(Ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new jr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await dh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Lr(this.auth.app))return Promise.reject(Is(this.auth));const e=await this.getIdToken();return await Ml(this,SD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,u,c,h;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,g=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,b=(o=n.photoURL)!==null&&o!==void 0?o:void 0,I=(a=n.tenantId)!==null&&a!==void 0?a:void 0,P=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,y=(c=n.createdAt)!==null&&c!==void 0?c:void 0,_=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:T,emailVerified:C,isAnonymous:F,providerData:j,stsTokenManager:E}=n;Ee(T&&E,e,"internal-error");const w=No.fromJSON(this.name,E);Ee(typeof T=="string",e,"internal-error"),oi(f,e.name),oi(m,e.name),Ee(typeof C=="boolean",e,"internal-error"),Ee(typeof F=="boolean",e,"internal-error"),oi(g,e.name),oi(b,e.name),oi(I,e.name),oi(P,e.name),oi(y,e.name),oi(_,e.name);const k=new jr({uid:T,auth:e,email:m,emailVerified:C,displayName:f,isAnonymous:F,photoURL:b,phoneNumber:g,tenantId:I,stsTokenManager:w,createdAt:y,lastLoginAt:_});return j&&Array.isArray(j)&&(k.providerData=j.map(A=>Object.assign({},A))),P&&(k._redirectEventId=P),k}static async _fromIdTokenResponse(e,n,r=!1){const i=new No;i.updateFromServerResponse(n);const s=new jr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await dh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ee(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?DE(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new No;a.updateFromIdToken(r);const u=new jr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Dp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv=new Map;function zr(t){Yr(t instanceof Function,"Expected a class definition");let e=Kv.get(t);return e?(Yr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Kv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}VE.type="NONE";const Wv=VE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(t,e,n){return`firebase:${t}:${e}:${n}`}class Do{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=_c(this.userKey,i.apiKey,s),this.fullPersistenceKey=_c("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?jr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Do(zr(Wv),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||zr(Wv);const o=_c(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const h=await c._get(o);if(h){const f=jr._fromJSON(e,h);c!==s&&(a=f),s=c;break}}catch{}const u=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Do(s,e,r):(s=u[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Do(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(FE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ME(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zE(e))return"Blackberry";if(UE(e))return"Webos";if(OE(e))return"Safari";if((e.includes("chrome/")||LE(e))&&!e.includes("edge/"))return"Chrome";if(jE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ME(t=Pt()){return/firefox\//i.test(t)}function OE(t=Pt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function LE(t=Pt()){return/crios\//i.test(t)}function FE(t=Pt()){return/iemobile/i.test(t)}function jE(t=Pt()){return/android/i.test(t)}function zE(t=Pt()){return/blackberry/i.test(t)}function UE(t=Pt()){return/webos/i.test(t)}function xg(t=Pt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function DD(t=Pt()){var e;return xg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VD(){return XC()&&document.documentMode===10}function BE(t=Pt()){return xg(t)||jE(t)||UE(t)||zE(t)||/windows phone/i.test(t)||FE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e=[]){let n;switch(t){case"Browser":n=Qv(Pt());break;case"Worker":n=`${Qv(Pt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${aa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const u=e(s);o(u)}catch(u){a(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OD(t,e={}){return la(t,"GET","/v2/passwordPolicy",_g(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD=6;class FD{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:LD,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yv(this),this.idTokenSubscription=new Yv(this),this.beforeStateQueue=new MD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zr(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Do.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await NE(this,{idToken:e}),r=await jr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Lr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await dh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=wD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Lr(this.app))return Promise.reject(Is(this));const n=e?Ct(e):null;return n&&Ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Lr(this.app)?Promise.reject(Is(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Lr(this.app)?Promise.reject(Is(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OD(this),n=new FD(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Zl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await ND(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zr(e)||this._popupRedirectResolver;Ee(n,this,"argument-error"),this.redirectPersistenceManager=await Do.create(this,[zr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ee(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$E(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&gD(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Qh(t){return Ct(t)}class Yv{constructor(e){this.auth=e,this.observer=null,this.addObserver=rN(n=>this.observer=n)}get next(){return Ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Eg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zD(t){Eg=t}function UD(t){return Eg.loadJS(t)}function BD(){return Eg.gapiScript}function $D(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(t,e){const n=pg(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(uh(s,e??{}))return i;yr(i,"already-initialized")}return n.initialize({options:e})}function GD(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function HD(t,e,n){const r=Qh(t);Ee(r._canInitEmulator,r,"emulator-config-failed"),Ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=qE(e),{host:o,port:a}=KD(e),u=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),WD()}function qE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function KD(t){const e=qE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Xv(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Xv(o)}}}function Xv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function WD(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Fr("not implemented")}_getIdTokenResponse(e){return Fr("not implemented")}_linkToIdToken(e,n){return Fr("not implemented")}_getReauthenticationResolver(e){return Fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vo(t,e){return ID(t,"POST","/v1/accounts:signInWithIdp",_g(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="http://localhost";class Ds extends GE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ds(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):yr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=mg(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Ds(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Vo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Vo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Vo(e,n)}buildRequest(){const e={requestUri:QD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu extends Ig{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends nu{constructor(){super("facebook.com")}static credential(e){return Ds._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends nu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ds._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Dr.credential(n,r)}catch{return null}}}Dr.GOOGLE_SIGN_IN_METHOD="google.com";Dr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends nu{constructor(){super("github.com")}static credential(e){return Ds._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gi.credential(e.oauthAccessToken)}catch{return null}}}gi.GITHUB_SIGN_IN_METHOD="github.com";gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi extends nu{constructor(){super("twitter.com")}static credential(e,n){return Ds._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return yi.credential(n,r)}catch{return null}}}yi.TWITTER_SIGN_IN_METHOD="twitter.com";yi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await jr._fromIdTokenResponse(e,r,i),o=Jv(r);return new Wo({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Jv(r);return new Wo({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Jv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh extends Zr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,fh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new fh(e,n,r,i)}}function HE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fh._fromErrorAndOperation(t,s,e,r):s})}async function YD(t,e,n=!1){const r=await Ml(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e,n=!1){const{auth:r}=t;if(Lr(r.app))return Promise.reject(Is(r));const i="reauthenticate";try{const s=await Ml(t,HE(r,i,e,t),n);Ee(s.idToken,r,"internal-error");const o=wg(s.idToken);Ee(o,r,"internal-error");const{sub:a}=o;return Ee(t.uid===a,r,"user-mismatch"),Wo._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&yr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JD(t,e,n=!1){if(Lr(t.app))return Promise.reject(Is(t));const r="signIn",i=await HE(t,r,e),s=await Wo._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function ZD(t,e,n,r){return Ct(t).onIdTokenChanged(e,n,r)}function eV(t,e,n){return Ct(t).beforeAuthStateChanged(e,n)}function tV(t,e,n,r){return Ct(t).onAuthStateChanged(e,n,r)}function nV(t){return Ct(t).signOut()}const ph="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ph,"1"),this.storage.removeItem(ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=1e3,iV=10;class WE extends KE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);VD()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,iV):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},rV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}WE.type="LOCAL";const sV=WE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE extends KE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}QE.type="SESSION";const YE=QE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oV(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Yh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),u=await oV(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{const c=Tg("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(h),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(){return window}function lV(t){gr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(){return typeof gr().WorkerGlobalScope<"u"&&typeof gr().importScripts=="function"}async function uV(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function cV(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function hV(){return XE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="firebaseLocalStorageDb",dV=1,mh="firebaseLocalStorage",ZE="fbase_key";class ru{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xh(t,e){return t.transaction([mh],e?"readwrite":"readonly").objectStore(mh)}function fV(){const t=indexedDB.deleteDatabase(JE);return new ru(t).toPromise()}function Vp(){const t=indexedDB.open(JE,dV);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(mh,{keyPath:ZE})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(mh)?e(r):(r.close(),await fV(),e(await Vp()))})})}async function Zv(t,e,n){const r=Xh(t,!0).put({[ZE]:e,value:n});return new ru(r).toPromise()}async function pV(t,e){const n=Xh(t,!1).get(e),r=await new ru(n).toPromise();return r===void 0?null:r.value}function e_(t,e){const n=Xh(t,!0).delete(e);return new ru(n).toPromise()}const mV=800,gV=3;class eI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>gV)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yh._getInstance(hV()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await uV(),!this.activeServiceWorker)return;this.sender=new aV(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||cV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vp();return await Zv(e,ph,"1"),await e_(e,ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Zv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>pV(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>e_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Xh(i,!1).getAll();return new ru(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eI.type="LOCAL";const yV=eI;new tu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(t,e){return e?zr(e):(Ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg extends GE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Vo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Vo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function vV(t){return JD(t.auth,new Sg(t),t.bypassAuthState)}function _V(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),XD(n,new Sg(t),t.bypassAuthState)}async function wV(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),YD(n,new Sg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vV;case"linkViaPopup":case"linkViaRedirect":return wV;case"reauthViaPopup":case"reauthViaRedirect":return _V;default:yr(this.auth,"internal-error")}}resolve(e){Yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV=new tu(2e3,1e4);async function EV(t,e,n){if(Lr(t.app))return Promise.reject(rr(t,"operation-not-supported-in-this-environment"));const r=Qh(t);yD(t,e,Ig);const i=tI(r,n);return new ys(r,"signInViaPopup",e,i).executeNotNull()}class ys extends nI{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,ys.currentPopupAction&&ys.currentPopupAction.cancel(),ys.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ee(e,this.auth,"internal-error"),e}async onExecution(){Yr(this.filter.length===1,"Popup operations only handle one event");const e=Tg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(rr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ys.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,xV.get())};e()}}ys.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV="pendingRedirect",wc=new Map;class TV extends nI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wc.get(this.auth._key());if(!e){try{const r=await SV(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wc.set(this.auth._key(),e)}return this.bypassAuthState||wc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function SV(t,e){const n=AV(e),r=bV(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function kV(t,e){wc.set(t._key(),e)}function bV(t){return zr(t._redirectPersistence)}function AV(t){return _c(IV,t.config.apiKey,t.name)}async function RV(t,e,n=!1){if(Lr(t.app))return Promise.reject(Is(t));const r=Qh(t),i=tI(r,e),o=await new TV(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PV=10*60*1e3;class CV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!NV(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!rI(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(rr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PV&&this.cachedEventUids.clear(),this.cachedEventUids.has(t_(e))}saveEventToCache(e){this.cachedEventUids.add(t_(e)),this.lastProcessedEventTime=Date.now()}}function t_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function NV(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DV(t,e={}){return la(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MV=/^https?/;async function OV(t){if(t.config.emulator)return;const{authorizedDomains:e}=await DV(t);for(const n of e)try{if(LV(n))return}catch{}yr(t,"unauthorized-domain")}function LV(t){const e=Np(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!MV.test(n))return!1;if(VV.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV=new tu(3e4,6e4);function n_(){const t=gr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function jV(t){return new Promise((e,n)=>{var r,i,s;function o(){n_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{n_(),n(rr(t,"network-request-failed"))},timeout:FV.get()})}if(!((i=(r=gr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=gr().gapi)===null||s===void 0)&&s.load)o();else{const a=$D("iframefcb");return gr()[a]=()=>{gapi.load?o():n(rr(t,"network-request-failed"))},UD(`${BD()}?onload=${a}`).catch(u=>n(u))}}).catch(e=>{throw xc=null,e})}let xc=null;function zV(t){return xc=xc||jV(t),xc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV=new tu(5e3,15e3),BV="__/auth/iframe",$V="emulator/auth/iframe",qV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},GV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function HV(t){const e=t.config;Ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?vg(e,$V):`https://${t.config.authDomain}/${BV}`,r={apiKey:e.apiKey,appName:t.name,v:aa},i=GV.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${eu(r).slice(1)}`}async function KV(t){const e=await zV(t),n=gr().gapi;return Ee(n,t,"internal-error"),e.open({where:document.body,url:HV(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qV,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=rr(t,"network-request-failed"),a=gr().setTimeout(()=>{s(o)},UV.get());function u(){gr().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},QV=500,YV=600,XV="_blank",JV="http://localhost";class r_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZV(t,e,n,r=QV,i=YV){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},WV),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Pt().toLowerCase();n&&(a=LE(c)?XV:n),ME(c)&&(e=e||JV,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[g,b])=>`${m}${g}=${b},`,"");if(DD(c)&&a!=="_self")return e4(e||"",a),new r_(null);const f=window.open(e||"",a,h);Ee(f,t,"popup-blocked");try{f.focus()}catch{}return new r_(f)}function e4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4="__/auth/handler",n4="emulator/auth/handler",r4=encodeURIComponent("fac");async function i_(t,e,n,r,i,s){Ee(t.config.authDomain,t,"auth-domain-config-required"),Ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:aa,eventId:i};if(e instanceof Ig){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",nN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof nu){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const u=await t._getAppCheckToken(),c=u?`#${r4}=${encodeURIComponent(u)}`:"";return`${i4(t)}?${eu(a).slice(1)}${c}`}function i4({config:t}){return t.emulator?vg(t,n4):`https://${t.authDomain}/${t4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="webStorageSupport";class s4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=YE,this._completeRedirectFn=RV,this._overrideRedirectResult=kV}async _openPopup(e,n,r,i){var s;Yr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await i_(e,n,r,Np(),i);return ZV(e,o,Tg())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await i_(e,n,r,Np(),i);return lV(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Yr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await KV(e),r=new CV(e);return n.register("authEvent",i=>(Ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(cf,{type:cf},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[cf];o!==void 0&&n(!!o),yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=OV(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return BE()||OE()||xg()}}const o4=s4;var s_="@firebase/auth",o_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function u4(t){Ko(new Ns("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$E(t)},c=new jD(r,i,s,u);return GD(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ko(new Ns("auth-internal",e=>{const n=Qh(e.getProvider("auth").getImmediate());return(r=>new a4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ni(s_,o_,l4(t)),Ni(s_,o_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=5*60,h4=vE("authIdTokenMaxAge")||c4;let a_=null;const d4=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>h4)return;const i=n==null?void 0:n.token;a_!==i&&(a_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function f4(t=TE()){const e=pg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=qD(t,{popupRedirectResolver:o4,persistence:[yV,sV,YE]}),r=vE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=d4(s.toString());eV(n,o,()=>o(n.currentUser)),ZD(n,a=>o(a))}}const i=gE("auth");return i&&HD(n,`http://${i}`),n}function p4(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}zD({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=rr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",p4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});u4("Browser");var l_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ts,iI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,w){function k(){}k.prototype=w.prototype,E.D=w.prototype,E.prototype=new k,E.prototype.constructor=E,E.C=function(A,R,N){for(var S=Array(arguments.length-2),O=2;O<arguments.length;O++)S[O-2]=arguments[O];return w.prototype[R].apply(A,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,w,k){k||(k=0);var A=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)A[R]=w.charCodeAt(k++)|w.charCodeAt(k++)<<8|w.charCodeAt(k++)<<16|w.charCodeAt(k++)<<24;else for(R=0;16>R;++R)A[R]=w[k++]|w[k++]<<8|w[k++]<<16|w[k++]<<24;w=E.g[0],k=E.g[1],R=E.g[2];var N=E.g[3],S=w+(N^k&(R^N))+A[0]+3614090360&4294967295;w=k+(S<<7&4294967295|S>>>25),S=N+(R^w&(k^R))+A[1]+3905402710&4294967295,N=w+(S<<12&4294967295|S>>>20),S=R+(k^N&(w^k))+A[2]+606105819&4294967295,R=N+(S<<17&4294967295|S>>>15),S=k+(w^R&(N^w))+A[3]+3250441966&4294967295,k=R+(S<<22&4294967295|S>>>10),S=w+(N^k&(R^N))+A[4]+4118548399&4294967295,w=k+(S<<7&4294967295|S>>>25),S=N+(R^w&(k^R))+A[5]+1200080426&4294967295,N=w+(S<<12&4294967295|S>>>20),S=R+(k^N&(w^k))+A[6]+2821735955&4294967295,R=N+(S<<17&4294967295|S>>>15),S=k+(w^R&(N^w))+A[7]+4249261313&4294967295,k=R+(S<<22&4294967295|S>>>10),S=w+(N^k&(R^N))+A[8]+1770035416&4294967295,w=k+(S<<7&4294967295|S>>>25),S=N+(R^w&(k^R))+A[9]+2336552879&4294967295,N=w+(S<<12&4294967295|S>>>20),S=R+(k^N&(w^k))+A[10]+4294925233&4294967295,R=N+(S<<17&4294967295|S>>>15),S=k+(w^R&(N^w))+A[11]+2304563134&4294967295,k=R+(S<<22&4294967295|S>>>10),S=w+(N^k&(R^N))+A[12]+1804603682&4294967295,w=k+(S<<7&4294967295|S>>>25),S=N+(R^w&(k^R))+A[13]+4254626195&4294967295,N=w+(S<<12&4294967295|S>>>20),S=R+(k^N&(w^k))+A[14]+2792965006&4294967295,R=N+(S<<17&4294967295|S>>>15),S=k+(w^R&(N^w))+A[15]+1236535329&4294967295,k=R+(S<<22&4294967295|S>>>10),S=w+(R^N&(k^R))+A[1]+4129170786&4294967295,w=k+(S<<5&4294967295|S>>>27),S=N+(k^R&(w^k))+A[6]+3225465664&4294967295,N=w+(S<<9&4294967295|S>>>23),S=R+(w^k&(N^w))+A[11]+643717713&4294967295,R=N+(S<<14&4294967295|S>>>18),S=k+(N^w&(R^N))+A[0]+3921069994&4294967295,k=R+(S<<20&4294967295|S>>>12),S=w+(R^N&(k^R))+A[5]+3593408605&4294967295,w=k+(S<<5&4294967295|S>>>27),S=N+(k^R&(w^k))+A[10]+38016083&4294967295,N=w+(S<<9&4294967295|S>>>23),S=R+(w^k&(N^w))+A[15]+3634488961&4294967295,R=N+(S<<14&4294967295|S>>>18),S=k+(N^w&(R^N))+A[4]+3889429448&4294967295,k=R+(S<<20&4294967295|S>>>12),S=w+(R^N&(k^R))+A[9]+568446438&4294967295,w=k+(S<<5&4294967295|S>>>27),S=N+(k^R&(w^k))+A[14]+3275163606&4294967295,N=w+(S<<9&4294967295|S>>>23),S=R+(w^k&(N^w))+A[3]+4107603335&4294967295,R=N+(S<<14&4294967295|S>>>18),S=k+(N^w&(R^N))+A[8]+1163531501&4294967295,k=R+(S<<20&4294967295|S>>>12),S=w+(R^N&(k^R))+A[13]+2850285829&4294967295,w=k+(S<<5&4294967295|S>>>27),S=N+(k^R&(w^k))+A[2]+4243563512&4294967295,N=w+(S<<9&4294967295|S>>>23),S=R+(w^k&(N^w))+A[7]+1735328473&4294967295,R=N+(S<<14&4294967295|S>>>18),S=k+(N^w&(R^N))+A[12]+2368359562&4294967295,k=R+(S<<20&4294967295|S>>>12),S=w+(k^R^N)+A[5]+4294588738&4294967295,w=k+(S<<4&4294967295|S>>>28),S=N+(w^k^R)+A[8]+2272392833&4294967295,N=w+(S<<11&4294967295|S>>>21),S=R+(N^w^k)+A[11]+1839030562&4294967295,R=N+(S<<16&4294967295|S>>>16),S=k+(R^N^w)+A[14]+4259657740&4294967295,k=R+(S<<23&4294967295|S>>>9),S=w+(k^R^N)+A[1]+2763975236&4294967295,w=k+(S<<4&4294967295|S>>>28),S=N+(w^k^R)+A[4]+1272893353&4294967295,N=w+(S<<11&4294967295|S>>>21),S=R+(N^w^k)+A[7]+4139469664&4294967295,R=N+(S<<16&4294967295|S>>>16),S=k+(R^N^w)+A[10]+3200236656&4294967295,k=R+(S<<23&4294967295|S>>>9),S=w+(k^R^N)+A[13]+681279174&4294967295,w=k+(S<<4&4294967295|S>>>28),S=N+(w^k^R)+A[0]+3936430074&4294967295,N=w+(S<<11&4294967295|S>>>21),S=R+(N^w^k)+A[3]+3572445317&4294967295,R=N+(S<<16&4294967295|S>>>16),S=k+(R^N^w)+A[6]+76029189&4294967295,k=R+(S<<23&4294967295|S>>>9),S=w+(k^R^N)+A[9]+3654602809&4294967295,w=k+(S<<4&4294967295|S>>>28),S=N+(w^k^R)+A[12]+3873151461&4294967295,N=w+(S<<11&4294967295|S>>>21),S=R+(N^w^k)+A[15]+530742520&4294967295,R=N+(S<<16&4294967295|S>>>16),S=k+(R^N^w)+A[2]+3299628645&4294967295,k=R+(S<<23&4294967295|S>>>9),S=w+(R^(k|~N))+A[0]+4096336452&4294967295,w=k+(S<<6&4294967295|S>>>26),S=N+(k^(w|~R))+A[7]+1126891415&4294967295,N=w+(S<<10&4294967295|S>>>22),S=R+(w^(N|~k))+A[14]+2878612391&4294967295,R=N+(S<<15&4294967295|S>>>17),S=k+(N^(R|~w))+A[5]+4237533241&4294967295,k=R+(S<<21&4294967295|S>>>11),S=w+(R^(k|~N))+A[12]+1700485571&4294967295,w=k+(S<<6&4294967295|S>>>26),S=N+(k^(w|~R))+A[3]+2399980690&4294967295,N=w+(S<<10&4294967295|S>>>22),S=R+(w^(N|~k))+A[10]+4293915773&4294967295,R=N+(S<<15&4294967295|S>>>17),S=k+(N^(R|~w))+A[1]+2240044497&4294967295,k=R+(S<<21&4294967295|S>>>11),S=w+(R^(k|~N))+A[8]+1873313359&4294967295,w=k+(S<<6&4294967295|S>>>26),S=N+(k^(w|~R))+A[15]+4264355552&4294967295,N=w+(S<<10&4294967295|S>>>22),S=R+(w^(N|~k))+A[6]+2734768916&4294967295,R=N+(S<<15&4294967295|S>>>17),S=k+(N^(R|~w))+A[13]+1309151649&4294967295,k=R+(S<<21&4294967295|S>>>11),S=w+(R^(k|~N))+A[4]+4149444226&4294967295,w=k+(S<<6&4294967295|S>>>26),S=N+(k^(w|~R))+A[11]+3174756917&4294967295,N=w+(S<<10&4294967295|S>>>22),S=R+(w^(N|~k))+A[2]+718787259&4294967295,R=N+(S<<15&4294967295|S>>>17),S=k+(N^(R|~w))+A[9]+3951481745&4294967295,E.g[0]=E.g[0]+w&4294967295,E.g[1]=E.g[1]+(R+(S<<21&4294967295|S>>>11))&4294967295,E.g[2]=E.g[2]+R&4294967295,E.g[3]=E.g[3]+N&4294967295}r.prototype.u=function(E,w){w===void 0&&(w=E.length);for(var k=w-this.blockSize,A=this.B,R=this.h,N=0;N<w;){if(R==0)for(;N<=k;)i(this,E,N),N+=this.blockSize;if(typeof E=="string"){for(;N<w;)if(A[R++]=E.charCodeAt(N++),R==this.blockSize){i(this,A),R=0;break}}else for(;N<w;)if(A[R++]=E[N++],R==this.blockSize){i(this,A),R=0;break}}this.h=R,this.o+=w},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var w=1;w<E.length-8;++w)E[w]=0;var k=8*this.o;for(w=E.length-8;w<E.length;++w)E[w]=k&255,k/=256;for(this.u(E),E=Array(16),w=k=0;4>w;++w)for(var A=0;32>A;A+=8)E[k++]=this.g[w]>>>A&255;return E};function s(E,w){var k=a;return Object.prototype.hasOwnProperty.call(k,E)?k[E]:k[E]=w(E)}function o(E,w){this.h=w;for(var k=[],A=!0,R=E.length-1;0<=R;R--){var N=E[R]|0;A&&N==w||(k[R]=N,A=!1)}this.g=k}var a={};function u(E){return-128<=E&&128>E?s(E,function(w){return new o([w|0],0>w?-1:0)}):new o([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return f;if(0>E)return P(c(-E));for(var w=[],k=1,A=0;E>=k;A++)w[A]=E/k|0,k*=4294967296;return new o(w,0)}function h(E,w){if(E.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(E.charAt(0)=="-")return P(h(E.substring(1),w));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(w,8)),A=f,R=0;R<E.length;R+=8){var N=Math.min(8,E.length-R),S=parseInt(E.substring(R,R+N),w);8>N?(N=c(Math.pow(w,N)),A=A.j(N).add(c(S))):(A=A.j(k),A=A.add(c(S)))}return A}var f=u(0),m=u(1),g=u(16777216);t=o.prototype,t.m=function(){if(I(this))return-P(this).m();for(var E=0,w=1,k=0;k<this.g.length;k++){var A=this.i(k);E+=(0<=A?A:4294967296+A)*w,w*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(b(this))return"0";if(I(this))return"-"+P(this).toString(E);for(var w=c(Math.pow(E,6)),k=this,A="";;){var R=C(k,w).g;k=y(k,R.j(w));var N=((0<k.g.length?k.g[0]:k.h)>>>0).toString(E);if(k=R,b(k))return N+A;for(;6>N.length;)N="0"+N;A=N+A}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function b(E){if(E.h!=0)return!1;for(var w=0;w<E.g.length;w++)if(E.g[w]!=0)return!1;return!0}function I(E){return E.h==-1}t.l=function(E){return E=y(this,E),I(E)?-1:b(E)?0:1};function P(E){for(var w=E.g.length,k=[],A=0;A<w;A++)k[A]=~E.g[A];return new o(k,~E.h).add(m)}t.abs=function(){return I(this)?P(this):this},t.add=function(E){for(var w=Math.max(this.g.length,E.g.length),k=[],A=0,R=0;R<=w;R++){var N=A+(this.i(R)&65535)+(E.i(R)&65535),S=(N>>>16)+(this.i(R)>>>16)+(E.i(R)>>>16);A=S>>>16,N&=65535,S&=65535,k[R]=S<<16|N}return new o(k,k[k.length-1]&-2147483648?-1:0)};function y(E,w){return E.add(P(w))}t.j=function(E){if(b(this)||b(E))return f;if(I(this))return I(E)?P(this).j(P(E)):P(P(this).j(E));if(I(E))return P(this.j(P(E)));if(0>this.l(g)&&0>E.l(g))return c(this.m()*E.m());for(var w=this.g.length+E.g.length,k=[],A=0;A<2*w;A++)k[A]=0;for(A=0;A<this.g.length;A++)for(var R=0;R<E.g.length;R++){var N=this.i(A)>>>16,S=this.i(A)&65535,O=E.i(R)>>>16,Z=E.i(R)&65535;k[2*A+2*R]+=S*Z,_(k,2*A+2*R),k[2*A+2*R+1]+=N*Z,_(k,2*A+2*R+1),k[2*A+2*R+1]+=S*O,_(k,2*A+2*R+1),k[2*A+2*R+2]+=N*O,_(k,2*A+2*R+2)}for(A=0;A<w;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=w;A<2*w;A++)k[A]=0;return new o(k,0)};function _(E,w){for(;(E[w]&65535)!=E[w];)E[w+1]+=E[w]>>>16,E[w]&=65535,w++}function T(E,w){this.g=E,this.h=w}function C(E,w){if(b(w))throw Error("division by zero");if(b(E))return new T(f,f);if(I(E))return w=C(P(E),w),new T(P(w.g),P(w.h));if(I(w))return w=C(E,P(w)),new T(P(w.g),w.h);if(30<E.g.length){if(I(E)||I(w))throw Error("slowDivide_ only works with positive integers.");for(var k=m,A=w;0>=A.l(E);)k=F(k),A=F(A);var R=j(k,1),N=j(A,1);for(A=j(A,2),k=j(k,2);!b(A);){var S=N.add(A);0>=S.l(E)&&(R=R.add(k),N=S),A=j(A,1),k=j(k,1)}return w=y(E,R.j(w)),new T(R,w)}for(R=f;0<=E.l(w);){for(k=Math.max(1,Math.floor(E.m()/w.m())),A=Math.ceil(Math.log(k)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),N=c(k),S=N.j(w);I(S)||0<S.l(E);)k-=A,N=c(k),S=N.j(w);b(N)&&(N=m),R=R.add(N),E=y(E,S)}return new T(R,E)}t.A=function(E){return C(this,E).h},t.and=function(E){for(var w=Math.max(this.g.length,E.g.length),k=[],A=0;A<w;A++)k[A]=this.i(A)&E.i(A);return new o(k,this.h&E.h)},t.or=function(E){for(var w=Math.max(this.g.length,E.g.length),k=[],A=0;A<w;A++)k[A]=this.i(A)|E.i(A);return new o(k,this.h|E.h)},t.xor=function(E){for(var w=Math.max(this.g.length,E.g.length),k=[],A=0;A<w;A++)k[A]=this.i(A)^E.i(A);return new o(k,this.h^E.h)};function F(E){for(var w=E.g.length+1,k=[],A=0;A<w;A++)k[A]=E.i(A)<<1|E.i(A-1)>>>31;return new o(k,E.h)}function j(E,w){var k=w>>5;w%=32;for(var A=E.g.length-k,R=[],N=0;N<A;N++)R[N]=0<w?E.i(N+k)>>>w|E.i(N+k+1)<<32-w:E.i(N+k);return new o(R,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,iI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Ts=o}).apply(typeof l_<"u"?l_:typeof self<"u"?self:typeof window<"u"?window:{});var Qu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sI,Ga,oI,Ec,Mp,aI,lI,uI;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,d,p){return l==Array.prototype||l==Object.prototype||(l[d]=p.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qu=="object"&&Qu];for(var d=0;d<l.length;++d){var p=l[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function i(l,d){if(d)e:{var p=r;l=l.split(".");for(var x=0;x<l.length-1;x++){var D=l[x];if(!(D in p))break e;p=p[D]}l=l[l.length-1],x=p[l],d=d(x),d!=x&&d!=null&&e(p,l,{configurable:!0,writable:!0,value:d})}}function s(l,d){l instanceof String&&(l+="");var p=0,x=!1,D={next:function(){if(!x&&p<l.length){var z=p++;return{value:d(z,l[z]),done:!1}}return x=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(l){return l||function(){return s(this,function(d,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(l){var d=typeof l;return d=d!="object"?d:l?Array.isArray(l)?"array":d:"null",d=="array"||d=="object"&&typeof l.length=="number"}function c(l){var d=typeof l;return d=="object"&&l!=null||d=="function"}function h(l,d,p){return l.call.apply(l.bind,arguments)}function f(l,d,p){if(!l)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,x),l.apply(d,D)}}return function(){return l.apply(d,arguments)}}function m(l,d,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function g(l,d){var p=Array.prototype.slice.call(arguments,1);return function(){var x=p.slice();return x.push.apply(x,arguments),l.apply(this,x)}}function b(l,d){function p(){}p.prototype=d.prototype,l.aa=d.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(x,D,z){for(var te=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)te[Ke-2]=arguments[Ke];return d.prototype[D].apply(x,te)}}function I(l){const d=l.length;if(0<d){const p=Array(d);for(let x=0;x<d;x++)p[x]=l[x];return p}return[]}function P(l,d){for(let p=1;p<arguments.length;p++){const x=arguments[p];if(u(x)){const D=l.length||0,z=x.length||0;l.length=D+z;for(let te=0;te<z;te++)l[D+te]=x[te]}else l.push(x)}}class y{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function _(l){return/^[\s\xa0]*$/.test(l)}function T(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function C(l){return C[" "](l),l}C[" "]=function(){};var F=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function j(l,d,p){for(const x in l)d.call(p,l[x],x,l)}function E(l,d){for(const p in l)d.call(void 0,l[p],p,l)}function w(l){const d={};for(const p in l)d[p]=l[p];return d}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(l,d){let p,x;for(let D=1;D<arguments.length;D++){x=arguments[D];for(p in x)l[p]=x[p];for(let z=0;z<k.length;z++)p=k[z],Object.prototype.hasOwnProperty.call(x,p)&&(l[p]=x[p])}}function R(l){var d=1;l=l.split(":");const p=[];for(;0<d&&l.length;)p.push(l.shift()),d--;return l.length&&p.push(l.join(":")),p}function N(l){a.setTimeout(()=>{throw l},0)}function S(){var l=K;let d=null;return l.g&&(d=l.g,l.g=l.g.next,l.g||(l.h=null),d.next=null),d}class O{constructor(){this.h=this.g=null}add(d,p){const x=Z.get();x.set(d,p),this.h?this.h.next=x:this.g=x,this.h=x}}var Z=new y(()=>new H,l=>l.reset());class H{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,B=!1,K=new O,W=()=>{const l=a.Promise.resolve(void 0);ee=()=>{l.then(X)}};var X=()=>{for(var l;l=S();){try{l.h.call(l.g)}catch(p){N(p)}var d=Z;d.j(l),100>d.h&&(d.h++,l.next=d.g,d.g=l)}B=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ye(l,d){this.type=l,this.g=this.target=d,this.defaultPrevented=!1}ye.prototype.h=function(){this.defaultPrevented=!0};var $=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,d=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};a.addEventListener("test",p,d),a.removeEventListener("test",p,d)}catch{}return l}();function ne(l,d){if(ye.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,x=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=d,d=l.relatedTarget){if(F){e:{try{C(d.nodeName);var D=!0;break e}catch{}D=!1}D||(d=null)}}else p=="mouseover"?d=l.fromElement:p=="mouseout"&&(d=l.toElement);this.relatedTarget=d,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:de[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&ne.aa.h.call(this)}}b(ne,ye);var de={2:"touch",3:"pen",4:"mouse"};ne.prototype.h=function(){ne.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ae="closure_listenable_"+(1e6*Math.random()|0),ge=0;function Me(l,d,p,x,D){this.listener=l,this.proxy=null,this.src=d,this.type=p,this.capture=!!x,this.ha=D,this.key=++ge,this.da=this.fa=!1}function U(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function me(l){this.src=l,this.g={},this.h=0}me.prototype.add=function(l,d,p,x,D){var z=l.toString();l=this.g[z],l||(l=this.g[z]=[],this.h++);var te=xe(l,d,x,D);return-1<te?(d=l[te],p||(d.fa=!1)):(d=new Me(d,this.src,z,!!x,D),d.fa=p,l.push(d)),d};function fe(l,d){var p=d.type;if(p in l.g){var x=l.g[p],D=Array.prototype.indexOf.call(x,d,void 0),z;(z=0<=D)&&Array.prototype.splice.call(x,D,1),z&&(U(d),l.g[p].length==0&&(delete l.g[p],l.h--))}}function xe(l,d,p,x){for(var D=0;D<l.length;++D){var z=l[D];if(!z.da&&z.listener==d&&z.capture==!!p&&z.ha==x)return D}return-1}var Ce="closure_lm_"+(1e6*Math.random()|0),qe={};function dt(l,d,p,x,D){if(Array.isArray(d)){for(var z=0;z<d.length;z++)dt(l,d[z],p,x,D);return null}return p=Ki(p),l&&l[ae]?l.K(d,p,c(x)?!!x.capture:!1,D):ft(l,d,p,!1,x,D)}function ft(l,d,p,x,D,z){if(!d)throw Error("Invalid event type");var te=c(D)?!!D.capture:!!D,Ke=wr(l);if(Ke||(l[Ce]=Ke=new me(l)),p=Ke.add(d,p,x,te,z),p.proxy)return p;if(x=_t(),p.proxy=x,x.src=l,x.listener=p,l.addEventListener)$||(D=te),D===void 0&&(D=!1),l.addEventListener(d.toString(),x,D);else if(l.attachEvent)l.attachEvent(Ks(d.toString()),x);else if(l.addListener&&l.removeListener)l.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return p}function _t(){function l(p){return d.call(l.src,l.listener,p)}const d=fa;return l}function ot(l,d,p,x,D){if(Array.isArray(d))for(var z=0;z<d.length;z++)ot(l,d[z],p,x,D);else x=c(x)?!!x.capture:!!x,p=Ki(p),l&&l[ae]?(l=l.i,d=String(d).toString(),d in l.g&&(z=l.g[d],p=xe(z,p,x,D),-1<p&&(U(z[p]),Array.prototype.splice.call(z,p,1),z.length==0&&(delete l.g[d],l.h--)))):l&&(l=wr(l))&&(d=l.g[d.toString()],l=-1,d&&(l=xe(d,p,x,D)),(p=-1<l?d[l]:null)&&rn(p))}function rn(l){if(typeof l!="number"&&l&&!l.da){var d=l.src;if(d&&d[ae])fe(d.i,l);else{var p=l.type,x=l.proxy;d.removeEventListener?d.removeEventListener(p,x,l.capture):d.detachEvent?d.detachEvent(Ks(p),x):d.addListener&&d.removeListener&&d.removeListener(x),(p=wr(d))?(fe(p,l),p.h==0&&(p.src=null,d[Ce]=null)):U(l)}}}function Ks(l){return l in qe?qe[l]:qe[l]="on"+l}function fa(l,d){if(l.da)l=!0;else{d=new ne(d,this);var p=l.listener,x=l.ha||l.src;l.fa&&rn(l),l=p.call(x,d)}return l}function wr(l){return l=l[Ce],l instanceof me?l:null}var xr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ki(l){return typeof l=="function"?l:(l[xr]||(l[xr]=function(d){return l.handleEvent(d)}),l[xr])}function It(){se.call(this),this.i=new me(this),this.M=this,this.F=null}b(It,se),It.prototype[ae]=!0,It.prototype.removeEventListener=function(l,d,p,x){ot(this,l,d,p,x)};function wt(l,d){var p,x=l.F;if(x)for(p=[];x;x=x.F)p.push(x);if(l=l.M,x=d.type||d,typeof d=="string")d=new ye(d,l);else if(d instanceof ye)d.target=d.target||l;else{var D=d;d=new ye(x,l),A(d,D)}if(D=!0,p)for(var z=p.length-1;0<=z;z--){var te=d.g=p[z];D=Wi(te,x,!0,d)&&D}if(te=d.g=l,D=Wi(te,x,!0,d)&&D,D=Wi(te,x,!1,d)&&D,p)for(z=0;z<p.length;z++)te=d.g=p[z],D=Wi(te,x,!1,d)&&D}It.prototype.N=function(){if(It.aa.N.call(this),this.i){var l=this.i,d;for(d in l.g){for(var p=l.g[d],x=0;x<p.length;x++)U(p[x]);delete l.g[d],l.h--}}this.F=null},It.prototype.K=function(l,d,p,x){return this.i.add(String(l),d,!1,p,x)},It.prototype.L=function(l,d,p,x){return this.i.add(String(l),d,!0,p,x)};function Wi(l,d,p,x){if(d=l.i.g[String(d)],!d)return!0;d=d.concat();for(var D=!0,z=0;z<d.length;++z){var te=d[z];if(te&&!te.da&&te.capture==p){var Ke=te.listener,Ft=te.ha||te.src;te.fa&&fe(l.i,te),D=Ke.call(Ft,x)!==!1&&D}}return D&&!x.defaultPrevented}function Er(l,d,p){if(typeof l=="function")p&&(l=m(l,p));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(l,d||0)}function Ir(l){l.g=Er(()=>{l.g=null,l.i&&(l.i=!1,Ir(l))},l.l);const d=l.h;l.h=null,l.m.apply(null,d)}class J extends se{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Ir(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ue(l){se.call(this),this.h=l,this.g={}}b(ue,se);var Te=[];function _e(l){j(l.g,function(d,p){this.g.hasOwnProperty(p)&&rn(d)},l),l.g={}}ue.prototype.N=function(){ue.aa.N.call(this),_e(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var oe=a.JSON.stringify,xt=a.JSON.parse,tt=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Oe(){}Oe.prototype.h=null;function Xe(l){return l.h||(l.h=l.i())}function pt(){}var be={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function We(){ye.call(this,"d")}b(We,ye);function Dt(){ye.call(this,"c")}b(Dt,ye);var nt={},On=null;function ti(){return On=On||new It}nt.La="serverreachability";function Tr(l){ye.call(this,nt.La,l)}b(Tr,ye);function Hn(l){const d=ti();wt(d,new Tr(d))}nt.STAT_EVENT="statevent";function ni(l,d){ye.call(this,nt.STAT_EVENT,l),this.stat=d}b(ni,ye);function mt(l){const d=ti();wt(d,new ni(d,l))}nt.Ma="timingevent";function Vt(l,d){ye.call(this,nt.Ma,l),this.size=d}b(Vt,ye);function mn(l,d){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},d)}function q(){this.g=!0}q.prototype.xa=function(){this.g=!1};function V(l,d,p,x,D,z){l.info(function(){if(l.g)if(z)for(var te="",Ke=z.split("&"),Ft=0;Ft<Ke.length;Ft++){var Le=Ke[Ft].split("=");if(1<Le.length){var Qt=Le[0];Le=Le[1];var Yt=Qt.split("_");te=2<=Yt.length&&Yt[1]=="type"?te+(Qt+"="+Le+"&"):te+(Qt+"=redacted&")}}else te=null;else te=z;return"XMLHTTP REQ ("+x+") [attempt "+D+"]: "+d+`
`+p+`
`+te})}function ce(l,d,p,x,D,z,te){l.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+D+"]: "+d+`
`+p+`
`+z+" "+te})}function we(l,d,p,x){l.info(function(){return"XMLHTTP TEXT ("+d+"): "+Ne(l,p)+(x?" "+x:"")})}function Ge(l,d){l.info(function(){return"TIMEOUT: "+d})}q.prototype.info=function(){};function Ne(l,d){if(!l.g)return d;if(!d)return null;try{var p=JSON.parse(d);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var x=p[l];if(!(2>x.length)){var D=x[1];if(Array.isArray(D)&&!(1>D.length)){var z=D[0];if(z!="noop"&&z!="stop"&&z!="close")for(var te=1;te<D.length;te++)D[te]=""}}}}return oe(p)}catch{return d}}var He={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},gn;function ar(){}b(ar,Oe),ar.prototype.g=function(){return new XMLHttpRequest},ar.prototype.i=function(){return{}},gn=new ar;function Wt(l,d,p,x){this.j=l,this.i=d,this.l=p,this.R=x||1,this.U=new ue(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ws}function Ws(){this.i=null,this.g="",this.h=!1}var Tt={},Qe={};function Kn(l,d,p){l.L=1,l.v=yu(Sr(d)),l.m=p,l.P=!0,Qi(l,null)}function Qi(l,d){l.F=Date.now(),Xi(l),l.A=Sr(l.v);var p=l.A,x=l.R;Array.isArray(x)||(x=[String(x)]),w0(p.i,"t",x),l.C=0,p=l.j.J,l.h=new Ws,l.g=F0(l.j,p?d:null,!l.m),0<l.O&&(l.M=new J(m(l.Y,l,l.g),l.O)),d=l.U,p=l.g,x=l.ca;var D="readystatechange";Array.isArray(D)||(D&&(Te[0]=D.toString()),D=Te);for(var z=0;z<D.length;z++){var te=dt(p,D[z],x||d.handleEvent,!1,d.h||d);if(!te)break;d.g[te.key]=te}d=l.H?w(l.H):{},l.m?(l.u||(l.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,d)):(l.u="GET",l.g.ea(l.A,l.u,null,d)),Hn(),V(l.i,l.u,l.A,l.l,l.R,l.m)}Wt.prototype.ca=function(l){l=l.target;const d=this.M;d&&kr(l)==3?d.j():this.Y(l)},Wt.prototype.Y=function(l){try{if(l==this.g)e:{const Yt=kr(this.g);var d=this.g.Ba();const Xs=this.g.Z();if(!(3>Yt)&&(Yt!=3||this.g&&(this.h.h||this.g.oa()||b0(this.g)))){this.J||Yt!=4||d==7||(d==8||0>=Xs?Hn(3):Hn(2)),md(this);var p=this.g.Z();this.X=p;t:if(Yi(this)){var x=b0(this.g);l="";var D=x.length,z=kr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ji(this),ma(this);var te="";break t}this.h.i=new a.TextDecoder}for(d=0;d<D;d++)this.h.h=!0,l+=this.h.i.decode(x[d],{stream:!(z&&d==D-1)});x.length=0,this.h.g+=l,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=p==200,ce(this.i,this.u,this.A,this.l,this.R,Yt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,Ft=this.g;if((Ke=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Ke)){var Le=Ke;break t}}Le=null}if(p=Le)we(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gd(this,p);else{this.o=!1,this.s=3,mt(12),Ji(this),ma(this);break e}}if(this.P){p=!0;let Wn;for(;!this.J&&this.C<te.length;)if(Wn=pu(this,te),Wn==Qe){Yt==4&&(this.s=4,mt(14),p=!1),we(this.i,this.l,null,"[Incomplete Response]");break}else if(Wn==Tt){this.s=4,mt(15),we(this.i,this.l,te,"[Invalid Chunk]"),p=!1;break}else we(this.i,this.l,Wn,null),gd(this,Wn);if(Yi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||te.length!=0||this.h.h||(this.s=1,mt(16),p=!1),this.o=this.o&&p,!p)we(this.i,this.l,te,"[Invalid Chunked Response]"),Ji(this),ma(this);else if(0<te.length&&!this.W){this.W=!0;var Qt=this.j;Qt.g==this&&Qt.ba&&!Qt.M&&(Qt.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),Ed(Qt),Qt.M=!0,mt(11))}}else we(this.i,this.l,te,null),gd(this,te);Yt==4&&Ji(this),this.o&&!this.J&&(Yt==4?V0(this.j,this):(this.o=!1,Xi(this)))}else TS(this.g),p==400&&0<te.indexOf("Unknown SID")?(this.s=3,mt(12)):(this.s=0,mt(13)),Ji(this),ma(this)}}}catch{}finally{}};function Yi(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function pu(l,d){var p=l.C,x=d.indexOf(`
`,p);return x==-1?Qe:(p=Number(d.substring(p,x)),isNaN(p)?Tt:(x+=1,x+p>d.length?Qe:(d=d.slice(x,x+p),l.C=x+p,d)))}Wt.prototype.cancel=function(){this.J=!0,Ji(this)};function Xi(l){l.S=Date.now()+l.I,pa(l,l.I)}function pa(l,d){if(l.B!=null)throw Error("WatchDog timer not null");l.B=mn(m(l.ba,l),d)}function md(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Wt.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Ge(this.i,this.A),this.L!=2&&(Hn(),mt(17)),Ji(this),this.s=2,ma(this)):pa(this,this.S-l)};function ma(l){l.j.G==0||l.J||V0(l.j,l)}function Ji(l){md(l);var d=l.M;d&&typeof d.ma=="function"&&d.ma(),l.M=null,_e(l.U),l.g&&(d=l.g,l.g=null,d.abort(),d.ma())}function gd(l,d){try{var p=l.j;if(p.G!=0&&(p.g==l||yd(p.h,l))){if(!l.K&&yd(p.h,l)&&p.G==3){try{var x=p.Da.g.parse(d)}catch{x=null}if(Array.isArray(x)&&x.length==3){var D=x;if(D[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)Iu(p),xu(p);else break e;xd(p),mt(18)}}else p.za=D[1],0<p.za-p.T&&37500>D[2]&&p.F&&p.v==0&&!p.C&&(p.C=mn(m(p.Za,p),6e3));if(1>=h0(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else es(p,11)}else if((l.K||p.g==l)&&Iu(p),!_(d))for(D=p.Da.g.parse(d),d=0;d<D.length;d++){let Le=D[d];if(p.T=Le[0],Le=Le[1],p.G==2)if(Le[0]=="c"){p.K=Le[1],p.ia=Le[2];const Qt=Le[3];Qt!=null&&(p.la=Qt,p.j.info("VER="+p.la));const Yt=Le[4];Yt!=null&&(p.Aa=Yt,p.j.info("SVER="+p.Aa));const Xs=Le[5];Xs!=null&&typeof Xs=="number"&&0<Xs&&(x=1.5*Xs,p.L=x,p.j.info("backChannelRequestTimeoutMs_="+x)),x=p;const Wn=l.g;if(Wn){const Su=Wn.g?Wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Su){var z=x.h;z.g||Su.indexOf("spdy")==-1&&Su.indexOf("quic")==-1&&Su.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(vd(z,z.h),z.h=null))}if(x.D){const Id=Wn.g?Wn.g.getResponseHeader("X-HTTP-Session-Id"):null;Id&&(x.ya=Id,Je(x.I,x.D,Id))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),x=p;var te=l;if(x.qa=L0(x,x.J?x.ia:null,x.W),te.K){d0(x.h,te);var Ke=te,Ft=x.L;Ft&&(Ke.I=Ft),Ke.B&&(md(Ke),Xi(Ke)),x.g=te}else N0(x);0<p.i.length&&Eu(p)}else Le[0]!="stop"&&Le[0]!="close"||es(p,7);else p.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?es(p,7):wd(p):Le[0]!="noop"&&p.l&&p.l.ta(Le),p.v=0)}}Hn(4)}catch{}}var lS=class{constructor(l,d){this.g=l,this.map=d}};function u0(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function c0(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function h0(l){return l.h?1:l.g?l.g.size:0}function yd(l,d){return l.h?l.h==d:l.g?l.g.has(d):!1}function vd(l,d){l.g?l.g.add(d):l.h=d}function d0(l,d){l.h&&l.h==d?l.h=null:l.g&&l.g.has(d)&&l.g.delete(d)}u0.prototype.cancel=function(){if(this.i=f0(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function f0(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let d=l.i;for(const p of l.g.values())d=d.concat(p.D);return d}return I(l.i)}function uS(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var d=[],p=l.length,x=0;x<p;x++)d.push(l[x]);return d}d=[],p=0;for(x in l)d[p++]=l[x];return d}function cS(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var d=[];l=l.length;for(var p=0;p<l;p++)d.push(p);return d}d=[],p=0;for(const x in l)d[p++]=x;return d}}}function p0(l,d){if(l.forEach&&typeof l.forEach=="function")l.forEach(d,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,d,void 0);else for(var p=cS(l),x=uS(l),D=x.length,z=0;z<D;z++)d.call(void 0,x[z],p&&p[z],l)}var m0=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hS(l,d){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var x=l[p].indexOf("="),D=null;if(0<=x){var z=l[p].substring(0,x);D=l[p].substring(x+1)}else z=l[p];d(z,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function Zi(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Zi){this.h=l.h,mu(this,l.j),this.o=l.o,this.g=l.g,gu(this,l.s),this.l=l.l;var d=l.i,p=new va;p.i=d.i,d.g&&(p.g=new Map(d.g),p.h=d.h),g0(this,p),this.m=l.m}else l&&(d=String(l).match(m0))?(this.h=!1,mu(this,d[1]||"",!0),this.o=ga(d[2]||""),this.g=ga(d[3]||"",!0),gu(this,d[4]),this.l=ga(d[5]||"",!0),g0(this,d[6]||"",!0),this.m=ga(d[7]||"")):(this.h=!1,this.i=new va(null,this.h))}Zi.prototype.toString=function(){var l=[],d=this.j;d&&l.push(ya(d,y0,!0),":");var p=this.g;return(p||d=="file")&&(l.push("//"),(d=this.o)&&l.push(ya(d,y0,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(ya(p,p.charAt(0)=="/"?pS:fS,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",ya(p,gS)),l.join("")};function Sr(l){return new Zi(l)}function mu(l,d,p){l.j=p?ga(d,!0):d,l.j&&(l.j=l.j.replace(/:$/,""))}function gu(l,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);l.s=d}else l.s=null}function g0(l,d,p){d instanceof va?(l.i=d,yS(l.i,l.h)):(p||(d=ya(d,mS)),l.i=new va(d,l.h))}function Je(l,d,p){l.i.set(d,p)}function yu(l){return Je(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ga(l,d){return l?d?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ya(l,d,p){return typeof l=="string"?(l=encodeURI(l).replace(d,dS),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function dS(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var y0=/[#\/\?@]/g,fS=/[#\?:]/g,pS=/[#\?]/g,mS=/[#\?@]/g,gS=/#/g;function va(l,d){this.h=this.g=null,this.i=l||null,this.j=!!d}function ri(l){l.g||(l.g=new Map,l.h=0,l.i&&hS(l.i,function(d,p){l.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}t=va.prototype,t.add=function(l,d){ri(this),this.i=null,l=Qs(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(d),this.h+=1,this};function v0(l,d){ri(l),d=Qs(l,d),l.g.has(d)&&(l.i=null,l.h-=l.g.get(d).length,l.g.delete(d))}function _0(l,d){return ri(l),d=Qs(l,d),l.g.has(d)}t.forEach=function(l,d){ri(this),this.g.forEach(function(p,x){p.forEach(function(D){l.call(d,D,x,this)},this)},this)},t.na=function(){ri(this);const l=Array.from(this.g.values()),d=Array.from(this.g.keys()),p=[];for(let x=0;x<d.length;x++){const D=l[x];for(let z=0;z<D.length;z++)p.push(d[x])}return p},t.V=function(l){ri(this);let d=[];if(typeof l=="string")_0(this,l)&&(d=d.concat(this.g.get(Qs(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)d=d.concat(l[p])}return d},t.set=function(l,d){return ri(this),this.i=null,l=Qs(this,l),_0(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[d]),this.h+=1,this},t.get=function(l,d){return l?(l=this.V(l),0<l.length?String(l[0]):d):d};function w0(l,d,p){v0(l,d),0<p.length&&(l.i=null,l.g.set(Qs(l,d),I(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],d=Array.from(this.g.keys());for(var p=0;p<d.length;p++){var x=d[p];const z=encodeURIComponent(String(x)),te=this.V(x);for(x=0;x<te.length;x++){var D=z;te[x]!==""&&(D+="="+encodeURIComponent(String(te[x]))),l.push(D)}}return this.i=l.join("&")};function Qs(l,d){return d=String(d),l.j&&(d=d.toLowerCase()),d}function yS(l,d){d&&!l.j&&(ri(l),l.i=null,l.g.forEach(function(p,x){var D=x.toLowerCase();x!=D&&(v0(this,x),w0(this,D,p))},l)),l.j=d}function vS(l,d){const p=new q;if(a.Image){const x=new Image;x.onload=g(ii,p,"TestLoadImage: loaded",!0,d,x),x.onerror=g(ii,p,"TestLoadImage: error",!1,d,x),x.onabort=g(ii,p,"TestLoadImage: abort",!1,d,x),x.ontimeout=g(ii,p,"TestLoadImage: timeout",!1,d,x),a.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=l}else d(!1)}function _S(l,d){const p=new q,x=new AbortController,D=setTimeout(()=>{x.abort(),ii(p,"TestPingServer: timeout",!1,d)},1e4);fetch(l,{signal:x.signal}).then(z=>{clearTimeout(D),z.ok?ii(p,"TestPingServer: ok",!0,d):ii(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),ii(p,"TestPingServer: error",!1,d)})}function ii(l,d,p,x,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),x(p)}catch{}}function wS(){this.g=new tt}function xS(l,d,p){const x=p||"";try{p0(l,function(D,z){let te=D;c(D)&&(te=oe(D)),d.push(x+z+"="+encodeURIComponent(te))})}catch(D){throw d.push(x+"type="+encodeURIComponent("_badmap")),D}}function vu(l){this.l=l.Ub||null,this.j=l.eb||!1}b(vu,Oe),vu.prototype.g=function(){return new _u(this.l,this.j)},vu.prototype.i=function(l){return function(){return l}}({});function _u(l,d){It.call(this),this.D=l,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(_u,It),t=_u.prototype,t.open=function(l,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=d,this.readyState=1,wa(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(d.body=l),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_a(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,wa(this)),this.g&&(this.readyState=3,wa(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;x0(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function x0(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var d=l.value?l.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!l.done}))&&(this.response=this.responseText+=d)}l.done?_a(this):wa(this),this.readyState==3&&x0(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,_a(this))},t.Qa=function(l){this.g&&(this.response=l,_a(this))},t.ga=function(){this.g&&_a(this)};function _a(l){l.readyState=4,l.l=null,l.j=null,l.v=null,wa(l)}t.setRequestHeader=function(l,d){this.u.append(l,d)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=d.next();return l.join(`\r
`)};function wa(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(_u.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function E0(l){let d="";return j(l,function(p,x){d+=x,d+=":",d+=p,d+=`\r
`}),d}function _d(l,d,p){e:{for(x in p){var x=!1;break e}x=!0}x||(p=E0(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Je(l,d,p))}function gt(l){It.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(gt,It);var ES=/^https?$/i,IS=["POST","PUT"];t=gt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,d,p,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);d=d?d.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():gn.g(),this.v=this.o?Xe(this.o):Xe(gn),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(l),!0),this.B=!1}catch(z){I0(this,z);return}if(l=p||"",p=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var D in x)p.set(D,x[D]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const z of x.keys())p.set(z,x.get(z));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(p.keys()).find(z=>z.toLowerCase()=="content-type"),D=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(IS,d,void 0))||x||D||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,te]of p)this.g.setRequestHeader(z,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{k0(this),this.u=!0,this.g.send(l),this.u=!1}catch(z){I0(this,z)}};function I0(l,d){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=d,l.m=5,T0(l),wu(l)}function T0(l){l.A||(l.A=!0,wt(l,"complete"),wt(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,wt(this,"complete"),wt(this,"abort"),wu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wu(this,!0)),gt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?S0(this):this.bb())},t.bb=function(){S0(this)};function S0(l){if(l.h&&typeof o<"u"&&(!l.v[1]||kr(l)!=4||l.Z()!=2)){if(l.u&&kr(l)==4)Er(l.Ea,0,l);else if(wt(l,"readystatechange"),kr(l)==4){l.h=!1;try{const te=l.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var x;if(x=te===0){var D=String(l.D).match(m0)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),x=!ES.test(D?D.toLowerCase():"")}p=x}if(p)wt(l,"complete"),wt(l,"success");else{l.m=6;try{var z=2<kr(l)?l.g.statusText:""}catch{z=""}l.l=z+" ["+l.Z()+"]",T0(l)}}finally{wu(l)}}}}function wu(l,d){if(l.g){k0(l);const p=l.g,x=l.v[0]?()=>{}:null;l.g=null,l.v=null,d||wt(l,"ready");try{p.onreadystatechange=x}catch{}}}function k0(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function kr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<kr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var d=this.g.responseText;return l&&d.indexOf(l)==0&&(d=d.substring(l.length)),xt(d)}};function b0(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function TS(l){const d={};l=(l.g&&2<=kr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<l.length;x++){if(_(l[x]))continue;var p=R(l[x]);const D=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const z=d[D]||[];d[D]=z,z.push(p)}E(d,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xa(l,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||d}function A0(l){this.Aa=0,this.i=[],this.j=new q,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xa("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xa("baseRetryDelayMs",5e3,l),this.cb=xa("retryDelaySeedMs",1e4,l),this.Wa=xa("forwardChannelMaxRetries",2,l),this.wa=xa("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new u0(l&&l.concurrentRequestLimit),this.Da=new wS,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=A0.prototype,t.la=8,t.G=1,t.connect=function(l,d,p,x){mt(0),this.W=l,this.H=d||{},p&&x!==void 0&&(this.H.OSID=p,this.H.OAID=x),this.F=this.X,this.I=L0(this,null,this.W),Eu(this)};function wd(l){if(R0(l),l.G==3){var d=l.U++,p=Sr(l.I);if(Je(p,"SID",l.K),Je(p,"RID",d),Je(p,"TYPE","terminate"),Ea(l,p),d=new Wt(l,l.j,d),d.L=2,d.v=yu(Sr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=d.v,p=!0),p||(d.g=F0(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Xi(d)}O0(l)}function xu(l){l.g&&(Ed(l),l.g.cancel(),l.g=null)}function R0(l){xu(l),l.u&&(a.clearTimeout(l.u),l.u=null),Iu(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Eu(l){if(!c0(l.h)&&!l.s){l.s=!0;var d=l.Ga;ee||W(),B||(ee(),B=!0),K.add(d,l),l.B=0}}function SS(l,d){return h0(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=d.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=mn(m(l.Ga,l,d),M0(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const D=new Wt(this,this.j,l);let z=this.o;if(this.S&&(z?(z=w(z),A(z,this.S)):z=this.S),this.m!==null||this.O||(D.H=z,z=null),this.P)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var x=this.i[p];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(d+=x,4096<d){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=C0(this,D,d),p=Sr(this.I),Je(p,"RID",l),Je(p,"CVER",22),this.D&&Je(p,"X-HTTP-Session-Id",this.D),Ea(this,p),z&&(this.O?d="headers="+encodeURIComponent(String(E0(z)))+"&"+d:this.m&&_d(p,this.m,z)),vd(this.h,D),this.Ua&&Je(p,"TYPE","init"),this.P?(Je(p,"$req",d),Je(p,"SID","null"),D.T=!0,Kn(D,p,null)):Kn(D,p,d),this.G=2}}else this.G==3&&(l?P0(this,l):this.i.length==0||c0(this.h)||P0(this))};function P0(l,d){var p;d?p=d.l:p=l.U++;const x=Sr(l.I);Je(x,"SID",l.K),Je(x,"RID",p),Je(x,"AID",l.T),Ea(l,x),l.m&&l.o&&_d(x,l.m,l.o),p=new Wt(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),d&&(l.i=d.D.concat(l.i)),d=C0(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),vd(l.h,p),Kn(p,x,d)}function Ea(l,d){l.H&&j(l.H,function(p,x){Je(d,x,p)}),l.l&&p0({},function(p,x){Je(d,x,p)})}function C0(l,d,p){p=Math.min(l.i.length,p);var x=l.l?m(l.l.Na,l.l,l):null;e:{var D=l.i;let z=-1;for(;;){const te=["count="+p];z==-1?0<p?(z=D[0].g,te.push("ofs="+z)):z=0:te.push("ofs="+z);let Ke=!0;for(let Ft=0;Ft<p;Ft++){let Le=D[Ft].g;const Qt=D[Ft].map;if(Le-=z,0>Le)z=Math.max(0,D[Ft].g-100),Ke=!1;else try{xS(Qt,te,"req"+Le+"_")}catch{x&&x(Qt)}}if(Ke){x=te.join("&");break e}}}return l=l.i.splice(0,p),d.D=l,x}function N0(l){if(!l.g&&!l.u){l.Y=1;var d=l.Fa;ee||W(),B||(ee(),B=!0),K.add(d,l),l.v=0}}function xd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=mn(m(l.Fa,l),M0(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,D0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=mn(m(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mt(10),xu(this),D0(this))};function Ed(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function D0(l){l.g=new Wt(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var d=Sr(l.qa);Je(d,"RID","rpc"),Je(d,"SID",l.K),Je(d,"AID",l.T),Je(d,"CI",l.F?"0":"1"),!l.F&&l.ja&&Je(d,"TO",l.ja),Je(d,"TYPE","xmlhttp"),Ea(l,d),l.m&&l.o&&_d(d,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=yu(Sr(d)),p.m=null,p.P=!0,Qi(p,l)}t.Za=function(){this.C!=null&&(this.C=null,xu(this),xd(this),mt(19))};function Iu(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function V0(l,d){var p=null;if(l.g==d){Iu(l),Ed(l),l.g=null;var x=2}else if(yd(l.h,d))p=d.D,d0(l.h,d),x=1;else return;if(l.G!=0){if(d.o)if(x==1){p=d.m?d.m.length:0,d=Date.now()-d.F;var D=l.B;x=ti(),wt(x,new Vt(x,p)),Eu(l)}else N0(l);else if(D=d.s,D==3||D==0&&0<d.X||!(x==1&&SS(l,d)||x==2&&xd(l)))switch(p&&0<p.length&&(d=l.h,d.i=d.i.concat(p)),D){case 1:es(l,5);break;case 4:es(l,10);break;case 3:es(l,6);break;default:es(l,2)}}}function M0(l,d){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*d}function es(l,d){if(l.j.info("Error code "+d),d==2){var p=m(l.fb,l),x=l.Xa;const D=!x;x=new Zi(x||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||mu(x,"https"),yu(x),D?vS(x.toString(),p):_S(x.toString(),p)}else mt(2);l.G=0,l.l&&l.l.sa(d),O0(l),R0(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function O0(l){if(l.G=0,l.ka=[],l.l){const d=f0(l.h);(d.length!=0||l.i.length!=0)&&(P(l.ka,d),P(l.ka,l.i),l.h.i.length=0,I(l.i),l.i.length=0),l.l.ra()}}function L0(l,d,p){var x=p instanceof Zi?Sr(p):new Zi(p);if(x.g!="")d&&(x.g=d+"."+x.g),gu(x,x.s);else{var D=a.location;x=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;var z=new Zi(null);x&&mu(z,x),d&&(z.g=d),D&&gu(z,D),p&&(z.l=p),x=z}return p=l.D,d=l.ya,p&&d&&Je(x,p,d),Je(x,"VER",l.la),Ea(l,x),x}function F0(l,d,p){if(d&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=l.Ca&&!l.pa?new gt(new vu({eb:p})):new gt(l.pa),d.Ha(l.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function j0(){}t=j0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Tu(){}Tu.prototype.g=function(l,d){return new kn(l,d)};function kn(l,d){It.call(this),this.g=new A0(d),this.l=l,this.h=d&&d.messageUrlParams||null,l=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(l?l["X-WebChannel-Content-Type"]=d.messageContentType:l={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(l?l["X-WebChannel-Client-Profile"]=d.va:l={"X-WebChannel-Client-Profile":d.va}),this.g.S=l,(l=d&&d.Sb)&&!_(l)&&(this.g.m=l),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!_(d)&&(this.g.D=d,l=this.h,l!==null&&d in l&&(l=this.h,d in l&&delete l[d])),this.j=new Ys(this)}b(kn,It),kn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){wd(this.g)},kn.prototype.o=function(l){var d=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=oe(l),l=p);d.i.push(new lS(d.Ya++,l)),d.G==3&&Eu(d)},kn.prototype.N=function(){this.g.l=null,delete this.j,wd(this.g),delete this.g,kn.aa.N.call(this)};function z0(l){We.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var d=l.__sm__;if(d){e:{for(const p in d){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,d=d!==null&&l in d?d[l]:void 0),this.data=d}else this.data=l}b(z0,We);function U0(){Dt.call(this),this.status=1}b(U0,Dt);function Ys(l){this.g=l}b(Ys,j0),Ys.prototype.ua=function(){wt(this.g,"a")},Ys.prototype.ta=function(l){wt(this.g,new z0(l))},Ys.prototype.sa=function(l){wt(this.g,new U0)},Ys.prototype.ra=function(){wt(this.g,"b")},Tu.prototype.createWebChannel=Tu.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,uI=function(){return new Tu},lI=function(){return ti()},aI=nt,Mp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},He.NO_ERROR=0,He.TIMEOUT=8,He.HTTP_ERROR=6,Ec=He,Kt.COMPLETE="complete",oI=Kt,pt.EventType=be,be.OPEN="a",be.CLOSE="b",be.ERROR="c",be.MESSAGE="d",It.prototype.listen=It.prototype.K,Ga=pt,gt.prototype.listenOnce=gt.prototype.L,gt.prototype.getLastError=gt.prototype.Ka,gt.prototype.getLastErrorCode=gt.prototype.Ba,gt.prototype.getStatus=gt.prototype.Z,gt.prototype.getResponseJson=gt.prototype.Oa,gt.prototype.getResponseText=gt.prototype.oa,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Ha,sI=gt}).apply(typeof Qu<"u"?Qu:typeof self<"u"?self:typeof window<"u"?window:{});const u_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ua="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=new dg("@firebase/firestore");function so(){return Vs.logLevel}function Q(t,...e){if(Vs.logLevel<=Re.DEBUG){const n=e.map(kg);Vs.debug(`Firestore (${ua}): ${t}`,...n)}}function an(t,...e){if(Vs.logLevel<=Re.ERROR){const n=e.map(kg);Vs.error(`Firestore (${ua}): ${t}`,...n)}}function Ms(t,...e){if(Vs.logLevel<=Re.WARN){const n=e.map(kg);Vs.warn(`Firestore (${ua}): ${t}`,...n)}}function kg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t="Unexpected state"){const e=`FIRESTORE (${ua}) INTERNAL ASSERTION FAILED: `+t;throw an(e),new Error(e)}function pe(t,e){t||he()}function Ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Zr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class m4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Bt.UNAUTHENTICATED))}shutdown(){}}class g4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class y4{constructor(e){this.t=e,this.currentUser=Bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){pe(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new $r;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new $r,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},a=u=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new $r)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pe(typeof r.accessToken=="string"),new cI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pe(e===null||typeof e=="string"),new Bt(e)}}class v4{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class _4{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new v4(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class w4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class x4{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){pe(this.o===void 0);const r=s=>{s.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(pe(typeof n.token=="string"),this.R=n.token,new w4(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=E4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Se(t,e){return t<e?-1:t>e?1:0}function Qo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function dI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new re(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ct(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Se(this.nanoseconds,e.nanoseconds):Se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ve(e)}static min(){return new ve(new ct(0,0))}static max(){return new ve(new ct(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(),r===void 0?r=e.length-n:r>e.length-n&&he(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ol.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ol?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ze extends Ol{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(G.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const I4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends Ol{construct(e,n,r){return new lt(e,n,r)}static isValidIdentifier(e){return I4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new lt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new re(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lt(n)}static emptyPath(){return new lt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(ze.fromString(e))}static fromName(e){return new ie(ze.fromString(e).popFirst(5))}static empty(){return new ie(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new ze(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Op(t){return t.fields.find(e=>e.kind===2)}function os(t){return t.fields.filter(e=>e.kind!==2)}gh.UNKNOWN_ID=-1;class Ic{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ll{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ll(0,Dn.min())}}function T4(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ve.fromTimestamp(r===1e9?new ct(n+1,0):new ct(n,r));return new Dn(i,ie.empty(),e)}function fI(t){return new Dn(t.readTime,t.key,-1)}class Dn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Dn(ve.min(),ie.empty(),-1)}static max(){return new Dn(ve.max(),ie.empty(),-1)}}function bg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:Se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qs(t){if(t.code!==G.FAILED_PRECONDITION||t.message!==pI)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new M((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof M?n:M.resolve(n)}catch(n){return M.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):M.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):M.reject(n)}static resolve(e){return new M((n,r)=>{n(e)})}static reject(e){return new M((n,r)=>{r(e)})}static waitFor(e){return new M((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=M.resolve(!1);for(const r of e)n=n.next(i=>i?M.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new M((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const c=u;n(e[c]).next(h=>{o[c]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new M((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new $r,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new al(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Ag(r.target.error);this.V.reject(new al(e,i))}}static open(e,n,r,i){try{return new Jh(n,e.transaction(i,r))}catch(s){throw new al(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new k4(n)}}class Di{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Di.S(Pt())===12.2&&an("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Q("SimpleDb","Removing database:",e),ls(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!wE())return!1;if(Di.v())return!0;const e=Pt(),n=Di.S(e),r=0<n&&n<10,i=gI(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(Q("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new al(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(G.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(G.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new al(e,o))},i.onupgradeneeded=s=>{Q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{Q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Jh.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),M.reject(c))).toPromise();return u.catch(()=>{}),await a.m,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(Q("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function gI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class S4{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ls(this.B.delete())}}class al extends re{constructor(e,n){super(G.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Gi(t){return t.name==="IndexedDbTransactionError"}class k4{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Q("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ls(r)}add(e){return Q("SimpleDb","ADD",this.store.name,e,e),ls(this.store.add(e))}get(e){return ls(this.store.get(e)).next(n=>(n===void 0&&(n=null),Q("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Q("SimpleDb","DELETE",this.store.name,e),ls(this.store.delete(e))}count(){return Q("SimpleDb","COUNT",this.store.name),ls(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new M((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,u)=>{o.push(u)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new M((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){Q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new M((r,i)=>{n.onerror=s=>{const o=Ag(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new M((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new S4(a),c=n(a.primaryKey,a.value,u);if(c instanceof M){const h=c.catch(f=>(u.done(),M.reject(f)));r.push(h)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>M.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ls(t){return new M((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Ag(r.target.error);n(i)}})}let c_=!1;function Ag(t){const e=Di.S(Pt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return c_||(c_=!0,setTimeout(()=>{throw r},0)),r}}return t}class b4{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Gi(n)?Q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await qs(n)}await this.X(6e4)})}}class A4{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return M.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Q("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(Q("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=fI(s);bg(o,r)>0&&(r=o)}),new Dn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Un.oe=-1;function Zh(t){return t==null}function Fl(t){return t===0&&1/t==-1/0}function R4(t){return typeof t=="number"&&Number.isInteger(t)&&!Fl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=h_(e)),e=P4(t.get(n),e);return h_(e)}function P4(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function h_(t){return t+""}function hr(t){const e=t.length;if(pe(e>=2),e===2)return pe(t.charAt(0)===""&&t.charAt(1)===""),ze.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&he(),t.charAt(o+1)){case"":const a=t.substring(s,o);let u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:he()}s=o+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t,e){return[t,un(e)]}function yI(t,e,n){return[t,un(e),n]}const C4={},N4=["prefixPath","collectionGroup","readTime","documentId"],D4=["prefixPath","collectionGroup","documentId"],V4=["collectionGroup","readTime","prefixPath","documentId"],M4=["canonicalId","targetId"],O4=["targetId","path"],L4=["path","targetId"],F4=["collectionId","parent"],j4=["indexId","uid"],z4=["uid","sequenceNumber"],U4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],B4=["indexId","uid","orderedDocumentKey"],$4=["userId","collectionPath","documentId"],q4=["userId","collectionPath","largestBatchId"],G4=["userId","collectionGroup","largestBatchId"],vI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],H4=[...vI,"documentOverlays"],_I=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],wI=_I,Rg=[...wI,"indexConfiguration","indexState","indexEntries"],K4=Rg,W4=[...Rg,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp extends mI{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Nt(t,e){const n=Ie(t);return Di.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,n){this.comparator=e,this.root=n||$t.EMPTY}insert(e,n){return new st(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$t.BLACK,null,null))}remove(e){return new st(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yu(this.root,e,this.comparator,!0)}}class Yu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??$t.RED,this.left=i??$t.EMPTY,this.right=s??$t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new $t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return $t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw he();const e=this.left.check();if(e!==this.right.check())throw he();return e+(this.isRed()?0:1)}}$t.EMPTY=null,$t.RED=!0,$t.BLACK=!1;$t.EMPTY=new class{constructor(){this.size=0}get key(){throw he()}get value(){throw he()}get color(){throw he()}get left(){throw he()}get right(){throw he()}copy(e,n,r,i,s){return this}insert(e,n,r){return new $t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new p_(this.data.getIterator())}getIteratorFrom(e){return new p_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof $e)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new $e(this.comparator);return n.data=e,n}}class p_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Zs(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.fields=e,e.sort(lt.comparator)}static empty(){return new En([])}unionWith(e){let n=new $e(lt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new En(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Qo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new EI("Invalid base64 string: "+s):s}}(e);return new bt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new bt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const Q4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xr(t){if(pe(!!t),typeof t=="string"){let e=0;const n=Q4.exec(t);if(pe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rt(t.seconds),nanos:rt(t.nanos)}}function rt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fi(t){return typeof t=="string"?bt.fromBase64String(t):bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Cg(t){const e=t.mapValue.fields.__previous_value__;return Pg(e)?Cg(e):e}function jl(t){const e=Xr(t.mapValue.fields.__local_write_time__.timestampValue);return new ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class Os{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Os("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Os&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Sc={nullValue:"NULL_VALUE"};function Ls(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Pg(t)?4:II(t)?9007199254740991:ed(t)?10:11:he()}function vr(t,e){if(t===e)return!0;const n=Ls(t);if(n!==Ls(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jl(t).isEqual(jl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Xr(i.timestampValue),a=Xr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Fi(i.bytesValue).isEqual(Fi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return rt(i.geoPointValue.latitude)===rt(s.geoPointValue.latitude)&&rt(i.geoPointValue.longitude)===rt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return rt(i.integerValue)===rt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=rt(i.doubleValue),a=rt(s.doubleValue);return o===a?Fl(o)===Fl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Qo(t.arrayValue.values||[],e.arrayValue.values||[],vr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(f_(o)!==f_(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!vr(o[u],a[u])))return!1;return!0}(t,e);default:return he()}}function zl(t,e){return(t.values||[]).find(n=>vr(n,e))!==void 0}function ji(t,e){if(t===e)return 0;const n=Ls(t),r=Ls(e);if(n!==r)return Se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Se(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=rt(s.integerValue||s.doubleValue),u=rt(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return m_(t.timestampValue,e.timestampValue);case 4:return m_(jl(t),jl(e));case 5:return Se(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Fi(s),u=Fi(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){const h=Se(a[c],u[c]);if(h!==0)return h}return Se(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Se(rt(s.latitude),rt(o.latitude));return a!==0?a:Se(rt(s.longitude),rt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return g_(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,u,c,h;const f=s.fields||{},m=o.fields||{},g=(a=f.value)===null||a===void 0?void 0:a.arrayValue,b=(u=m.value)===null||u===void 0?void 0:u.arrayValue,I=Se(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((h=b==null?void 0:b.values)===null||h===void 0?void 0:h.length)||0);return I!==0?I:g_(g,b)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===xi.mapValue&&o===xi.mapValue)return 0;if(s===xi.mapValue)return 1;if(o===xi.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),c=o.fields||{},h=Object.keys(c);u.sort(),h.sort();for(let f=0;f<u.length&&f<h.length;++f){const m=Se(u[f],h[f]);if(m!==0)return m;const g=ji(a[u[f]],c[h[f]]);if(g!==0)return g}return Se(u.length,h.length)}(t.mapValue,e.mapValue);default:throw he()}}function m_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Se(t,e);const n=Xr(t),r=Xr(e),i=Se(n.seconds,r.seconds);return i!==0?i:Se(n.nanos,r.nanos)}function g_(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ji(n[i],r[i]);if(s)return s}return Se(n.length,r.length)}function Yo(t){return Fp(t)}function Fp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Xr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Fi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Fp(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Fp(n.fields[o])}`;return i+"}"}(t.mapValue):he()}function Ul(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function jp(t){return!!t&&"integerValue"in t}function Bl(t){return!!t&&"arrayValue"in t}function y_(t){return!!t&&"nullValue"in t}function v_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function kc(t){return!!t&&"mapValue"in t}function ed(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ll(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Gs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ll(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ll(t.arrayValue.values[n]);return e}return Object.assign({},t)}function II(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const TI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function X4(t){return"nullValue"in t?Sc:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ul(Os.empty(),ie.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?ed(t)?TI:{mapValue:{}}:he()}function J4(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ul(Os.empty(),ie.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?TI:"mapValue"in t?ed(t)?{mapValue:{}}:xi:he()}function __(t,e){const n=ji(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function w_(t,e){const n=ji(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.value=e}static empty(){return new tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!kc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ll(n)}setAll(e){let n=lt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ll(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());kc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return vr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];kc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Gs(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new tn(ll(this.value))}}function SI(t){const e=[];return Gs(t.fields,(n,r)=>{const i=new lt([n]);if(kc(r)){const s=SI(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new En(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new vt(e,0,ve.min(),ve.min(),ve.min(),tn.empty(),0)}static newFoundDocument(e,n,r,i){return new vt(e,1,n,ve.min(),r,i,0)}static newNoDocument(e,n){return new vt(e,2,n,ve.min(),ve.min(),tn.empty(),0)}static newUnknownDocument(e,n){return new vt(e,3,n,ve.min(),ve.min(),tn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n){this.position=e,this.inclusive=n}}function x_(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ie.comparator(ie.fromName(o.referenceValue),n.key):r=ji(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function E_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!vr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,n="asc"){this.field=e,this.dir=n}}function Z4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{}class Pe extends kI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new eM(e,n,r):n==="array-contains"?new rM(e,r):n==="in"?new NI(e,r):n==="not-in"?new iM(e,r):n==="array-contains-any"?new sM(e,r):new Pe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new tM(e,r):new nM(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ji(n,this.value)):n!==null&&Ls(this.value)===Ls(n)&&this.matchesComparison(ji(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ue extends kI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ue(e,n)}matches(e){return Jo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Jo(t){return t.op==="and"}function zp(t){return t.op==="or"}function Ng(t){return bI(t)&&Jo(t)}function bI(t){for(const e of t.filters)if(e instanceof Ue)return!1;return!0}function Up(t){if(t instanceof Pe)return t.field.canonicalString()+t.op.toString()+Yo(t.value);if(Ng(t))return t.filters.map(e=>Up(e)).join(",");{const e=t.filters.map(n=>Up(n)).join(",");return`${t.op}(${e})`}}function AI(t,e){return t instanceof Pe?function(r,i){return i instanceof Pe&&r.op===i.op&&r.field.isEqual(i.field)&&vr(r.value,i.value)}(t,e):t instanceof Ue?function(r,i){return i instanceof Ue&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&AI(o,i.filters[a]),!0):!1}(t,e):void he()}function RI(t,e){const n=t.filters.concat(e);return Ue.create(n,t.op)}function PI(t){return t instanceof Pe?function(n){return`${n.field.canonicalString()} ${n.op} ${Yo(n.value)}`}(t):t instanceof Ue?function(n){return n.op.toString()+" {"+n.getFilters().map(PI).join(" ,")+"}"}(t):"Filter"}class eM extends Pe{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class tM extends Pe{constructor(e,n){super(e,"in",n),this.keys=CI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class nM extends Pe{constructor(e,n){super(e,"not-in",n),this.keys=CI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function CI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class rM extends Pe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bl(n)&&zl(n.arrayValue,this.value)}}class NI extends Pe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&zl(this.value.arrayValue,n)}}class iM extends Pe{constructor(e,n){super(e,"not-in",n)}matches(e){if(zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!zl(this.value.arrayValue,n)}}class sM extends Pe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Bp(t,e=null,n=[],r=[],i=null,s=null,o=null){return new oM(t,e,n,r,i,s,o)}function Fs(t){const e=Ie(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Up(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Zh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Yo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Yo(r)).join(",")),e.ue=n}return e.ue}function iu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Z4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!AI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!E_(t.startAt,e.startAt)&&E_(t.endAt,e.endAt)}function vh(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function _h(t,e){return t.filters.filter(n=>n instanceof Pe&&n.field.isEqual(e))}function I_(t,e,n){let r=Sc,i=!0;for(const s of _h(t,e)){let o=Sc,a=!0;switch(s.op){case"<":case"<=":o=X4(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Sc}__({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];__({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function T_(t,e,n){let r=xi,i=!0;for(const s of _h(t,e)){let o=xi,a=!0;switch(s.op){case">=":case">":o=J4(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=xi}w_({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];w_({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function aM(t,e,n,r,i,s,o,a){return new su(t,e,n,r,i,s,o,a)}function ou(t){return new su(t)}function S_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function DI(t){return t.collectionGroup!==null}function ul(t){const e=Ie(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new $e(lt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new yh(s,r))}),n.has(lt.keyField().canonicalString())||e.ce.push(new yh(lt.keyField(),r))}return e.ce}function $n(t){const e=Ie(t);return e.le||(e.le=lM(e,ul(t))),e.le}function lM(t,e){if(t.limitType==="F")return Bp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new yh(i.field,s)});const n=t.endAt?new Xo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Xo(t.startAt.position,t.startAt.inclusive):null;return Bp(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function $p(t,e){const n=t.filters.concat([e]);return new su(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qp(t,e,n){return new su(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function td(t,e){return iu($n(t),$n(e))&&t.limitType===e.limitType}function VI(t){return`${Fs($n(t))}|lt:${t.limitType}`}function oo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>PI(i)).join(", ")}]`),Zh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Yo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Yo(i)).join(",")),`Target(${r})`}($n(t))}; limitType=${t.limitType})`}function au(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ie.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ul(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){const c=x_(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,ul(r),i)||r.endAt&&!function(o,a,u){const c=x_(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,ul(r),i))}(t,e)}function uM(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function MI(t){return(e,n)=>{let r=!1;for(const i of ul(t)){const s=cM(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function cM(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(s,o,a){const u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?ji(u,c):he()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gs(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return xI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM=new st(ie.comparator);function Rn(){return hM}const OI=new st(ie.comparator);function Ha(...t){let e=OI;for(const n of t)e=e.insert(n.key,n);return e}function LI(t){let e=OI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function dr(){return cl()}function FI(){return cl()}function cl(){return new Hi(t=>t.toString(),(t,e)=>t.isEqual(e))}const dM=new st(ie.comparator),fM=new $e(ie.comparator);function ke(...t){let e=fM;for(const n of t)e=e.add(n);return e}const pM=new $e(Se);function mM(){return pM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fl(e)?"-0":e}}function jI(t){return{integerValue:""+t}}function gM(t,e){return R4(e)?jI(e):Dg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(){this._=void 0}}function yM(t,e,n){return t instanceof $l?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Pg(s)&&(s=Cg(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Zo?UI(t,e):t instanceof ea?BI(t,e):function(i,s){const o=zI(i,s),a=k_(o)+k_(i.Pe);return jp(o)&&jp(i.Pe)?jI(a):Dg(i.serializer,a)}(t,e)}function vM(t,e,n){return t instanceof Zo?UI(t,e):t instanceof ea?BI(t,e):n}function zI(t,e){return t instanceof ql?function(r){return jp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class $l extends nd{}class Zo extends nd{constructor(e){super(),this.elements=e}}function UI(t,e){const n=$I(e);for(const r of t.elements)n.some(i=>vr(i,r))||n.push(r);return{arrayValue:{values:n}}}class ea extends nd{constructor(e){super(),this.elements=e}}function BI(t,e){let n=$I(e);for(const r of t.elements)n=n.filter(i=>!vr(i,r));return{arrayValue:{values:n}}}class ql extends nd{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function k_(t){return rt(t.integerValue||t.doubleValue)}function $I(t){return Bl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e,n){this.field=e,this.transform=n}}function wM(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Zo&&i instanceof Zo||r instanceof ea&&i instanceof ea?Qo(r.elements,i.elements,vr):r instanceof ql&&i instanceof ql?vr(r.Pe,i.Pe):r instanceof $l&&i instanceof $l}(t.transform,e.transform)}class xM{constructor(e,n){this.version=e,this.transformResults=n}}class qt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new qt}static exists(e){return new qt(void 0,e)}static updateTime(e){return new qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class rd{}function qI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lu(t.key,qt.none()):new ca(t.key,t.data,qt.none());{const n=t.data,r=tn.empty();let i=new $e(lt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ei(t.key,r,new En(i.toArray()),qt.none())}}function EM(t,e,n){t instanceof ca?function(i,s,o){const a=i.value.clone(),u=A_(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ei?function(i,s,o){if(!bc(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=A_(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(GI(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function hl(t,e,n,r){return t instanceof ca?function(s,o,a,u){if(!bc(s.precondition,o))return a;const c=s.value.clone(),h=R_(s.fieldTransforms,u,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ei?function(s,o,a,u){if(!bc(s.precondition,o))return a;const c=R_(s.fieldTransforms,u,o),h=o.data;return h.setAll(GI(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return bc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function IM(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=zI(r.transform,i||null);s!=null&&(n===null&&(n=tn.empty()),n.set(r.field,s))}return n||null}function b_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Qo(r,i,(s,o)=>wM(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ca extends rd{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ei extends rd{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function GI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function A_(t,e,n){const r=new Map;pe(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,vM(o,a,n[i]))}return r}function R_(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,yM(s,o,e))}return r}class lu extends rd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HI extends rd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&EM(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=hl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=hl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=FI();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=qI(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&Qo(this.mutations,e.mutations,(n,r)=>b_(n,r))&&Qo(this.baseMutations,e.baseMutations,(n,r)=>b_(n,r))}}class Mg{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){pe(e.mutations.length===r.length);let i=function(){return dM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Mg(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St,De;function SM(t){switch(t){default:return he();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0}}function KI(t){if(t===void 0)return an("GRPC error has no .code"),G.UNKNOWN;switch(t){case St.OK:return G.OK;case St.CANCELLED:return G.CANCELLED;case St.UNKNOWN:return G.UNKNOWN;case St.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case St.INTERNAL:return G.INTERNAL;case St.UNAVAILABLE:return G.UNAVAILABLE;case St.UNAUTHENTICATED:return G.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case St.NOT_FOUND:return G.NOT_FOUND;case St.ALREADY_EXISTS:return G.ALREADY_EXISTS;case St.PERMISSION_DENIED:return G.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case St.ABORTED:return G.ABORTED;case St.OUT_OF_RANGE:return G.OUT_OF_RANGE;case St.UNIMPLEMENTED:return G.UNIMPLEMENTED;case St.DATA_LOSS:return G.DATA_LOSS;default:return he()}}(De=St||(St={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM=new Ts([4294967295,4294967295],0);function P_(t){const e=kM().encode(t),n=new iI;return n.update(e),new Uint8Array(n.digest())}function C_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ts([n,r],0),new Ts([i,s],0)]}class Lg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ka(`Invalid padding: ${n}`);if(r<0)throw new Ka(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ka(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ka(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ts.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Ts.fromNumber(r)));return i.compare(bM)===1&&(i=new Ts([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=P_(e),[r,i]=C_(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Lg(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=P_(e),[r,i]=C_(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ka extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,uu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new id(ve.min(),i,new st(Se),Rn(),ke())}}class uu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new uu(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class WI{constructor(e,n){this.targetId=e,this.me=n}}class QI{constructor(e,n,r=bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class N_{constructor(){this.fe=0,this.ge=V_(),this.pe=bt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ke(),n=ke(),r=ke();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he()}}),new uu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=V_()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,pe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class AM{constructor(e){this.Le=e,this.Be=new Map,this.ke=Rn(),this.qe=D_(),this.Qe=new st(Se)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:he()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(vh(s))if(r===0){const o=new ie(s.path);this.Ue(n,o,vt.newNoDocument(o,ve.min()))}else pe(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Fi(r).toUint8Array()}catch(u){if(u instanceof EI)return Ms("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Lg(o,i,s)}catch(u){return Ms(u instanceof Ka?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&vh(a.target)){const u=new ie(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,vt.newNoDocument(u,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=ke();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new id(e,n,this.Qe,this.ke,r);return this.ke=Rn(),this.qe=D_(),this.Qe=new st(Se),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new N_,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new $e(Se),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new N_),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function D_(){return new st(ie.comparator)}function V_(){return new st(ie.comparator)}const RM={asc:"ASCENDING",desc:"DESCENDING"},PM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CM={and:"AND",or:"OR"};class NM{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Gp(t,e){return t.useProto3Json||Zh(e)?e:{value:e}}function ta(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function DM(t,e){return ta(t,e.toTimestamp())}function cn(t){return pe(!!t),ve.fromTimestamp(function(n){const r=Xr(n);return new ct(r.seconds,r.nanos)}(t))}function Fg(t,e){return Hp(t,e).canonicalString()}function Hp(t,e){const n=function(i){return new ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function XI(t){const e=ze.fromString(t);return pe(oT(e)),e}function wh(t,e){return Fg(t.databaseId,e.path)}function Ss(t,e){const n=XI(e);if(n.get(1)!==t.databaseId.projectId)throw new re(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(eT(n))}function JI(t,e){return Fg(t.databaseId,e)}function ZI(t){const e=XI(t);return e.length===4?ze.emptyPath():eT(e)}function Kp(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eT(t){return pe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function M_(t,e,n){return{name:wh(t,e),fields:n.value.mapValue.fields}}function VM(t,e,n){const r=Ss(t,e.name),i=cn(e.updateTime),s=e.createTime?cn(e.createTime):ve.min(),o=new tn({mapValue:{fields:e.fields}}),a=vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function MM(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:he()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?(pe(h===void 0||typeof h=="string"),bt.fromBase64String(h||"")):(pe(h===void 0||h instanceof Buffer||h instanceof Uint8Array),bt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?G.UNKNOWN:KI(c.code);return new re(h,c.message||"")}(o);n=new QI(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ss(t,r.document.name),s=cn(r.document.updateTime),o=r.document.createTime?cn(r.document.createTime):ve.min(),a=new tn({mapValue:{fields:r.document.fields}}),u=vt.newFoundDocument(i,s,o,a),c=r.targetIds||[],h=r.removedTargetIds||[];n=new Ac(c,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ss(t,r.document),s=r.readTime?cn(r.readTime):ve.min(),o=vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ac([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ss(t,r.document),s=r.removedTargetIds||[];n=new Ac([],s,i,null)}else{if(!("filter"in e))return he();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new TM(i,s),a=r.targetId;n=new WI(a,o)}}return n}function xh(t,e){let n;if(e instanceof ca)n={update:M_(t,e.key,e.value)};else if(e instanceof lu)n={delete:wh(t,e.key)};else if(e instanceof ei)n={update:M_(t,e.key,e.data),updateMask:UM(e.fieldMask)};else{if(!(e instanceof HI))return he();n={verify:wh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof $l)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Zo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ea)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ql)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw he()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:DM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he()}(t,e.precondition)),n}function Wp(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?qt.updateTime(cn(s.updateTime)):s.exists!==void 0?qt.exists(s.exists):qt.none()}(e.currentDocument):qt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)pe(a.setToServerValue==="REQUEST_TIME"),u=new $l;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];u=new Zo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];u=new ea(h)}else"increment"in a?u=new ql(o,a.increment):he();const c=lt.fromServerFormat(a.fieldPath);return new _M(c,u)}(t,i)):[];if(e.update){e.update.name;const i=Ss(t,e.update.name),s=new tn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new En(c.map(h=>lt.fromServerFormat(h)))}(e.updateMask);return new ei(i,s,o,n,r)}return new ca(i,s,n,r)}if(e.delete){const i=Ss(t,e.delete);return new lu(i,n)}if(e.verify){const i=Ss(t,e.verify);return new HI(i,n)}return he()}function OM(t,e){return t&&t.length>0?(pe(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?cn(i.updateTime):cn(s);return o.isEqual(ve.min())&&(o=cn(s)),new xM(o,i.transformResults||[])}(n,e))):[]}function tT(t,e){return{documents:[JI(t,e.path)]}}function nT(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=JI(t,i);const s=function(c){if(c.length!==0)return sT(Ue.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(m){return{field:ao(m.field),direction:FM(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Gp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function rT(t){let e=ZI(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){pe(r===1);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const m=iT(f);return m instanceof Ue&&Ng(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(b){return new yh(lo(b.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Zh(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(f){const m=!!f.before,g=f.values||[];return new Xo(g,m)}(n.startAt));let c=null;return n.endAt&&(c=function(f){const m=!f.before,g=f.values||[];return new Xo(g,m)}(n.endAt)),aM(e,i,o,s,a,"F",u,c)}function LM(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function iT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=lo(n.unaryFilter.field);return Pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=lo(n.unaryFilter.field);return Pe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=lo(n.unaryFilter.field);return Pe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=lo(n.unaryFilter.field);return Pe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return he()}}(t):t.fieldFilter!==void 0?function(n){return Pe.create(lo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return he()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ue.create(n.compositeFilter.filters.map(r=>iT(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he()}}(n.compositeFilter.op))}(t):he()}function FM(t){return RM[t]}function jM(t){return PM[t]}function zM(t){return CM[t]}function ao(t){return{fieldPath:t.canonicalString()}}function lo(t){return lt.fromServerFormat(t.fieldPath)}function sT(t){return t instanceof Pe?function(n){if(n.op==="=="){if(v_(n.value))return{unaryFilter:{field:ao(n.field),op:"IS_NAN"}};if(y_(n.value))return{unaryFilter:{field:ao(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(v_(n.value))return{unaryFilter:{field:ao(n.field),op:"IS_NOT_NAN"}};if(y_(n.value))return{unaryFilter:{field:ao(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ao(n.field),op:jM(n.op),value:n.value}}}(t):t instanceof Ue?function(n){const r=n.getFilters().map(i=>sT(i));return r.length===1?r[0]:{compositeFilter:{op:zM(n.op),filters:r}}}(t):he()}function UM(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function oT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n,r,i,s=ve.min(),o=ve.min(),a=bt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Ur(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e){this.ct=e}}function BM(t,e){let n;if(e.document)n=VM(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ie.fromSegments(e.noDocument.path),i=zs(e.noDocument.readTime);n=vt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return he();{const r=ie.fromSegments(e.unknownDocument.path),i=zs(e.unknownDocument.version);n=vt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new ct(i[0],i[1]);return ve.fromTimestamp(s)}(e.readTime)),n}function O_(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Eh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:wh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ta(s,o.version.toTimestamp()),createTime:ta(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:js(e.version)};else{if(!e.isUnknownDocument())return he();r.unknownDocument={path:n.path.toArray(),version:js(e.version)}}return r}function Eh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function js(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function zs(t){const e=new ct(t.seconds,t.nanoseconds);return ve.fromTimestamp(e)}function us(t,e){const n=(e.baseMutations||[]).map(s=>Wp(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Wp(t.ct,s)),i=ct.fromMillis(e.localWriteTimeMs);return new Vg(e.batchId,i,n,r)}function Wa(t){const e=zs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?zs(t.lastLimboFreeSnapshotVersion):ve.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return pe(s.documents.length===1),$n(ou(ZI(s.documents[0])))}(t.query):function(s){return $n(rT(s))}(t.query),new Ur(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,bt.fromBase64String(t.resumeToken))}function lT(t,e){const n=js(e.snapshotVersion),r=js(e.lastLimboFreeSnapshotVersion);let i;i=vh(e.target)?tT(t.ct,e.target):nT(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Fs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function uT(t){const e=rT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qp(e,e.limit,"L"):e}function hf(t,e){return new Og(e.largestBatchId,Wp(t.ct,e.overlayMutation))}function L_(t,e){const n=e.path.lastSegment();return[t,un(e.path.popLast()),n]}function F_(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:js(r.readTime),documentKey:un(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{getBundleMetadata(e,n){return j_(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:zs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return j_(e).put(function(i){return{bundleId:i.id,createTime:js(cn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return z_(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:uT(s.bundledQuery),readTime:zs(s.readTime)}}(r)})}saveNamedQuery(e,n){return z_(e).put(function(i){return{name:i.name,readTime:js(cn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function j_(t){return Nt(t,"bundles")}function z_(t){return Nt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new sd(e,r)}getOverlay(e,n){return Da(e).get(L_(this.userId,n)).next(r=>r?hf(this.serializer,r):null)}getOverlays(e,n){const r=dr();return M.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Og(n,o);i.push(this.ht(e,a))}),M.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(un(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Da(e).j("collectionPathOverlayIndex",a))}),M.waitFor(s)}getOverlaysForCollection(e,n,r){const i=dr(),s=un(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Da(e).U("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=hf(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=dr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Da(e).J({index:"collectionGroupOverlayIndex",range:a},(u,c,h)=>{const f=hf(this.serializer,c);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}ht(e,n){return Da(e).put(function(i,s,o){const[a,u,c]=L_(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:xh(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Da(t){return Nt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{Pt(e){return Nt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?bt.fromUint8Array(r):bt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(rt(e.integerValue));else if("doubleValue"in e){const r=rt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Fl(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Xr(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Fi(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?II(e)?this.dt(n,Number.MAX_SAFE_INTEGER):ed(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):he()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(rt(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),ie.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}cs.vt=new cs;function GM(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function U_(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=GM(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class HM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=U_(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=U_(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class KM{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class WM{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Va{constructor(){this.jt=new HM,this.Ht=new KM(this.jt),this.Jt=new WM(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new hs(this.indexId,this.documentKey,this.arrayValue,r)}}function ai(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=B_(t.arrayValue,e.arrayValue),n!==0?n:(n=B_(t.directionalValue,e.directionalValue),n!==0?n:ie.comparator(t.documentKey,e.documentKey)))}function B_(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e){this.Xt=new $e((n,r)=>lt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(pe(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Op(e);if(n!==void 0&&!this.sn(n))return!1;const r=os(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.on(a,u)||!this._n(this.en[o++],u))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new $e(lt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ic(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ic(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ic(r.field,r.dir==="asc"?0:1)));return new gh(gh.UNKNOWN_ID,this.collectionId,n,Ll.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(t){var e,n;if(pe(t instanceof Pe||t instanceof Ue),t instanceof Pe){if(t instanceof NI){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Pe.create(t.field,"==",s)))||[];return Ue.create(i,"or")}return t}const r=t.filters.map(i=>cT(i));return Ue.create(r,t.op)}function QM(t){if(t.getFilters().length===0)return[];const e=Xp(cT(t));return pe(hT(e)),Qp(e)||Yp(e)?[e]:e.getFilters()}function Qp(t){return t instanceof Pe}function Yp(t){return t instanceof Ue&&Ng(t)}function hT(t){return Qp(t)||Yp(t)||function(n){if(n instanceof Ue&&zp(n)){for(const r of n.getFilters())if(!Qp(r)&&!Yp(r))return!1;return!0}return!1}(t)}function Xp(t){if(pe(t instanceof Pe||t instanceof Ue),t instanceof Pe)return t;if(t.filters.length===1)return Xp(t.filters[0]);const e=t.filters.map(r=>Xp(r));let n=Ue.create(e,t.op);return n=Ih(n),hT(n)?n:(pe(n instanceof Ue),pe(Jo(n)),pe(n.filters.length>1),n.filters.reduce((r,i)=>jg(r,i)))}function jg(t,e){let n;return pe(t instanceof Pe||t instanceof Ue),pe(e instanceof Pe||e instanceof Ue),n=t instanceof Pe?e instanceof Pe?function(i,s){return Ue.create([i,s],"and")}(t,e):q_(t,e):e instanceof Pe?q_(e,t):function(i,s){if(pe(i.filters.length>0&&s.filters.length>0),Jo(i)&&Jo(s))return RI(i,s.getFilters());const o=zp(i)?i:s,a=zp(i)?s:i,u=o.filters.map(c=>jg(c,a));return Ue.create(u,"or")}(t,e),Ih(n)}function q_(t,e){if(Jo(e))return RI(e,t.getFilters());{const n=e.filters.map(r=>jg(t,r));return Ue.create(n,"or")}}function Ih(t){if(pe(t instanceof Pe||t instanceof Ue),t instanceof Pe)return t;const e=t.getFilters();if(e.length===1)return Ih(e[0]);if(bI(t))return t;const n=e.map(i=>Ih(i)),r=[];return n.forEach(i=>{i instanceof Pe?r.push(i):i instanceof Ue&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ue.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.un=new zg}addToCollectionParentIndex(e,n){return this.un.add(n),M.resolve()}getCollectionParents(e,n){return M.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return M.resolve()}deleteFieldIndex(e,n){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,n){return M.resolve()}getDocumentsMatchingTarget(e,n){return M.resolve(null)}getIndexType(e,n){return M.resolve(0)}getFieldIndexes(e,n){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,n){return M.resolve(Dn.min())}getMinOffsetFromCollectionGroup(e,n){return M.resolve(Dn.min())}updateCollectionGroup(e,n,r){return M.resolve()}updateIndexEntries(e,n){return M.resolve()}}class zg{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new $e(ze.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $e(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu=new Uint8Array(0);class XM{constructor(e,n){this.databaseId=n,this.cn=new zg,this.ln=new Hi(r=>Fs(r),(r,i)=>iu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:un(i)};return G_(e).put(s)}return M.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[dI(n),""],!1,!0);return G_(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(hr(o.parent))}return r})}addFieldIndex(e,n){const r=Ma(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=to(e);return s.next(a=>{o.put(F_(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Ma(e),i=to(e),s=eo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Ma(e),r=eo(e),i=to(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return M.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new $_(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=eo(e);let i=!0;const s=new Map;return M.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ke();const a=[];return M.forEach(s,(u,c)=>{Q("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(C=>`${C.fieldPath}:${C.kind}`).join(",")}`}(u)} to execute ${Fs(n)}`);const h=function(T,C){const F=Op(C);if(F===void 0)return null;for(const j of _h(T,F.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(c,u),f=function(T,C){const F=new Map;for(const j of os(C))for(const E of _h(T,j.fieldPath))switch(E.op){case"==":case"in":F.set(j.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return F.set(j.fieldPath.canonicalString(),E.value),Array.from(F.values())}return null}(c,u),m=function(T,C){const F=[];let j=!0;for(const E of os(C)){const w=E.kind===0?I_(T,E.fieldPath,T.startAt):T_(T,E.fieldPath,T.startAt);F.push(w.value),j&&(j=w.inclusive)}return new Xo(F,j)}(c,u),g=function(T,C){const F=[];let j=!0;for(const E of os(C)){const w=E.kind===0?T_(T,E.fieldPath,T.endAt):I_(T,E.fieldPath,T.endAt);F.push(w.value),j&&(j=w.inclusive)}return new Xo(F,j)}(c,u),b=this.In(u,c,m),I=this.In(u,c,g),P=this.Tn(u,c,f),y=this.En(u.indexId,h,b,m.inclusive,I,g.inclusive,P);return M.forEach(y,_=>r.G(_,n.limit).next(T=>{T.forEach(C=>{const F=ie.fromSegments(C.documentKey);o.has(F)||(o=o.add(F),a.push(F))})}))}).next(()=>a)}return M.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=QM(Ue.create(e.filters,"and")).map(r=>Bp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),h=[];for(let f=0;f<u;++f){const m=n?this.dn(n[f/c]):Xu,g=this.An(e,m,r[f%c],i),b=this.Rn(e,m,s[f%c],o),I=a.map(P=>this.An(e,m,P,!0));h.push(...this.createRange(g,b,I))}return h}An(e,n,r,i){const s=new hs(e,ie.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new hs(e,ie.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new $_(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return M.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new $e(lt.comparator),h=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Va;for(const i of os(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);cs.vt.It(s,o)}return r.zt()}dn(e){const n=new Va;return cs.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Va;return cs.vt.It(Ul(this.databaseId,n),r.Yt(function(s){const o=os(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Va);let s=0;for(const o of os(e)){const a=r[s++];for(const u of i)if(this.fn(n,o.fieldPath)&&Bl(a))i=this.gn(i,o,a);else{const c=u.Yt(o.kind);cs.vt.It(a,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new Va;u.seed(a.zt()),cs.vt.It(o,u.Yt(n.kind)),s.push(u)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof Pe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Ma(e),i=to(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return M.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(h,f){const m=f?new Ll(f.sequenceNumber,new Dn(zs(f.readTime),new ie(hr(f.documentKey)),f.largestBatchId)):Ll.empty(),g=h.fields.map(([b,I])=>new Ic(lt.fromServerFormat(b),I));return new gh(h.indexId,h.collectionGroup,g,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Se(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Ma(e),s=to(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>M.forEach(a,u=>s.put(F_(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return M.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?M.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),M.forEach(a,u=>this.wn(e,i,u).next(c=>{const h=this.Sn(s,u);return c.isEqual(h)?M.resolve():this.bn(e,s,u,c,h)}))))})}Dn(e,n,r,i){return eo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return eo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=eo(e);let s=new $e(ai);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new hs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new $e(ai);const i=this.Vn(n,e);if(i==null)return r;const s=Op(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Bl(o))for(const a of o.arrayValue.values||[])r=r.add(new hs(n.indexId,e.key,this.dn(a),i))}else r=r.add(new hs(n.indexId,e.key,Xu,i));return r}bn(e,n,r,i,s){Q("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,c,h,f,m){const g=u.getIterator(),b=c.getIterator();let I=Zs(g),P=Zs(b);for(;I||P;){let y=!1,_=!1;if(I&&P){const T=h(I,P);T<0?_=!0:T>0&&(y=!0)}else I!=null?_=!0:y=!0;y?(f(P),P=Zs(b)):_?(m(I),I=Zs(g)):(I=Zs(g),P=Zs(b))}}(i,s,ai,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),M.waitFor(o)}yn(e){let n=1;return to(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ai(o,a)).filter((o,a,u)=>!a||ai(o,u[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=ai(o,e),u=ai(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&u<0)i.push(o),i.push(o.Zt());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Xu,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Xu,[]];s.push(IDBKeyRange.bound(a,u))}return s}Cn(e,n){return ai(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(H_)}getMinOffset(e,n){return M.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||he())).next(H_)}}function G_(t){return Nt(t,"collectionParents")}function eo(t){return Nt(t,"indexEntries")}function Ma(t){return Nt(t,"indexConfiguration")}function to(t){return Nt(t,"indexState")}function H_(t){pe(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;bg(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Dn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class vn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new vn(e,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dT(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.J({range:o},(h,f,m)=>(a++,m.delete()));s.push(u.next(()=>{pe(a===1)}));const c=[];for(const h of n.mutations){const f=yI(e,h.key.path,n.batchId);s.push(i.delete(f)),c.push(h.key)}return M.waitFor(s).next(()=>c)}function Th(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw he();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.DEFAULT_COLLECTION_PERCENTILE=10,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vn.DEFAULT=new vn(41943040,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vn.DISABLED=new vn(-1,0,0);class od{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){pe(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new od(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return li(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=uo(e),o=li(e);return o.add({}).next(a=>{pe(typeof a=="number");const u=new Vg(a,n,r,i),c=function(g,b,I){const P=I.baseMutations.map(_=>xh(g.ct,_)),y=I.mutations.map(_=>xh(g.ct,_));return{userId:b,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:P,mutations:y}}(this.serializer,this.userId,u),h=[];let f=new $e((m,g)=>Se(m.canonicalString(),g.canonicalString()));for(const m of i){const g=yI(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(c)),h.push(s.put(g,C4))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),M.waitFor(h).next(()=>u)})}lookupMutationBatch(e,n){return li(e).get(n).next(r=>r?(pe(r.userId===this.userId),us(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?M.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return li(e).J({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(pe(a.batchId>=r),s=us(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return li(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return li(e).U("userMutationsIndex",n).next(r=>r.map(i=>us(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Tc(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return uo(e).J({range:i},(o,a,u)=>{const[c,h,f]=o,m=hr(h);if(c===this.userId&&n.path.isEqual(m))return li(e).get(f).next(g=>{if(!g)throw he();pe(g.userId===this.userId),s.push(us(this.serializer,g))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(Se);const i=[];return n.forEach(s=>{const o=Tc(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=uo(e).J({range:a},(c,h,f)=>{const[m,g,b]=c,I=hr(g);m===this.userId&&s.path.isEqual(I)?r=r.add(b):f.done()});i.push(u)}),M.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Tc(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new $e(Se);return uo(e).J({range:o},(u,c,h)=>{const[f,m,g]=u,b=hr(m);f===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(g)):h.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(li(e).get(s).next(o=>{if(o===null)throw he();pe(o.userId===this.userId),r.push(us(this.serializer,o))}))}),M.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return dT(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),M.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return M.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return uo(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=hr(s[1]);i.push(u)}else a.done()}).next(()=>{pe(i.length===0)})})}containsKey(e,n){return fT(e,this.userId,n)}Nn(e){return pT(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function fT(t,e,n){const r=Tc(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return uo(t).J({range:s,H:!0},(a,u,c)=>{const[h,f,m]=a;h===e&&f===i&&(o=!0),c.done()}).next(()=>o)}function li(t){return Nt(t,"mutations")}function uo(t){return Nt(t,"documentMutations")}function pT(t){return Nt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Us(0)}static kn(){return new Us(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Us(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>ve.fromTimestamp(new ct(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>no(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(pe(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return no(e).J((o,a)=>{const u=Wa(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>M.waitFor(s)).next(()=>i)}forEachTarget(e,n){return no(e).J((r,i)=>{const s=Wa(i);n(s)})}qn(e){return W_(e).get("targetGlobalKey").next(n=>(pe(n!==null),n))}Qn(e,n){return W_(e).put("targetGlobalKey",n)}Kn(e,n){return no(e).put(lT(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Fs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return no(e).J({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const c=Wa(a);iu(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=vi(e);return n.forEach(o=>{const a=un(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),M.waitFor(i)}removeMatchingKeys(e,n,r){const i=vi(e);return M.forEach(n,s=>{const o=un(s.path);return M.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=vi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=vi(e);let s=ke();return i.J({range:r,H:!0},(o,a,u)=>{const c=hr(o[1]),h=new ie(c);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=un(n.path),i=IDBKeyRange.bound([r],[dI(r)],!1,!0);let s=0;return vi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return no(e).get(n).next(r=>r?Wa(r):null)}}function no(t){return Nt(t,"targets")}function W_(t){return Nt(t,"targetGlobal")}function vi(t){return Nt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_([t,e],[n,r]){const i=Se(t,n);return i===0?Se(e,r):i}class ZM{constructor(e){this.Un=e,this.buffer=new $e(Q_),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Q_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class eO{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Gi(n)?Q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await qs(n)}await this.Hn(3e5)})}}class tO{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return M.resolve(Un.oe);const r=new ZM(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(K_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),K_):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,u,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),so()<=Re.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${f} documents in `+(c-u)+`ms
Total Duration: ${c-h}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function nO(t,e){return new tO(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,n){this.db=e,this.garbageCollector=nO(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return Ju(e,r)}removeReference(e,n,r){return Ju(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Ju(e,n)}nr(e,n){return function(i,s){let o=!1;return pT(i).Y(a=>fT(i,a,s).next(u=>(u&&(o=!0),M.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const u=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ve.min()),vi(e).delete(function(f){return[0,un(f.path)]}(o))))});i.push(u)}}).next(()=>M.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Ju(e,n)}tr(e,n){const r=vi(e);let i,s=Un.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==Un.oe&&n(new ie(hr(i)),s),s=c,i=u):s=Un.oe}).next(()=>{s!==Un.oe&&n(new ie(hr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ju(t,e){return vi(t).put(function(r,i){return{targetId:0,path:un(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.changes=new Hi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?M.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ns(e).put(r)}removeEntry(e,n,r){return ns(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Eh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=vt.newInvalidDocument(n);return ns(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Oa(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:vt.newInvalidDocument(n)};return ns(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Oa(n))},(i,s)=>{r={document:this.ir(n,s),size:Th(s)}}).next(()=>r)}getEntries(e,n){let r=Rn();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=Rn(),i=new st(ie.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,Th(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return M.resolve();let i=new $e(J_);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(Oa(i.first()),Oa(i.last())),o=i.getIterator();let a=o.getNext();return ns(e).J({index:"documentKeyIndex",range:s},(u,c,h)=>{const f=ie.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&J_(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?h.$(Oa(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Eh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ns(e).U(IDBKeyRange.bound(a,u,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let h=Rn();for(const f of c){const m=this.ir(ie.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(au(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=Rn();const o=X_(n,r),a=X_(n,Dn.max());return ns(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,h)=>{const f=this.ir(ie.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new sO(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Y_(e).get("remoteDocumentGlobalKey").next(n=>(pe(!!n),n))}rr(e,n){return Y_(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=BM(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ve.min())))return r}return vt.newInvalidDocument(e)}}function gT(t){return new iO(t)}class sO extends mT{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new Hi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new $e((s,o)=>Se(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=O_(this.cr.serializer,o);i=i.add(s.path.popLast());const c=Th(u);r+=c-a.size,n.push(this.cr.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=O_(this.cr.serializer,o.convertToNoDocument(ve.min()));n.push(this.cr.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),M.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Y_(t){return Nt(t,"remoteDocumentGlobal")}function ns(t){return Nt(t,"remoteDocumentsV14")}function Oa(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function X_(t,e){const n=e.documentKey.path.toArray();return[t,Eh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function J_(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Se(n[s],r[s]),i)return i;return i=Se(n.length,r.length),i||(i=Se(n[n.length-2],r[r.length-2]),i||Se(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&hl(r.mutation,i,En.empty(),ct.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const i=dr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ha();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=dr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Rn();const o=cl(),a=function(){return cl()}();return n.forEach((u,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof ei)?s=s.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),hl(h.mutation,c,h.mutation.getFieldMask(),ct.now())):o.set(c.key,En.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var f;return a.set(c,new oO(h,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=cl();let i=new st((o,a)=>o-a),s=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let h=r.get(u)||En.empty();h=a.applyToLocalView(c,h),r.set(u,h);const f=(i.get(a.batchId)||ke()).add(u);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,h=u.value,f=FI();h.forEach(m=>{if(!s.has(m)){const g=qI(n.get(m),r.get(m));g!==null&&f.set(m,g),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):DI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):M.resolve(dr());let a=-1,u=s;return o.next(c=>M.forEach(c,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?M.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ke())).next(h=>({batchId:a,changes:LI(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let i=Ha();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ha();return this.indexManager.getCollectionParents(e,s).next(a=>M.forEach(a,u=>{const c=function(f,m){return new su(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,vt.newInvalidDocument(h)))});let a=Ha();return o.forEach((u,c)=>{const h=s.get(u);h!==void 0&&hl(h.mutation,c,En.empty(),ct.now()),au(n,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return M.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:cn(i.createTime)}}(n)),M.resolve()}getNamedQuery(e,n){return M.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:uT(i.bundledQuery),readTime:cn(i.readTime)}}(n)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this.overlays=new st(ie.comparator),this.Ir=new Map}getOverlay(e,n){return M.resolve(this.overlays.get(n))}getOverlays(e,n){const r=dr();return M.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),M.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),M.resolve()}getOverlaysForCollection(e,n,r){const i=dr(),s=n.length+1,o=new ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return M.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new st((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=dr(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=dr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return M.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Og(n,r));let s=this.Ir.get(n);s===void 0&&(s=ke(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(){this.Tr=new $e(Mt.Er),this.dr=new $e(Mt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Mt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Mt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ie(new ze([])),r=new Mt(n,e),i=new Mt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ie(new ze([])),r=new Mt(n,e),i=new Mt(n,e+1);let s=ke();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Mt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Mt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ie.comparator(e.key,n.key)||Se(e.wr,n.wr)}static Ar(e,n){return Se(e.wr,n.wr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new $e(Mt.Er)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Vg(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new Mt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,n){return M.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return M.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Mt(n,0),i=new Mt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),M.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(Se);return n.forEach(i=>{const s=new Mt(i,0),o=new Mt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),M.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ie.isDocumentKey(s)||(s=s.child(""));const o=new Mt(new ie(s),0);let a=new $e(Se);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.wr)),!0)},o),M.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){pe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return M.forEach(n.mutations,i=>{const s=new Mt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Mt(n,0),i=this.br.firstAfterOrEqual(r);return M.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e){this.Mr=e,this.docs=function(){return new st(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return M.resolve(r?r.document.mutableCopy():vt.newInvalidDocument(n))}getEntries(e,n){let r=Rn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():vt.newInvalidDocument(i))}),M.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Rn();const o=n.path,a=new ie(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:h}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||bg(fI(h),r)<=0||(i.has(h.key)||au(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return M.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he()}Or(e,n){return M.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new dO(this)}getSize(e){return M.resolve(this.size)}}class dO extends mT{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),M.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.persistence=e,this.Nr=new Hi(n=>Fs(n),iu),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ug,this.targetCount=0,this.kr=Us.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),M.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Us(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,M.resolve()}updateTargetData(e,n){return this.Kn(n),M.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),M.waitFor(s).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return M.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),M.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),M.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),M.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return M.resolve(r)}containsKey(e,n){return M.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Un(0),this.Kr=!1,this.Kr=!0,this.$r=new uO,this.referenceDelegate=e(this),this.Ur=new fO(this),this.indexManager=new YM,this.remoteDocumentCache=function(i){return new hO(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new aT(n),this.Gr=new aO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new cO(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const i=new pO(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return M.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class pO extends mI{constructor(e){super(),this.currentSequenceNumber=e}}class ad{constructor(e){this.persistence=e,this.Jr=new Ug,this.Yr=null}static Zr(e){return new ad(e)}get Xr(){if(this.Yr)return this.Yr;throw he()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),M.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),M.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.Xr,r=>{const i=ie.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,ve.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return M.or([()=>M.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Jh("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",d_,{unique:!0}),u.createObjectStore("documentMutations")}(e),Z_(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=M.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),Z_(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ve.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",d_,{unique:!0});const f=c.store("mutations"),m=h.map(g=>f.put(g));return M.waitFor(m)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore("documentOverlays",{keyPath:$4});c.createIndex("collectionPathOverlayIndex",q4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",G4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:N4});c.createIndex("documentKeyIndex",D4),c.createIndex("collectionGroupIndex",V4)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:j4}).createIndex("sequenceNumberIndex",z4,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:U4}).createIndex("documentKeyIndex",B4,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Th(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>M.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>M.forEach(a,u=>{pe(u.userId===s.userId);const c=us(this.serializer,u);return dT(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const u=new ze(o),c=function(f){return[0,un(f)]}(u);s.push(n.get(c).next(h=>h?M.resolve():(f=>n.put({targetId:0,path:un(f),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>M.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:F4});const r=n.store("collectionParents"),i=new zg,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:un(u)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const u=new ze(o);return s(u.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,u],c)=>{const h=hr(a);return s(h.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=Wa(i),o=lT(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),u=function(f){return f.document?new ie(ze.fromString(f.document.name).popFirst(5)):f.noDocument?ie.fromSegments(f.noDocument.path):f.unknownDocument?ie.fromSegments(f.unknownDocument.path):he()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>M.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=gT(this.serializer),s=new vT(ad.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(u=>{var c;let h=(c=a.get(u.userId))!==null&&c!==void 0?c:ke();us(this.serializer,u).keys().forEach(f=>h=h.add(f)),a.set(u.userId,h)}),M.forEach(a,(u,c)=>{const h=new Bt(c),f=sd.lt(this.serializer,h),m=s.getIndexManager(h),g=od.lt(h,this.serializer,m,s.referenceDelegate);return new yT(i,g,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Lp(n,Un.oe),u).next()})})}}function Z_(t){t.createObjectStore("targetDocuments",{keyPath:O4}).createIndex("documentTargetsIndex",L4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",M4,{unique:!0}),t.createObjectStore("targetGlobal")}const df="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Bg{constructor(e,n,r,i,s,o,a,u,c,h,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=h,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!Bg.D())throw new re(G.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rO(this,i),this.Ai=n+"main",this.serializer=new aT(u),this.Ri=new Di(this.Ai,this.hi,new mO(this.serializer)),this.$r=new qM,this.Ur=new JM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=gT(this.serializer),this.Gr=new $M,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&an("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(G.FAILED_PRECONDITION,df);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Un(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Zu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Gi(e))return Q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return La(e).get("owner").next(n=>M.resolve(this.vi(n)))}Ci(e){return Zu(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Nt(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return M.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?M.resolve(!0):La(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new re(G.FAILED_PRECONDITION,df);return!1}}return!(!this.networkEnabled||!this.inForeground)||Zu(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Q("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Lp(e,Un.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Zu(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return od.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new XM(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return sd.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){Q("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===17?W4:u===16?K4:u===15?Rg:u===14?wI:u===13?_I:u===12?H4:u===11?vI:void he()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new Lp(a,this.Qr?this.Qr.next():Un.oe),n==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw an(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new re(G.FAILED_PRECONDITION,pI);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return La(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(G.FAILED_PRECONDITION,df)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return La(e).put("owner",n)}static D(){return Di.D()}bi(e){const n=La(e);return n.get("owner").next(r=>this.vi(r)?(Q("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):M.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(an(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;_E()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return Q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return an("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){an("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function La(t){return Nt(t,"owner")}function Zu(t){return Nt(t,"clientMetadata")}function gO(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ke(),i=ke();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new $g(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return _E()?8:gI(Pt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new yO;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(so()<=Re.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",oo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),M.resolve()):(so()<=Re.DEBUG&&Q("QueryEngine","Query:",oo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(so()<=Re.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",oo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$n(n))):M.resolve())}Yi(e,n){if(S_(n))return M.resolve(null);let r=$n(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=qp(n,null,"F"),r=$n(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ke(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(n,a);return this.ns(n,c,o,u.readTime)?this.Yi(e,qp(n,null,"F")):this.rs(e,c,n,u)}))})))}Zi(e,n,r,i){return S_(n)||i.isEqual(ve.min())?M.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?M.resolve(null):(so()<=Re.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),oo(n)),this.rs(e,o,n,T4(i,-1)).next(a=>a))})}ts(e,n){let r=new $e(MI(e));return n.forEach((i,s)=>{au(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return so()<=Re.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",oo(n)),this.Ji.getDocumentsMatchingQuery(e,n,Dn.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new st(Se),this._s=new Hi(s=>Fs(s),iu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function wT(t,e,n,r){return new vO(t,e,n,r)}async function xT(t,e){const n=Ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=ke();for(const c of i){o.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}for(const c of s){a.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function _O(t,e){const n=Ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,c,h){const f=c.batch,m=f.keys();let g=M.resolve();return m.forEach(b=>{g=g.next(()=>h.getEntry(u,b)).next(I=>{const P=c.docVersions.get(b);pe(P!==null),I.version.compareTo(P)<0&&(f.applyToRemoteDocument(I,c),I.isValidDocument()&&(I.setReadTime(c.commitVersion),h.addEntry(I)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ke();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function ET(t){const e=Ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function wO(t,e){const n=Ie(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;a.push(n.Ur.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(s,h.addedDocuments,f)));let g=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(bt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(f,g),function(I,P,y){return I.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(m,g,h)&&a.push(n.Ur.updateTargetData(s,g))});let u=Rn(),c=ke();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(xO(s,o,e.documentUpdates).next(h=>{u=h.Ps,c=h.Is})),!r.isEqual(ve.min())){const h=n.Ur.getLastRemoteSnapshotVersion(s).next(f=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return M.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.os=i,s))}function xO(t,e,n){let r=ke(),i=ke();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Rn();return n.forEach((a,u)=>{const c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(ve.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):Q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function EO(t,e){const n=Ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function IO(t,e){const n=Ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,M.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new Ur(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Jp(t,e,n){const r=Ie(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Gi(o))throw o;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function ew(t,e,n){const r=Ie(t);let i=ve.min(),s=ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,h){const f=Ie(u),m=f._s.get(h);return m!==void 0?M.resolve(f.os.get(m)):f.Ur.getTargetData(c,h)}(r,o,$n(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:ve.min(),n?s:ke())).next(a=>(TO(r,uM(e),a),{documents:a,Ts:s})))}function TO(t,e,n){let r=t.us.get(e)||ve.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class tw{constructor(){this.activeTargetIds=mM()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class IT{constructor(){this.so=new tw,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new tw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec=null;function ff(){return ec===null?ec=function(){return 268435456+Math.round(2147483648*Math.random())}():ec++,"0x"+ec.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class AO extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=ff(),u=this.xo(n,r.toUriEncodedString());Q("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,u,c,i).then(h=>(Q("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw Ms("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ua}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=kO[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=ff();return new Promise((o,a)=>{const u=new sI;u.setWithCredentials(!0),u.listenOnce(oI.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ec.NO_ERROR:const h=u.getResponseJson();Q(Zt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Ec.TIMEOUT:Q(Zt,`RPC '${e}' ${s} timed out`),a(new re(G.DEADLINE_EXCEEDED,"Request time out"));break;case Ec.HTTP_ERROR:const f=u.getStatus();if(Q(Zt,`RPC '${e}' ${s} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const b=function(P){const y=P.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(y)>=0?y:G.UNKNOWN}(g.status);a(new re(b,g.message))}else a(new re(G.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new re(G.UNAVAILABLE,"Connection failed."));break;default:he()}}finally{Q(Zt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Q(Zt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=ff(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=uI(),a=lI(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=s.join("");Q(Zt,`Creating RPC '${e}' stream ${i}: ${h}`,u);const f=o.createWebChannel(h,u);let m=!1,g=!1;const b=new bO({Io:P=>{g?Q(Zt,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(m||(Q(Zt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),Q(Zt,`RPC '${e}' stream ${i} sending:`,P),f.send(P))},To:()=>f.close()}),I=(P,y,_)=>{P.listen(y,T=>{try{_(T)}catch(C){setTimeout(()=>{throw C},0)}})};return I(f,Ga.EventType.OPEN,()=>{g||(Q(Zt,`RPC '${e}' stream ${i} transport opened.`),b.yo())}),I(f,Ga.EventType.CLOSE,()=>{g||(g=!0,Q(Zt,`RPC '${e}' stream ${i} transport closed`),b.So())}),I(f,Ga.EventType.ERROR,P=>{g||(g=!0,Ms(Zt,`RPC '${e}' stream ${i} transport errored:`,P),b.So(new re(G.UNAVAILABLE,"The operation could not be completed")))}),I(f,Ga.EventType.MESSAGE,P=>{var y;if(!g){const _=P.data[0];pe(!!_);const T=_,C=T.error||((y=T[0])===null||y===void 0?void 0:y.error);if(C){Q(Zt,`RPC '${e}' stream ${i} received error:`,C);const F=C.status;let j=function(k){const A=St[k];if(A!==void 0)return KI(A)}(F),E=C.message;j===void 0&&(j=G.INTERNAL,E="Unknown error status: "+F+" with message "+C.message),g=!0,b.So(new re(j,E)),f.close()}else Q(Zt,`RPC '${e}' stream ${i} received:`,_),b.bo(_)}}),I(a,aI.STAT_EVENT,P=>{P.stat===Mp.PROXY?Q(Zt,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===Mp.NOPROXY&&Q(Zt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RO(){return typeof window<"u"?window:null}function Rc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(t){return new NM(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&Q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,n,r,i,s,o,a,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new TT(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===G.RESOURCE_EXHAUSTED?(an(n.toString()),an("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new re(G.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PO extends ST{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=MM(this.serializer,e),r=function(s){if(!("targetChange"in s))return ve.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?cn(o.readTime):ve.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Kp(this.serializer),n.addTarget=function(s,o){let a;const u=o.target;if(a=vh(u)?{documents:tT(s,u)}:{query:nT(s,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YI(s,o.resumeToken);const c=Gp(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=ta(s,o.snapshotVersion.toTimestamp());const c=Gp(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=LM(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Kp(this.serializer),n.removeTarget=e,this.a_(n)}}class CO extends ST{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return pe(!!e.streamToken),this.lastStreamToken=e.streamToken,pe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){pe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=OM(e.writeResults,e.commitTime),r=cn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Kp(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>xh(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new re(G.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Hp(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(G.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Hp(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(G.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class DO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(an(n),this.D_=!1):Q("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Hs(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=Ie(u);c.L_.add(4),await cu(c),c.q_.set("Unknown"),c.L_.delete(4),await ud(c)}(this))})}),this.q_=new DO(r,i)}}async function ud(t){if(Hs(t))for(const e of t.B_)await e(!0)}async function cu(t){for(const e of t.B_)await e(!1)}function kT(t,e){const n=Ie(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Kg(n)?Hg(n):ha(n).r_()&&Gg(n,e))}function qg(t,e){const n=Ie(t),r=ha(n);n.N_.delete(e),r.r_()&&bT(n,e),n.N_.size===0&&(r.r_()?r.o_():Hs(n)&&n.q_.set("Unknown"))}function Gg(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ha(t).A_(e)}function bT(t,e){t.Q_.xe(e),ha(t).R_(e)}function Hg(t){t.Q_=new AM({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ha(t).start(),t.q_.v_()}function Kg(t){return Hs(t)&&!ha(t).n_()&&t.N_.size>0}function Hs(t){return Ie(t).L_.size===0}function AT(t){t.Q_=void 0}async function MO(t){t.q_.set("Online")}async function OO(t){t.N_.forEach((e,n)=>{Gg(t,e)})}async function LO(t,e){AT(t),Kg(t)?(t.q_.M_(e),Hg(t)):t.q_.set("Unknown")}async function FO(t,e,n){if(t.q_.set("Online"),e instanceof QI&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Sh(t,r)}else if(e instanceof Ac?t.Q_.Ke(e):e instanceof WI?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ve.min()))try{const r=await ET(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const h=s.N_.get(c);h&&s.N_.set(c,h.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{const h=s.N_.get(u);if(!h)return;s.N_.set(u,h.withResumeToken(bt.EMPTY_BYTE_STRING,h.snapshotVersion)),bT(s,u);const f=new Ur(h.target,u,c,h.sequenceNumber);Gg(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await Sh(t,r)}}async function Sh(t,e,n){if(!Gi(e))throw e;t.L_.add(1),await cu(t),t.q_.set("Offline"),n||(n=()=>ET(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await ud(t)})}function RT(t,e){return e().catch(n=>Sh(t,n,e))}async function hu(t){const e=Ie(t),n=zi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;jO(e);)try{const i=await EO(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,zO(e,i)}catch(i){await Sh(e,i)}PT(e)&&CT(e)}function jO(t){return Hs(t)&&t.O_.length<10}function zO(t,e){t.O_.push(e);const n=zi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function PT(t){return Hs(t)&&!zi(t).n_()&&t.O_.length>0}function CT(t){zi(t).start()}async function UO(t){zi(t).p_()}async function BO(t){const e=zi(t);for(const n of t.O_)e.m_(n.mutations)}async function $O(t,e,n){const r=t.O_.shift(),i=Mg.from(r,e,n);await RT(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await hu(t)}async function qO(t,e){e&&zi(t).V_&&await async function(r,i){if(function(o){return SM(o)&&o!==G.ABORTED}(i.code)){const s=r.O_.shift();zi(r).s_(),await RT(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await hu(r)}}(t,e),PT(t)&&CT(t)}async function rw(t,e){const n=Ie(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=Hs(n);n.L_.add(3),await cu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await ud(n)}async function GO(t,e){const n=Ie(t);e?(n.L_.delete(2),await ud(n)):e||(n.L_.add(2),await cu(n),n.q_.set("Unknown"))}function ha(t){return t.K_||(t.K_=function(n,r,i){const s=Ie(n);return s.w_(),new PO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:MO.bind(null,t),Ro:OO.bind(null,t),mo:LO.bind(null,t),d_:FO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Kg(t)?Hg(t):t.q_.set("Unknown")):(await t.K_.stop(),AT(t))})),t.K_}function zi(t){return t.U_||(t.U_=function(n,r,i){const s=Ie(n);return s.w_(),new CO(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:UO.bind(null,t),mo:qO.bind(null,t),f_:BO.bind(null,t),g_:$O.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await hu(t)):(await t.U_.stop(),t.O_.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new $r,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Wg(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qg(t,e){if(an("AsyncQueue",`${e}: ${t}`),Gi(t))return new re(G.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=Ha(),this.sortedSet=new st(this.comparator)}static emptySet(e){return new Mo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(){this.W_=new st(ie.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):he():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class na{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new na(e,n,Mo.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&td(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class KO{constructor(){this.queries=sw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ie(n),s=i.queries;i.queries=sw(),s.forEach((o,a)=>{for(const u of a.j_)u.onError(r)})})(this,new re(G.ABORTED,"Firestore shutting down"))}}function sw(){return new Hi(t=>VI(t),td)}async function NT(t,e){const n=Ie(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new HO,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Qg(o,`Initialization of query '${oo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Yg(n)}async function DT(t,e){const n=Ie(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function WO(t,e){const n=Ie(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Yg(n)}function QO(t,e,n){const r=Ie(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Yg(t){t.Y_.forEach(e=>{e.next()})}var Zp,ow;(ow=Zp||(Zp={})).ea="default",ow.Cache="cache";class VT{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new na(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=na.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Zp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e){this.key=e}}class OT{constructor(e){this.key=e}}class YO{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ke(),this.mutatedKeys=ke(),this.Aa=MI(e),this.Ra=new Mo(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new iw,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),g=au(this.query,f)?f:null,b=!!m&&this.mutatedKeys.has(m.key),I=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let P=!1;m&&g?m.data.isEqual(g.data)?b!==I&&(r.track({type:3,doc:g}),P=!0):this.ga(m,g)||(r.track({type:2,doc:g}),P=!0,(u&&this.Aa(g,u)>0||c&&this.Aa(g,c)<0)&&(a=!0)):!m&&g?(r.track({type:0,doc:g}),P=!0):m&&!g&&(r.track({type:1,doc:m}),P=!0,(u||c)&&(a=!0)),P&&(g?(o=o.add(g),s=I?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,f)=>function(g,b){const I=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he()}};return I(g)-I(b)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new na(this.query,e.Ra,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new iw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ke(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new OT(r))}),this.da.forEach(r=>{e.has(r)||n.push(new MT(r))}),n}ba(e){this.Ta=e.Ts,this.da=ke();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return na.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class XO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class JO{constructor(e){this.key=e,this.va=!1}}class ZO{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Hi(a=>VI(a),td),this.Ma=new Map,this.xa=new Set,this.Oa=new st(ie.comparator),this.Na=new Map,this.La=new Ug,this.Ba={},this.ka=new Map,this.qa=Us.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function e5(t,e,n=!0){const r=BT(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await LT(r,e,n,!0),i}async function t5(t,e){const n=BT(t);await LT(n,e,!0,!1)}async function LT(t,e,n,r){const i=await IO(t.localStore,$n(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await n5(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&kT(t.remoteStore,i),a}async function n5(t,e,n,r,i){t.Ka=(f,m,g)=>async function(I,P,y,_){let T=P.view.ma(y);T.ns&&(T=await ew(I.localStore,P.query,!1).then(({documents:E})=>P.view.ma(E,T)));const C=_&&_.targetChanges.get(P.targetId),F=_&&_.targetMismatches.get(P.targetId)!=null,j=P.view.applyChanges(T,I.isPrimaryClient,C,F);return lw(I,P.targetId,j.wa),j.snapshot}(t,f,m,g);const s=await ew(t.localStore,e,!0),o=new YO(e,s.Ts),a=o.ma(s.documents),u=uu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);lw(t,n,c.wa);const h=new XO(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function r5(t,e,n){const r=Ie(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!td(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Jp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&qg(r.remoteStore,i.targetId),em(r,i.targetId)}).catch(qs)):(em(r,i.targetId),await Jp(r.localStore,i.targetId,!0))}async function i5(t,e){const n=Ie(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),qg(n.remoteStore,r.targetId))}async function s5(t,e,n){const r=$T(t);try{const i=await function(o,a){const u=Ie(o),c=ct.now(),h=a.reduce((g,b)=>g.add(b.key),ke());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",g=>{let b=Rn(),I=ke();return u.cs.getEntries(g,h).next(P=>{b=P,b.forEach((y,_)=>{_.isValidDocument()||(I=I.add(y))})}).next(()=>u.localDocuments.getOverlayedDocuments(g,b)).next(P=>{f=P;const y=[];for(const _ of a){const T=IM(_,f.get(_.key).overlayedDocument);T!=null&&y.push(new ei(_.key,T,SI(T.value.mapValue),qt.exists(!0)))}return u.mutationQueue.addMutationBatch(g,c,y,a)}).next(P=>{m=P;const y=P.applyToLocalDocumentSet(f,I);return u.documentOverlayCache.saveOverlays(g,P.batchId,y)})}).then(()=>({batchId:m.batchId,changes:LI(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new st(Se)),c=c.insert(a,u),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await du(r,i.changes),await hu(r.remoteStore)}catch(i){const s=Qg(i,"Failed to persist write");n.reject(s)}}async function FT(t,e){const n=Ie(t);try{const r=await wO(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?pe(o.va):i.removedDocuments.size>0&&(pe(o.va),o.va=!1))}),await du(n,r,e)}catch(r){await qs(r)}}function aw(t,e,n){const r=Ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=Ie(o);u.onlineState=a;let c=!1;u.queries.forEach((h,f)=>{for(const m of f.j_)m.Z_(a)&&(c=!0)}),c&&Yg(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function o5(t,e,n){const r=Ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new st(ie.comparator);o=o.insert(s,vt.newNoDocument(s,ve.min()));const a=ke().add(s),u=new id(ve.min(),new Map,new st(Se),o,a);await FT(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),Xg(r)}else await Jp(r.localStore,e,!1).then(()=>em(r,e,n)).catch(qs)}async function a5(t,e){const n=Ie(t),r=e.batch.batchId;try{const i=await _O(n.localStore,e);zT(n,r,null),jT(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await du(n,i)}catch(i){await qs(i)}}async function l5(t,e,n){const r=Ie(t);try{const i=await function(o,a){const u=Ie(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return u.mutationQueue.lookupMutationBatch(c,a).next(f=>(pe(f!==null),h=f.keys(),u.mutationQueue.removeMutationBatch(c,f))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>u.localDocuments.getDocuments(c,h))})}(r.localStore,e);zT(r,e,n),jT(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await du(r,i)}catch(i){await qs(i)}}function jT(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function zT(t,e,n){const r=Ie(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function em(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||UT(t,r)})}function UT(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(qg(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Xg(t))}function lw(t,e,n){for(const r of n)r instanceof MT?(t.La.addReference(r.key,e),u5(t,r)):r instanceof OT?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||UT(t,r.key)):he()}function u5(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.xa.add(r),Xg(t))}function Xg(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ie(ze.fromString(e)),r=t.qa.next();t.Na.set(r,new JO(n)),t.Oa=t.Oa.insert(n,r),kT(t.remoteStore,new Ur($n(ou(n.path)),r,"TargetPurposeLimboResolution",Un.oe))}}async function du(t,e,n){const r=Ie(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{o.push(r.Ka(u,e,n).then(c=>{var h;if((c||n)&&r.isPrimaryClient){const f=c?!c.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(c){i.push(c);const f=$g.Wi(u.targetId,c);s.push(f)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(u,c){const h=Ie(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>M.forEach(c,m=>M.forEach(m.$i,g=>h.persistence.referenceDelegate.addReference(f,m.targetId,g)).next(()=>M.forEach(m.Ui,g=>h.persistence.referenceDelegate.removeReference(f,m.targetId,g)))))}catch(f){if(!Gi(f))throw f;Q("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const g=h.os.get(m),b=g.snapshotVersion,I=g.withLastLimboFreeSnapshotVersion(b);h.os=h.os.insert(m,I)}}}(r.localStore,s))}async function c5(t,e){const n=Ie(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await xT(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(u=>{u.reject(new re(G.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await du(n,r.hs)}}function h5(t,e){const n=Ie(t),r=n.Na.get(e);if(r&&r.va)return ke().add(r.key);{let i=ke();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function BT(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=FT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=h5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=o5.bind(null,e),e.Ca.d_=WO.bind(null,e.eventManager),e.Ca.$a=QO.bind(null,e.eventManager),e}function $T(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=a5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=l5.bind(null,e),e}class Gl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ld(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return wT(this.persistence,new _T,e.initialUser,this.serializer)}Ga(e){return new vT(ad.Zr,this.serializer)}Wa(e){return new IT}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gl.provider={build:()=>new Gl};class d5 extends Gl{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await $T(this.Ja.syncEngine),await hu(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return wT(this.persistence,new _T,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new eO(r,e.asyncQueue,n)}Ha(e,n){const r=new A4(n,this.persistence);return new b4(e.asyncQueue,r)}Ga(e){const n=gO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?vn.withCacheSize(this.cacheSizeBytes):vn.DEFAULT;return new Bg(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,RO(),Rc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new IT}}class kh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>aw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=c5.bind(null,this.syncEngine),await GO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new KO}()}createDatastore(e){const n=ld(e.databaseInfo.databaseId),r=function(s){return new AO(s)}(e.databaseInfo);return function(s,o,a,u){return new NO(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new VO(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>aw(this.syncEngine,n,0),function(){return nw.D()?new nw:new SO}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,h){const f=new ZO(i,s,o,a,u,c);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ie(i);Q("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await cu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}kh.provider={build:()=>new kh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):an("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Bt.UNAUTHENTICATED,this.clientId=hI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Q("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Q("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $r;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Qg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function pf(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await xT(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function uw(t,e){t.asyncQueue.verifyOperationInProgress();const n=await p5(t);Q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>rw(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>rw(e.remoteStore,i)),t._onlineComponents=e}async function p5(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await pf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===G.FAILED_PRECONDITION||i.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ms("Error using user provided cache. Falling back to memory cache: "+n),await pf(t,new Gl)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await pf(t,new Gl);return t._offlineComponents}async function GT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await uw(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await uw(t,new kh))),t._onlineComponents}function m5(t){return GT(t).then(e=>e.syncEngine)}async function tm(t){const e=await GT(t),n=e.eventManager;return n.onListen=e5.bind(null,e.syncEngine),n.onUnlisten=r5.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=t5.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=i5.bind(null,e.syncEngine),n}function g5(t,e,n={}){const r=new $r;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,u,c){const h=new qT({next:m=>{h.Za(),o.enqueueAndForget(()=>DT(s,f));const g=m.docs.has(a);!g&&m.fromCache?c.reject(new re(G.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&m.fromCache&&u&&u.source==="server"?c.reject(new re(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new VT(ou(a.path),h,{includeMetadataChanges:!0,_a:!0});return NT(s,f)}(await tm(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KT(t,e,n){if(!n)throw new re(G.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function y5(t,e,n,r){if(e===!0&&r===!0)throw new re(G.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function hw(t){if(!ie.isDocumentKey(t))throw new re(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dw(t){if(ie.isDocumentKey(t))throw new re(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function cd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he()}function ir(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cd(t);throw new re(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new re(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}y5("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new re(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new re(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new re(G.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fw(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new m4;switch(r.type){case"firstParty":return new _4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=cw.get(n);r&&(Q("ComponentProvider","Removing Datastore"),cw.delete(n),r.terminate())}(this),Promise.resolve()}}function v5(t,e,n,r={}){var i;const s=(t=ir(t,hd))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ms("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=Bt.MOCK_USER;else{a=GC(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new re(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Bt(c)}t._authCredentials=new g4(new cI(a,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new da(this.firestore,e,this._query)}}class hn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}}class Vi extends da{constructor(e,n,r){super(e,n,ou(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new ie(e))}withConverter(e){return new Vi(this.firestore,e,this._path)}}function pw(t,e,...n){if(t=Ct(t),KT("collection","path",e),t instanceof hd){const r=ze.fromString(e,...n);return dw(r),new Vi(t,null,r)}{if(!(t instanceof hn||t instanceof Vi))throw new re(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return dw(r),new Vi(t.firestore,null,r)}}function yn(t,e,...n){if(t=Ct(t),arguments.length===1&&(e=hI.newId()),KT("doc","path",e),t instanceof hd){const r=ze.fromString(e,...n);return hw(r),new hn(t,null,new ie(r))}{if(!(t instanceof hn||t instanceof Vi))throw new re(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return hw(r),new hn(t.firestore,t instanceof Vi?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new TT(this,"async_queue_retry"),this.Vu=()=>{const r=Rc();r&&Q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Rc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Rc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new $r;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Gi(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw an("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Wg.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&he()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function gw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Ui extends hd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new mw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mw(e),this._firestoreClient=void 0,await e}}}function _5(t,e){const n=typeof t=="object"?t:TE(),r=typeof t=="string"?t:"(default)",i=pg(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=$C("firestore");s&&v5(i,...s)}return i}function dd(t){if(t._terminated)throw new re(G.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||WT(t),t._firestoreClient}function WT(t){var e,n,r;const i=t._freezeSettings(),s=function(a,u,c,h){return new Y4(a,u,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,HT(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new f5(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const u=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(u),_online:u}}(t._componentsProvider))}function w5(t,e){Ms("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return x5(t,kh.provider,{build:r=>new d5(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function x5(t,e,n){if((t=ir(t,Ui))._firestoreClient||t._terminated)throw new re(G.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(G.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},WT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ra(bt.fromBase64String(e))}catch(n){throw new re(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ra(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Se(this._lat,e._lat)||Se(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=/^__.*__$/;class I5{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ei(e,this.data,this.fieldMask,n,this.fieldTransforms):new ca(e,this.data,n,this.fieldTransforms)}}class QT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ei(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function YT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he()}}class t0{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new t0(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return bh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(YT(this.Cu)&&E5.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class T5{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ld(e)}Qu(e,n,r,i=!1){return new t0({Cu:e,methodName:n,qu:r,path:lt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function n0(t){const e=t._freezeSettings(),n=ld(t._databaseId);return new T5(t._databaseId,!!e.ignoreUndefinedProperties,n)}function XT(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);r0("Data must be an object, but it was:",o,r);const a=JT(r,o);let u,c;if(s.merge)u=new En(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=nm(e,f,n);if(!o.contains(m))throw new re(G.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);eS(h,m)||h.push(m)}u=new En(h),c=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,c=o.fieldTransforms;return new I5(new tn(a),u,c)}class pd extends Jg{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pd}}function S5(t,e,n,r){const i=t.Qu(1,e,n);r0("Data must be an object, but it was:",i,r);const s=[],o=tn.empty();Gs(r,(u,c)=>{const h=i0(e,u,n);c=Ct(c);const f=i.Nu(h);if(c instanceof pd)s.push(h);else{const m=fu(c,f);m!=null&&(s.push(h),o.set(h,m))}});const a=new En(s);return new QT(o,a,i.fieldTransforms)}function k5(t,e,n,r,i,s){const o=t.Qu(1,e,n),a=[nm(e,r,n)],u=[i];if(s.length%2!=0)throw new re(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(nm(e,s[m])),u.push(s[m+1]);const c=[],h=tn.empty();for(let m=a.length-1;m>=0;--m)if(!eS(c,a[m])){const g=a[m];let b=u[m];b=Ct(b);const I=o.Nu(g);if(b instanceof pd)c.push(g);else{const P=fu(b,I);P!=null&&(c.push(g),h.set(g,P))}}const f=new En(c);return new QT(h,f,o.fieldTransforms)}function b5(t,e,n,r=!1){return fu(n,t.Qu(r?4:3,e))}function fu(t,e){if(ZT(t=Ct(t)))return r0("Unsupported field value:",e,t),JT(t,e);if(t instanceof Jg)return function(r,i){if(!YT(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=fu(a,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Ct(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ct.fromDate(r);return{timestampValue:ta(i.serializer,s)}}if(r instanceof ct){const s=new ct(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ta(i.serializer,s)}}if(r instanceof Zg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ra)return{bytesValue:YI(i.serializer,r._byteString)};if(r instanceof hn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof e0)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return Dg(a.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${cd(r)}`)}(t,e)}function JT(t,e){const n={};return xI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gs(t,(r,i)=>{const s=fu(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function ZT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ct||t instanceof Zg||t instanceof ra||t instanceof hn||t instanceof Jg||t instanceof e0)}function r0(t,e,n){if(!ZT(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=cd(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function nm(t,e,n){if((e=Ct(e))instanceof fd)return e._internalPath;if(typeof e=="string")return i0(t,e);throw bh("Field path arguments must be of type string or ",t,!1,void 0,n)}const A5=new RegExp("[~\\*/\\[\\]]");function i0(t,e,n){if(e.search(A5)>=0)throw bh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fd(...e.split("."))._internalPath}catch{throw bh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function bh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new re(G.INVALID_ARGUMENT,a+t+u)}function eS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new R5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(nS("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class R5 extends tS{data(){return super.data()}}function nS(t,e){return typeof e=="string"?i0(t,e):e instanceof fd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class s0{}class C5 extends s0{}function yw(t,e,...n){let r=[];e instanceof s0&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof a0).length,a=s.filter(u=>u instanceof o0).length;if(o>1||o>0&&a>0)throw new re(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class o0 extends C5{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new o0(e,n,r)}_apply(e){const n=this._parse(e);return rS(e._query,n),new da(e.firestore,e.converter,$p(e._query,n))}_parse(e){const n=n0(e.firestore);return function(s,o,a,u,c,h,f){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new re(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){_w(f,h);const g=[];for(const b of f)g.push(vw(u,s,b));m={arrayValue:{values:g}}}else m=vw(u,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||_w(f,h),m=b5(a,o,f,h==="in"||h==="not-in");return Pe.create(c,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class a0 extends s0{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new a0(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ue.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)rS(o,u),o=$p(o,u)}(e._query,n),new da(e.firestore,e.converter,$p(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function vw(t,e,n){if(typeof(n=Ct(n))=="string"){if(n==="")throw new re(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!DI(e)&&n.indexOf("/")!==-1)throw new re(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!ie.isDocumentKey(r))throw new re(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ul(t,new ie(r))}if(n instanceof hn)return Ul(t,n._key);throw new re(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cd(n)}.`)}function _w(t,e){if(!Array.isArray(t)||t.length===0)throw new re(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rS(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class N5{convertValue(e,n="none"){switch(Ls(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Gs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>rt(o.doubleValue));return new e0(s)}convertGeoPoint(e){return new Zg(rt(e.latitude),rt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Cg(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jl(e));default:return null}}convertTimestamp(e){const n=Xr(e);return new ct(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);pe(oT(r));const i=new Os(r.get(1),r.get(3)),s=new ie(r.popFirst(5));return i.isEqual(n)||an(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class sS extends tS{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Pc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(nS("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Pc extends sS{data(e={}){return super.data(e)}}class D5{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Qa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Pc(this._firestore,this._userDataWriter,r.key,r,new Qa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const u=new Pc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const u=new Pc(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:V5(a.type),doc:u,oldIndex:c,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function V5(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(t){t=ir(t,hn);const e=ir(t.firestore,Ui);return g5(dd(e),t._key).then(n=>aS(e,t,n))}class oS extends N5{constructor(e){super(),this.firestore=e}convertBytes(e){return new ra(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,n)}}function mf(t,e,n){t=ir(t,hn);const r=ir(t.firestore,Ui),i=iS(t.converter,e,n);return l0(r,[XT(n0(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,qt.none())])}function O5(t){return l0(ir(t.firestore,Ui),[new lu(t._key,qt.none())])}function gf(t,...e){var n,r,i;t=Ct(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||gw(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(gw(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let u,c,h;if(t instanceof hn)c=ir(t.firestore,Ui),h=ou(t._key.path),u={next:f=>{e[o]&&e[o](aS(c,t,f))},error:e[o+1],complete:e[o+2]};else{const f=ir(t,da);c=ir(f.firestore,Ui),h=f._query;const m=new oS(c);u={next:g=>{e[o]&&e[o](new D5(c,m,f,g))},error:e[o+1],complete:e[o+2]},P5(t._query)}return function(m,g,b,I){const P=new qT(I),y=new VT(g,P,b);return m.asyncQueue.enqueueAndForget(async()=>NT(await tm(m),y)),()=>{P.Za(),m.asyncQueue.enqueueAndForget(async()=>DT(await tm(m),y))}}(dd(c),h,a,u)}function l0(t,e){return function(r,i){const s=new $r;return r.asyncQueue.enqueueAndForget(async()=>s5(await m5(r),i,s)),s.promise}(dd(t),e)}function aS(t,e,n){const r=n.docs.get(e._key),i=new oS(t);return new sS(t,i,e._key,r,new Qa(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=n0(e)}set(e,n,r){this._verifyNotCommitted();const i=yf(e,this._firestore),s=iS(i.converter,n,r),o=XT(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,qt.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=yf(e,this._firestore);let o;return o=typeof(n=Ct(n))=="string"||n instanceof fd?k5(this._dataReader,"WriteBatch.update",s._key,n,r,i):S5(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,qt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=yf(e,this._firestore);return this._mutations=this._mutations.concat(new lu(n._key,qt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new re(G.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function yf(t,e){if((t=Ct(t)).firestore!==e)throw new re(G.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t){return dd(t=ir(t,Ui)),new L5(t,e=>l0(t,e))}(function(e,n=!0){(function(i){ua=i})(aa),Ko(new Ns("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Ui(new y4(r.getProvider("auth-internal")),new x4(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Os(c.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ni(u_,"4.7.3",e),Ni(u_,"4.7.3","esm2017")})();const ww={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},ro=t=>{try{if(typeof import.meta<"u"&&ww)return ww[t]}catch{}},_f={apiKey:ro("VITE_FIREBASE_API_KEY"),authDomain:ro("VITE_FIREBASE_AUTH_DOMAIN"),projectId:ro("VITE_FIREBASE_PROJECT_ID"),storageBucket:ro("VITE_FIREBASE_STORAGE_BUCKET"),messagingSenderId:ro("VITE_FIREBASE_MESSAGING_SENDER_ID"),appId:ro("VITE_FIREBASE_APP_ID")};let wf=null,as=null,je=null,rm=null,im=!1;try{_f.apiKey&&_f.projectId?(wf=IE(_f),as=f4(wf),je=_5(wf),rm=new Dr,typeof window<"u"&&w5(je).catch(e=>{e.code==="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):e.code==="unimplemented"&&console.warn("The current browser does not support all of the features required to enable persistence")}),im=!0):console.log("Firebase config missing. App running in Offline Mode (Local Storage only).")}catch(t){console.warn("Firebase initialization failed:",t),im=!1}const F5=()=>im,xf={signInWithGoogle:async()=>{if(!as||!rm)return console.warn("Cannot sign in: Firebase not initialized"),null;try{return(await EV(as,rm)).user}catch(t){throw console.error("Error signing in with Google",t),t}},signOut:()=>as?nV(as):Promise.resolve(),onAuthStateChanged:t=>as?tV(as,t):()=>{}},Yn={syncTasks:(t,e)=>{if(!je)return()=>{};const n=yw(pw(je,"users",t,"tasks"));return gf(n,r=>{const i=[];r.forEach(s=>i.push(s.data())),e(i)},r=>console.error("Error syncing tasks:",r))},saveTask:async(t,e)=>{je&&await mf(yn(je,"users",t,"tasks",e.id),e)},saveTasksBatch:async(t,e)=>{if(!je)return;const n=vf(je);e.forEach(r=>{const i=yn(je,"users",t,"tasks",r.id);n.set(i,r)}),await n.commit()},deleteTask:async(t,e)=>{je&&await O5(yn(je,"users",t,"tasks",e))},syncBoards:(t,e)=>{if(!je)return()=>{};const n=yw(pw(je,"users",t,"boards"));return gf(n,r=>{const i=[];r.forEach(s=>i.push(s.data())),i.length>0&&e(i)},r=>console.error("Error syncing boards:",r))},saveBoard:async(t,e)=>{je&&await mf(yn(je,"users",t,"boards",e.id),e)},deleteBoard:async(t,e,n)=>{if(!je)return;const r=vf(je);r.delete(yn(je,"users",t,"boards",e)),n.forEach(i=>{r.delete(yn(je,"users",t,"tasks",i))}),await r.commit()},syncPreferences:(t,e)=>je?gf(yn(je,"users",t,"settings","preferences"),n=>{n.exists()&&e(n.data())}):()=>{},savePreference:async(t,e,n)=>{je&&await mf(yn(je,"users",t,"settings","preferences"),{[e]:n},{merge:!0})},migrateAllLocalData:async(t,e,n,r)=>{if(!je)return;const i=yn(je,"users",t),s=await M5(i);if(s.exists()&&s.data().migrated)return;console.log("Migrating local data to cloud...");const o=vf(je);if(e.forEach(a=>{const u=yn(je,"users",t,"tasks",a.id);o.set(u,a)}),n.length===0){const a={id:"1",name:"Main To-Do"},u={id:"2",name:"Ideas"};o.set(yn(je,"users",t,"boards","1"),a),o.set(yn(je,"users",t,"boards","2"),u)}else n.forEach(a=>{const u=yn(je,"users",t,"boards",a.id);o.set(u,a)});o.set(yn(je,"users",t,"settings","preferences"),{theme:r,migrated:!0},{merge:!0}),o.set(i,{migrated:!0},{merge:!0}),await o.commit(),console.log("Migration complete.")}},Ef=({checked:t,iconOn:e,iconOff:n,colorClass:r="from-blue-500 to-blue-600"})=>v.jsxs("div",{className:`w-[4.5rem] h-10 rounded-full relative transition-all duration-500 cubic-bezier(0.34, 1.56, 0.64, 1) ring-inset shrink-0 ${t?`bg-gradient-to-r ${r} ring-0 shadow-[inset_0_2px_8px_rgba(0,0,0,0.25)]`:"bg-slate-300/80 dark:bg-white/5 ring-1 ring-slate-300 dark:ring-white/10 group-hover:ring-slate-400 dark:group-hover:ring-white/30"}`,children:[v.jsx("div",{className:`absolute inset-0 rounded-full bg-gradient-to-b from-white/20 to-transparent pointer-events-none ${t?"opacity-100":"opacity-0"}`}),v.jsx("div",{className:`absolute top-1 w-8 h-8 rounded-full shadow-[0_4px_10px_rgba(0,0,0,0.15)] flex items-center justify-center transition-all duration-500 cubic-bezier(0.34, 1.56, 0.64, 1) z-10 bg-white dark:bg-white ${t?"left-[calc(100%-2.25rem)] text-slate-800 transform rotate-0":"left-1 text-slate-400 dark:text-slate-500 transform -rotate-12"}`,children:v.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[v.jsx("div",{className:`absolute transition-all duration-300 ${t?"opacity-100 scale-100":"opacity-0 scale-50 rotate-45"}`,children:e}),v.jsx("div",{className:`absolute transition-all duration-300 ${t?"opacity-0 scale-50 -rotate-45":"opacity-100 scale-100"}`,children:n})]})})]}),j5=({isOpen:t,setIsOpen:e,boards:n,currentBoardId:r,onSelectBoard:i,onCreateBoard:s,onDeleteBoard:o,isHidden:a=!1,theme:u,onToggleTheme:c,user:h,onSignIn:f,onSignOut:m})=>{const[g,b]=L.useState(!1),[I,P]=L.useState(""),[y,_]=L.useState(!1),[T,C]=L.useState(()=>{try{return localStorage.getItem("soundEnabled")!=="false"}catch{return!0}}),[F,j]=L.useState(()=>{try{return localStorage.getItem("notificationsEnabled")==="true"}catch{return!1}}),[E,w]=L.useState(!1),[k,A]=L.useState(null),[R,N]=L.useState(null);L.useEffect(()=>{w(F5())},[]),L.useEffect(()=>{localStorage.setItem("soundEnabled",String(T)),Nr.setMuted(!T)},[T]),L.useEffect(()=>{localStorage.setItem("notificationsEnabled",String(F)),Ho.setEnabled(F)},[F]),L.useEffect(()=>{const X=se=>{se.preventDefault(),N(se)};return window.addEventListener("beforeinstallprompt",X),()=>window.removeEventListener("beforeinstallprompt",X)},[]);const S=async()=>{if(!R)return;R.prompt();const{outcome:X}=await R.userChoice;X==="accepted"&&N(null)},O=X=>{X.preventDefault(),I.trim()&&(s(I),P(""),_(!1))},Z=async()=>{const X=!F;if(X&&!await Ho.requestPermission()){j(!1),Notification.permission==="denied"&&alert("Notifications are blocked. Please enable them in your browser settings.");return}j(X)},H=()=>{if(window.confirm("Are you sure you want to delete all data? This cannot be undone."))try{localStorage.clear(),window.location.reload()}catch{alert("Failed to delete data.")}},ee=()=>{try{const X=localStorage.getItem("tasks")||"[]",se=localStorage.getItem("boards")||"[]",ye={tasks:JSON.parse(X),boards:JSON.parse(se),exportedAt:new Date().toISOString(),version:"1.6.1"},$="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(ye,null,2)),ne=document.createElement("a");ne.setAttribute("href",$),ne.setAttribute("download","task_bubbles_backup.json"),document.body.appendChild(ne),ne.click(),ne.remove()}catch{alert("Failed to export data.")}},B=()=>{window.confirm("Are you sure you want to sign out?")&&(m==null||m())},K=(X,se,ye)=>{if(X.stopPropagation(),X.preventDefault(),n.length<=1){alert("You must have at least one board.");return}A({id:se,name:ye})},W=()=>{k&&o&&(o(k.id),r===k.id&&i("ALL"),A(null))};return v.jsxs(v.Fragment,{children:[v.jsx("button",{id:"sidebar-toggle",onClick:()=>e(!0),"aria-label":"Open sidebar","aria-expanded":t,className:`absolute top-6 left-6 ${ah} z-30 group ${a?"opacity-0 pointer-events-none":"opacity-100 pointer-events-auto"}`,children:v.jsx(kC,{size:22})}),v.jsx("div",{className:`fixed inset-0 bg-slate-900/20 dark:bg-black/40 backdrop-blur-[2px] z-40 transition-opacity duration-300 ${t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>e(!1)}),v.jsxs("div",{"aria-hidden":!t,className:`fixed top-0 left-0 h-full w-80 shadow-2xl z-50 transform transition-transform duration-500 cubic-bezier(0.2, 0.8, 0.2, 1) ${xs} border-l-0 border-y-0 ${t?"translate-x-0":"-translate-x-full"}`,children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/20 to-transparent dark:from-white/5 dark:to-transparent pointer-events-none"}),v.jsxs("div",{className:"relative p-6 flex flex-col h-full text-slate-800 dark:text-slate-200",children:[v.jsx("div",{className:"mb-6 px-1 flex items-center gap-3",children:v.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white tracking-tight drop-shadow-sm",children:"Task Bubbles"})}),E&&(h?v.jsxs("div",{className:"mb-6 mx-1 p-3 rounded-2xl bg-gradient-to-br from-white/40 to-white/10 dark:from-white/10 dark:to-white/5 border border-white/40 dark:border-white/10 shadow-sm backdrop-blur-md flex items-center gap-3 group transition-all duration-300 hover:bg-white/50 dark:hover:bg-white/10 hover:scale-[1.02]",children:[v.jsxs("div",{className:"relative shrink-0",children:[h.avatarUrl?v.jsx("img",{src:h.avatarUrl,alt:"User",className:"w-10 h-10 rounded-full object-cover border-2 border-white/50 dark:border-white/10 shadow-sm"}):v.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500 flex items-center justify-center text-white font-bold border-2 border-white/50 dark:border-white/10 shadow-sm",children:h.name.charAt(0).toUpperCase()}),v.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-emerald-500 border-2 border-white dark:border-slate-800 rounded-full"})]}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h3",{className:"text-sm font-bold text-slate-800 dark:text-white leading-tight truncate",children:h.name}),v.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/40 font-medium truncate",children:h.email})]}),v.jsx("button",{onClick:B,className:"p-2 rounded-xl text-slate-400 dark:text-white/30 hover:bg-red-50 dark:hover:bg-red-500/10 hover:text-red-500 dark:hover:text-red-400 transition-colors duration-200 group/logout",title:"Sign Out",children:v.jsx(TC,{size:16,className:"transition-transform duration-200 group-hover/logout:translate-x-0.5"})})]}):v.jsxs("div",{className:"mb-6 mx-1 p-4 rounded-2xl bg-white/40 dark:bg-white/5 border border-white/40 dark:border-white/10 shadow-sm backdrop-blur-md flex flex-col gap-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-500",children:v.jsx(vC,{size:20})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-bold text-slate-800 dark:text-white",children:"Sync Tasks"}),v.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/40",children:"Backup to the cloud"})]})]}),v.jsxs("button",{onClick:f,className:"w-full py-2 bg-white dark:bg-slate-800 text-slate-800 dark:text-white text-xs font-bold rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 flex items-center justify-center gap-2 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:[v.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",children:v.jsxs("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[v.jsx("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),v.jsx("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),v.jsx("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.734 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),v.jsx("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.799 L -6.734 42.379 C -8.804 40.439 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Sign in with Google"]})]})),v.jsxs("nav",{className:"space-y-1.5 flex-1 overflow-y-auto no-scrollbar",children:[v.jsxs("button",{onClick:()=>{i("ALL"),e(!1)},className:`${Pr} ${r==="ALL"?Es:Cr}`,children:[v.jsx(xC,{size:18}),v.jsx("span",{className:"font-medium text-sm",children:"All Tasks"})]}),v.jsx("div",{className:"pt-6 pb-2 px-4",children:v.jsx("span",{className:"text-[10px] font-bold text-slate-400 dark:text-white/30 uppercase tracking-widest",children:"Task Boards"})}),n.map(X=>v.jsxs("div",{className:"group relative flex items-center",children:[v.jsxs("button",{onClick:()=>{i(X.id),e(!1)},className:`${Pr} ${r===X.id?Es:Cr} pr-10`,children:[v.jsx(uE,{size:18}),v.jsx("span",{className:"font-medium text-sm truncate",children:X.name})]}),o&&n.length>1&&v.jsx("button",{onClick:se=>K(se,X.id,X.name),className:"absolute right-2 p-2 rounded-lg text-slate-400 hover:text-red-500 hover:bg-red-500/10 dark:hover:bg-red-500/20 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-all z-10",title:"Delete Board",children:v.jsx(sl,{size:14})})]},X.id)),y?v.jsx("form",{onSubmit:O,className:"px-1 py-2",children:v.jsx("input",{autoFocus:!0,type:"text",placeholder:"Board Name",value:I,onChange:X=>P(X.target.value),onBlur:()=>!I&&_(!1),className:"w-full rounded-lg px-4 py-2.5 text-sm focus:outline-none transition-all bg-white/30 dark:bg-white/5 border border-white/40 dark:border-white/10 text-slate-900 dark:text-white placeholder:text-slate-400 dark:placeholder:text-white/20 focus:border-slate-400 dark:focus:border-white/30"})}):v.jsxs("button",{onClick:()=>_(!0),className:`${Pr} ${Cr} mt-2 group`,children:[v.jsx(cE,{size:18,className:"group-hover:rotate-90 transition-transform"}),v.jsx("span",{className:"font-medium text-sm",children:"New Board"})]}),v.jsx("div",{className:"my-3 border-t border-slate-200 dark:border-white/10 mx-2"}),v.jsxs("button",{onClick:()=>{i("COMPLETED"),e(!1)},className:`${Pr} ${r==="COMPLETED"?Es:Cr}`,children:[v.jsx(sl,{size:18}),v.jsx("span",{className:"font-medium text-sm",children:"Completed Tasks"})]}),R&&v.jsx("div",{className:"mt-6 px-1",children:v.jsxs("button",{onClick:S,className:"w-full p-3 rounded-2xl bg-indigo-600/90 hover:bg-indigo-500 text-white shadow-lg shadow-indigo-500/30 flex items-center justify-center gap-3 transition-all active:scale-95 border border-indigo-400/50",children:[v.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg",children:v.jsx(_C,{size:18})}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"font-bold text-sm leading-none",children:"Install App"}),v.jsx("span",{className:"text-[10px] opacity-80 leading-tight mt-1",children:"Get the full experience"})]})]})})]}),v.jsx("div",{className:"pt-4 border-t border-slate-200 dark:border-white/10 mt-2 space-y-1.5",children:v.jsxs("button",{onClick:()=>{b(!0),e(!1)},className:`${Pr} ${Cr}`,children:[v.jsx(AC,{size:18}),v.jsx("span",{className:"font-medium text-sm",children:"Settings"})]})})]})]}),g&&v.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[v.jsx("div",{className:"absolute inset-0 bg-slate-900/20 dark:bg-black/40 backdrop-blur-sm transition-opacity",onClick:()=>b(!1)}),v.jsxs("div",{className:`relative w-full max-w-sm rounded-3xl transform transition-all animate-in fade-in zoom-in-95 duration-200 ${xs}`,children:[v.jsxs("div",{className:"p-5 border-b border-slate-200 dark:border-white/10 flex items-center justify-center relative",children:[v.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white tracking-tight",children:"Settings"}),v.jsx("button",{onClick:()=>b(!1),className:"absolute right-4 p-2 rounded-full transition-colors text-slate-400 dark:text-white/40 hover:text-slate-900 dark:hover:text-white hover:bg-white/30 dark:hover:bg-white/10",children:v.jsx(dE,{size:18})})]}),v.jsxs("div",{className:"p-6 space-y-4",children:[v.jsxs("button",{onClick:c,className:"w-full flex items-center justify-between p-3 rounded-2xl border transition-all duration-200 outline-none group bg-white/40 dark:bg-white/5 border-white/40 dark:border-white/5 hover:bg-white/60 dark:hover:bg-white/10 hover:border-white/60 dark:hover:border-white/20 active:scale-[0.98]",children:[v.jsxs("div",{className:"flex items-center gap-3 text-slate-700 dark:text-white/80",children:[v.jsx("div",{className:"p-2 rounded-xl text-slate-500 dark:text-white/70 bg-white/50 dark:bg-white/10 group-hover:scale-110 transition-transform duration-300",children:u==="dark"?v.jsx(Sv,{size:18}):v.jsx(bv,{size:18})}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"font-bold text-sm",children:"Dark Mode"}),v.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40 font-medium",children:"Adjust appearance"})]})]}),v.jsx(Ef,{checked:u==="dark",iconOn:v.jsx(Sv,{size:14,className:"text-indigo-600"}),iconOff:v.jsx(bv,{size:14,className:"text-amber-500"}),colorClass:"from-indigo-500 to-violet-600"})]}),v.jsxs("button",{onClick:()=>C(!T),className:"w-full flex items-center justify-between p-3 rounded-2xl border transition-all duration-200 outline-none group bg-white/40 dark:bg-white/5 border-white/40 dark:border-white/5 hover:bg-white/60 dark:hover:bg-white/10 hover:border-white/60 dark:hover:border-white/20 active:scale-[0.98]",children:[v.jsxs("div",{className:"flex items-center gap-3 text-slate-700 dark:text-white/80",children:[v.jsx("div",{className:"p-2 rounded-xl text-slate-500 dark:text-white/70 bg-white/50 dark:bg-white/10 group-hover:scale-110 transition-transform duration-300",children:T?v.jsx(Rv,{size:18}):v.jsx(Pv,{size:18})}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"font-bold text-sm",children:"Sound Effects"}),v.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40 font-medium",children:"Bubbles go pop"})]})]}),v.jsx(Ef,{checked:T,iconOn:v.jsx(Rv,{size:14,className:"text-blue-600"}),iconOff:v.jsx(Pv,{size:14,className:"text-slate-400"}),colorClass:"from-blue-400 to-blue-600"})]}),v.jsxs("button",{onClick:Z,className:"w-full flex items-center justify-between p-3 rounded-2xl border transition-all duration-200 outline-none group bg-white/40 dark:bg-white/5 border-white/40 dark:border-white/5 hover:bg-white/60 dark:hover:bg-white/10 hover:border-white/60 dark:hover:border-white/20 active:scale-[0.98]",children:[v.jsxs("div",{className:"flex items-center gap-3 text-slate-700 dark:text-white/80",children:[v.jsx("div",{className:"p-2 rounded-xl text-slate-500 dark:text-white/70 bg-white/50 dark:bg-white/10 group-hover:scale-110 transition-transform duration-300",children:F?v.jsx(Iv,{size:18}):v.jsx(Ev,{size:18})}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"font-bold text-sm",children:"Notifications"}),v.jsx("span",{className:"text-[10px] text-slate-400 dark:text-white/40 font-medium",children:"Task reminders"})]})]}),v.jsx(Ef,{checked:F,iconOn:v.jsx(Iv,{size:14,className:"text-emerald-600"}),iconOff:v.jsx(Ev,{size:14,className:"text-slate-400"}),colorClass:"from-emerald-400 to-emerald-600"})]}),v.jsxs("button",{onClick:ee,className:"w-full flex items-center gap-3 p-3 rounded-2xl border transition-all duration-200 outline-none bg-indigo-500/10 border-indigo-500/20 hover:bg-indigo-500/20 hover:border-indigo-500/30 active:scale-[0.98] text-indigo-600 dark:text-indigo-400",children:[v.jsx("div",{className:"p-2 rounded-xl bg-indigo-500/20",children:v.jsx(RC,{size:18})}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"font-bold text-sm",children:"Export Data"}),v.jsx("span",{className:"text-[10px] opacity-80 font-medium",children:"Download JSON backup"})]})]}),v.jsxs("button",{onClick:H,className:"w-full flex items-center gap-3 p-3 rounded-2xl border transition-all duration-200 outline-none bg-red-500/10 border-red-500/20 hover:bg-red-500/20 hover:border-red-500/30 active:scale-[0.98] text-red-600 dark:text-red-400",children:[v.jsx("div",{className:"p-2 rounded-xl bg-red-500/20",children:v.jsx(aE,{size:18})}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"font-bold text-sm",children:"Delete All Data"}),v.jsx("span",{className:"text-[10px] opacity-80 font-medium",children:"Clear local storage"})]})]}),v.jsx("div",{className:"pt-4 mt-4 border-t border-slate-200 dark:border-white/10",children:v.jsx("p",{className:"text-center text-[10px] font-bold tracking-widest text-slate-400 dark:text-white/20 uppercase",children:"Task Bubbles v1.6.1"})})]})]})]}),k&&v.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[v.jsx("div",{className:"absolute inset-0 bg-slate-900/20 dark:bg-black/40 backdrop-blur-sm transition-opacity",onClick:()=>A(null)}),v.jsx("div",{className:`relative w-full max-w-sm rounded-3xl transform transition-all animate-in fade-in zoom-in-95 duration-200 ${xs}`,children:v.jsxs("div",{className:"p-6 flex flex-col items-center text-center",children:[v.jsx("div",{className:"w-12 h-12 mb-4 rounded-full bg-red-500/10 dark:bg-red-500/20 flex items-center justify-center text-red-500 border border-red-500/20",children:v.jsx(sl,{size:24})}),v.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"Delete Board?"}),v.jsxs("p",{className:"text-sm text-slate-500 dark:text-white/60 mb-6 leading-relaxed",children:["Are you sure you want to delete ",v.jsxs("span",{className:"font-bold text-slate-800 dark:text-white",children:['"',k.name,'"']}),"?",v.jsx("br",{}),v.jsx("span",{className:"text-red-500/80 text-xs font-bold mt-1 block",children:"All tasks in this board will be lost."})]}),v.jsxs("div",{className:"flex gap-3 w-full",children:[v.jsx("button",{onClick:()=>A(null),className:"flex-1 py-3 bg-slate-200 dark:bg-white/10 hover:bg-slate-300 dark:hover:bg-white/20 rounded-xl text-slate-800 dark:text-white font-semibold transition-colors",children:"Cancel"}),v.jsx("button",{onClick:W,className:"flex-1 py-3 bg-red-600 hover:bg-red-500 rounded-xl text-white font-bold shadow-lg shadow-red-500/20 transition-colors border border-red-400/20",children:"Delete"})]})]})})]})]})},z5=({tasks:t,isOpen:e,onClose:n,onUpdateTask:r,onBatchUpdateTasks:i,onEditTask:s})=>{const[o,a]=L.useState([]),[u,c]=L.useState([]),[h,f]=L.useState(!1),[m,g]=L.useState(!1),[b,I]=L.useState(null),[P,y]=L.useState({x:0,y:0}),[_,T]=L.useState({x:0,y:0}),[C,F]=L.useState({width:0,height:0}),[j,E]=L.useState(null),w=L.useRef(null),k=L.useRef(null),A=L.useRef(new Map),R=L.useRef(null),N=L.useRef([]),S=L.useRef({active:!1,id:null,lastPointerY:0,startPointerPos:null,hasMoved:!1}),O=L.useRef(0);L.useEffect(()=>{if(!h&&!m){const $=[...t].sort((ne,de)=>de.size-ne.size);a($.filter(ne=>!ne.completed)),c($.filter(ne=>ne.completed))}},[t,e,h,m]);const Z=()=>{if(w.current){const $=new Map;Array.from(w.current.children).forEach(ne=>{const de=ne,ae=de.dataset.taskId;ae&&$.set(ae,de.getBoundingClientRect())}),A.current=$}};L.useLayoutEffect(()=>{if(!w.current)return;Array.from(w.current.children).forEach(ne=>{const de=ne.dataset.taskId;if(!de||de===b||de===R.current)return;const ae=A.current.get(de);if(!ae)return;const ge=ne.getBoundingClientRect(),Me=ae.top-ge.top;Me!==0&&(ne.style.transform=`translateY(${Me}px)`,ne.style.transition="none",ne.offsetHeight,requestAnimationFrame(()=>{ne.style.transform="",ne.style.transition="transform 400ms cubic-bezier(0.2, 0.8, 0.2, 1)"}))}),R.current&&(R.current=null)},[o,b]);const H=L.useCallback(()=>{if(!S.current.active||!k.current||!S.current.hasMoved)return;const{lastPointerY:$}=S.current,ne=k.current,{top:de,bottom:ae,height:ge}=ne.getBoundingClientRect(),Me=Math.max(80,ge*.2);let U=0;$<de+Me?U=-1*(4+(de+Me-$)/Me*16):$>ae-Me&&(U=4+($-(ae-Me))/Me*16),U!==0&&(ne.scrollTop+=U),O.current=requestAnimationFrame(H)},[]),ee=($,ne)=>{if(ne.completed)return;const de=$.target;if(de.closest("button")||$.pointerType==="touch"&&!de.closest(".drag-handle"))return;const ge=$.currentTarget;ge.setPointerCapture($.pointerId);const Me=ge.getBoundingClientRect();S.current={active:!0,id:ne.id,lastPointerY:$.clientY,startPointerPos:{x:$.clientX,y:$.clientY},hasMoved:!1},f(!1),N.current=[...o],I(ne.id),F({width:Me.width,height:Me.height}),T({x:$.clientX-Me.left,y:$.clientY-Me.top}),y({x:$.clientX,y:$.clientY}),window.addEventListener("pointermove",B),window.addEventListener("pointerup",W),window.addEventListener("pointercancel",W)},B=L.useCallback($=>{if(!S.current.active)return;const ne=S.current.startPointerPos;if(ne&&!S.current.hasMoved){const de=$.clientX-ne.x,ae=$.clientY-ne.y;Math.hypot(de,ae)>8&&(S.current.hasMoved=!0,f(!0),Z(),O.current=requestAnimationFrame(H))}if(S.current.hasMoved&&($.preventDefault(),y({x:$.clientX,y:$.clientY}),S.current.lastPointerY=$.clientY,w.current)){const de=S.current.id,ae=Array.from(w.current.children),ge=ae.filter(xe=>xe.dataset.taskId!==de);let Me=ge.length;for(let xe=0;xe<ge.length;xe++){const qe=ge[xe].getBoundingClientRect();if($.clientY<qe.top+qe.height/2){Me=xe;break}}const U=N.current,me=[...U.filter(xe=>xe.id!==de)],fe=U.find(xe=>xe.id===de);if(fe&&(me.splice(Me,0,fe),me.some((xe,Ce)=>{var qe;return xe.id!==((qe=U[Ce])==null?void 0:qe.id)}))){const xe=new Map;ae.forEach(Ce=>{Ce.dataset.taskId&&xe.set(Ce.dataset.taskId,Ce.getBoundingClientRect())}),A.current=xe,N.current=me,a(me)}}},[H]),K=L.useCallback(()=>{if(w.current){const ne=new Map;Array.from(w.current.children).forEach(de=>{const ae=de,ge=ae.dataset.taskId;ge&&ne.set(ge,ae.getBoundingClientRect())}),A.current=ne}let $=N.current;if(i){const ne=$.length;$=$.map((de,ae)=>({...de,size:ne===1?gs:Math.round(gs-ae/(ne-1)*(gs-Co))})),i($)}a($),R.current=S.current.id,f(!1),g(!1),I(null),E(null),S.current.active=!1},[i]),W=L.useCallback(()=>{var de;const $=S.current.hasMoved,ne=S.current.id;if(cancelAnimationFrame(O.current),window.removeEventListener("pointermove",B),window.removeEventListener("pointerup",W),window.removeEventListener("pointercancel",W),!!S.current.active)if($){const ae=(de=w.current)==null?void 0:de.querySelector(`[data-task-id="${ne}"]`);if(ae){const ge=ae.getBoundingClientRect();E({x:ge.left,y:ge.top}),g(!0),setTimeout(K,250)}else K()}else f(!1),I(null),S.current.active=!1},[K,B]),X=($,ne)=>{if(!$.subtasks)return;const de=$.subtasks.map(ae=>ae.id===ne?{...ae,completed:!ae.completed}:ae);r({...$,subtasks:de})},se=$=>{const ne=Math.max(4,Math.min(24,4+($.size-Co)/(gs-Co)*20)),de=$.subtasks||[];return v.jsxs("div",{className:`relative flex flex-col p-4 bg-white/40 dark:bg-slate-900/40 backdrop-blur-xl border border-white/40 dark:border-white/10 rounded-2xl overflow-hidden shadow-sm transition-all ${$.completed?"opacity-60":""}`,children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:"h-6 flex items-center justify-center shrink-0",children:v.jsx("button",{onClick:ae=>{ae.stopPropagation(),r({...$,completed:!$.completed})},className:`transition-all duration-300 ${$.completed?"text-green-500 scale-100":"text-slate-300 hover:text-slate-500 hover:scale-110 active:scale-90"}`,children:$.completed?v.jsx(lE,{size:22}):v.jsx(hE,{size:22})})}),v.jsx("div",{className:"flex-1 min-w-0 flex flex-col gap-0.5 select-none",children:v.jsx("h3",{className:`font-semibold text-[15px] font-medium leading-6 truncate ${$.completed?"text-slate-400 line-through":"text-slate-900 dark:text-white/90"}`,children:$.title||"Untitled Task"})}),v.jsxs("div",{className:"flex items-center gap-3 pl-2 shrink-0",children:[v.jsx("div",{className:"rounded-full border border-slate-50 dark:border-white/5",style:{width:`${ne}px`,height:`${ne}px`,background:$.color,opacity:$.completed?.3:.9,boxShadow:$.completed?"none":`0 0 12px ${$.color}50`}}),!$.completed&&v.jsx("div",{className:"drag-handle text-slate-300 dark:text-slate-600 cursor-grab active:cursor-grabbing p-2 -mr-2 touch-none",children:v.jsx(wC,{size:20})})]})]}),de.length>0&&!$.completed&&v.jsx("div",{className:"mt-3 ml-10 flex flex-col gap-1.5 border-l-2 border-slate-200 dark:border-white/10 pl-3",children:de.map(ae=>v.jsxs("div",{onClick:ge=>{ge.stopPropagation(),X($,ae.id)},className:"flex items-center gap-2.5 group/sub cursor-pointer hover:bg-white/10 p-1 -ml-1 rounded-md transition-colors",children:[v.jsx("div",{className:`w-3.5 h-3.5 rounded-sm border flex items-center justify-center transition-colors ${ae.completed?"bg-slate-400 border-slate-400 dark:bg-slate-500 dark:border-slate-500":"border-slate-300 dark:border-white/30"}`,children:ae.completed&&v.jsx(kp,{size:10,className:"text-white",strokeWidth:3})}),v.jsx("span",{className:`text-xs truncate transition-all ${ae.completed?"text-slate-400 line-through":"text-slate-600 dark:text-slate-300"}`,children:ae.title})]},ae.id))})]})},ye=o.find($=>$.id===b);return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:`fixed inset-0 bg-slate-200/40 dark:bg-black/40 backdrop-blur-[2px] z-[60] transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:n}),v.jsxs("div",{className:`fixed top-0 right-0 h-full w-full sm:w-[420px] shadow-2xl z-[70] transform transition-transform duration-500 cubic-bezier(0.16, 1, 0.3, 1) flex flex-col bg-white/40 dark:bg-slate-900/30 backdrop-blur-3xl border-l border-white/60 dark:border-white/10 ${e?"translate-x-0":"translate-x-full"}`,children:[v.jsxs("div",{className:"relative px-6 py-6 border-b border-slate-200 dark:border-white/10 flex items-center gap-4 bg-white/20 dark:bg-white/[0.02]",children:[v.jsx("button",{onClick:n,className:`${qa} rounded-full w-10 h-10 -ml-2 border-0 bg-transparent dark:bg-transparent hover:bg-white/40 dark:hover:bg-white/10`,children:v.jsx(gC,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white/90",children:"Prioritize Tasks"}),v.jsx("p",{className:"text-[10px] text-slate-500 dark:text-white/40 font-medium",children:"Drag the handle to reorder"})]}),v.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-bold border bg-white/20 text-slate-500",children:o.length})]}),v.jsxs("div",{ref:k,className:"relative flex-1 overflow-y-auto p-4 custom-scrollbar",children:[v.jsxs("div",{ref:w,className:"space-y-2 pb-24 min-h-[50px]",children:[o.map($=>v.jsx("div",{"data-task-id":$.id,onPointerDown:ne=>ee(ne,$),className:`task-row group cursor-grab active:cursor-grabbing transition-transform ${$.id===b&&h?"opacity-0 pointer-events-none":"opacity-100 hover:scale-[1.01]"}`,onClick:()=>{h||(s($),n())},children:se($)},$.id)),o.length===0&&v.jsxs("div",{className:"h-64 flex flex-col items-center justify-center text-slate-300 opacity-60",children:[v.jsx(uE,{size:32,strokeWidth:1.5}),v.jsx("p",{className:"text-xs font-bold tracking-widest mt-3",children:"All Clear"})]})]}),u.length>0&&v.jsxs("div",{className:"mt-6 mb-8",children:[v.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[v.jsx("div",{className:"h-px bg-slate-200 flex-1"}),v.jsx("span",{className:"text-slate-400 text-[10px] font-bold tracking-widest uppercase",children:"Done"}),v.jsx("div",{className:"h-px bg-slate-200 flex-1"})]}),v.jsx("div",{className:"space-y-2 opacity-60 hover:opacity-100 transition-all",children:u.map($=>v.jsx("div",{className:"cursor-pointer",onClick:()=>{s($),n()},children:se($)},$.id))})]})]})]}),h&&ye&&Dx.createPortal(v.jsx("div",{className:"fixed z-[100] pointer-events-none",style:{top:0,left:0,width:C.width,height:C.height,transition:m?"transform 0.25s":"none",transform:m&&j?`translate(${j.x}px, ${j.y}px)`:`translate(${P.x-_.x}px, ${P.y-_.y}px) scale(1.05) rotate(1deg)`},children:v.jsx("div",{className:"shadow-2xl rounded-2xl overflow-hidden ring-1 ring-white/10",children:se(ye)})}),document.body)]})},U5=()=>{const[t,e]=L.useState(()=>{try{const U=localStorage.getItem("tasks");return U?JSON.parse(U):[]}catch{return[]}}),[n,r]=L.useState(()=>{try{const U=localStorage.getItem("boards");return U?JSON.parse(U):[{id:"1",name:"Main To-Do"},{id:"2",name:"Ideas"}]}catch{return[{id:"1",name:"Main To-Do"},{id:"2",name:"Ideas"}]}}),[i,s]=L.useState(()=>localStorage.getItem("currentBoardId")||"1"),[o,a]=L.useState(null),[u,c]=L.useState(!1),[h,f]=L.useState(!1),[m,g]=L.useState(!1),[b,I]=L.useState(!1),[P,y]=L.useState(null),[_,T]=L.useState(null),C=L.useRef(t),F=L.useRef(n),j=L.useRef(null),E=L.useRef(null),w=L.useRef(!1),[k,A]=L.useState(()=>{const U=localStorage.getItem("theme");return U==="light"||U==="dark"?U:"light"});L.useEffect(()=>{localStorage.setItem("tasks",JSON.stringify(t)),C.current=t},[t]),L.useEffect(()=>{localStorage.setItem("boards",JSON.stringify(n)),F.current=n},[n]),L.useEffect(()=>{localStorage.setItem("currentBoardId",i)},[i]),L.useEffect(()=>{localStorage.setItem("theme",k)},[k]),L.useEffect(()=>{const U=window.document.documentElement;k==="dark"?U.classList.add("dark"):U.classList.remove("dark")},[k]),L.useEffect(()=>{let U,me,fe;const xe=xf.onAuthStateChanged(async Ce=>{if(Ce){const qe={id:Ce.uid,name:Ce.displayName||"User",email:Ce.email||"",avatarUrl:Ce.photoURL||void 0};T(qe);const dt=C.current,ft=F.current,_t=dt.length===5&&dt.some(ot=>ot.title==="Hold to Pop");await Yn.migrateAllLocalData(Ce.uid,_t?[]:dt,ft,k),U=Yn.syncTasks(Ce.uid,ot=>{e(ot)}),me=Yn.syncBoards(Ce.uid,ot=>{ot.length>0&&r(ot)}),fe=Yn.syncPreferences(Ce.uid,ot=>{ot&&ot.theme&&A(ot.theme)})}else T(null),U&&U(),me&&me(),fe&&fe()});return()=>{xe(),U&&U(),me&&me(),fe&&fe()}},[]),L.useEffect(()=>{i==="ALL"||i==="COMPLETED"||n.length>0&&!n.find(U=>U.id===i)&&s(n[0].id)},[n,i]);const R=async()=>{try{await xf.signInWithGoogle()}catch(U){console.error("Sign in failed",U)}},N=async()=>{try{await xf.signOut(),window.location.reload()}catch(U){console.error("Sign out failed",U)}},S=()=>{const U=k==="dark"?"light":"dark";A(U),_&&Yn.savePreference(_.id,"theme",U)};L.useEffect(()=>{const U=ft=>{const _t=t.find(ot=>ot.id===ft);if(_t){if(_t.boardId!==i&&i!=="ALL"&&i!=="COMPLETED"){const ot=n.some(rn=>rn.id===_t.boardId);s(ot?_t.boardId:"ALL")}_t.completed&&i!=="COMPLETED"&&c(!0),g(!1),f(!1),a(ft)}},me=ft=>{const _t=t.find(ot=>ot.id===ft);_t&&!_t.completed&&(H({..._t,completed:!0}),Nr.playPop(),_t.boardId!==i&&i!=="ALL"&&s(_t.boardId),c(!0))},fe=new URLSearchParams(window.location.search),xe=fe.get("highlight"),Ce=fe.get("action"),qe=fe.get("taskId");Ce==="complete"&&qe?(me(qe),window.history.replaceState({},"",window.location.pathname)):xe&&(U(xe),window.history.replaceState({},"",window.location.pathname));const dt=ft=>{ft.data&&ft.data.type==="HIGHLIGHT_TASK"&&ft.data.taskId?U(ft.data.taskId):ft.data&&ft.data.type==="COMPLETE_TASK"&&ft.data.taskId&&me(ft.data.taskId)};return"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",dt),()=>{"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("message",dt)}},[t,n,i]),L.useEffect(()=>{const U=setInterval(()=>{Ho.checkAndNotify(t)},3e4);return Ho.checkAndNotify(t),()=>clearInterval(U)},[t]),L.useEffect(()=>{const U=me=>{var qe,dt;if(!b)return;const fe=me.target,xe=(qe=j.current)==null?void 0:qe.contains(fe),Ce=(dt=E.current)==null?void 0:dt.contains(fe);!xe&&!Ce&&I(!1)};return b&&document.addEventListener("pointerdown",U,!0),()=>document.removeEventListener("pointerdown",U,!0)},[b]),L.useEffect(()=>{!localStorage.getItem("app_initialized_v3")&&t.length===0&&(e([{id:"1",boardId:"1",title:"Hold to Pop",subtasks:[],color:ui[0],size:110,completed:!1},{id:"2",boardId:"1",title:"Tap to Edit",subtasks:[],color:ui[4],size:95,completed:!1},{id:"3",boardId:"1",title:`Pinch / Scroll
to Zoom`,subtasks:[],color:ui[5],size:80,completed:!1},{id:"4",boardId:"1",title:`+
Add Tasks`,subtasks:[],color:ui[3],size:70,completed:!1},{id:"5",boardId:"1",title:`Drag to
Organize`,subtasks:[],color:ui[1],size:45,completed:!1}]),localStorage.setItem("app_initialized_v3","true"))},[]);const O=L.useMemo(()=>i==="COMPLETED"?t.filter(U=>U.completed):i==="ALL"?t:t.filter(U=>U.boardId===i),[t,i]),Z=()=>{var fe;let U=i;(i==="ALL"||i==="COMPLETED")&&(U=((fe=n[0])==null?void 0:fe.id)||"1");const me={id:gp(),boardId:U,title:"",subtasks:[],color:ui[Math.floor(Math.random()*ui.length)],size:60,completed:!1,x:window.innerWidth/2,y:window.innerHeight/2};e(xe=>[...xe,me]),a(me.id),_&&Yn.saveTask(_.id,me)},H=U=>{if(!U){a(null);return}if(U.boardId!==i&&i!=="ALL"&&i!=="COMPLETED"){const me=n.find(fe=>fe.id===U.boardId);me&&s(me.id)}e(me=>me.map(fe=>fe.id===U.id?U:fe)),_&&Yn.saveTask(_.id,U)},ee=U=>{e(me=>{const fe=new Map(U.map(xe=>[xe.id,xe]));return me.map(xe=>fe.has(xe.id)?fe.get(xe.id):xe)}),_&&Yn.saveTasksBatch(_.id,U)},B=U=>{e(me=>me.filter(fe=>fe.id!==U)),o===U&&a(null),_&&Yn.deleteTask(_.id,U)},K=U=>{H({...U,completed:!U.completed})},W=U=>{const me={id:gp(),name:U};r(fe=>[...fe,me]),s(me.id),_&&Yn.saveBoard(_.id,me)},X=U=>{const me=t.filter(fe=>fe.boardId===U).map(fe=>fe.id);r(fe=>fe.filter(xe=>xe.id!==U)),e(fe=>fe.filter(xe=>xe.boardId!==U)),_&&Yn.deleteBoard(_.id,U,me)},se=()=>{var U;return i==="ALL"?"All Tasks":i==="COMPLETED"?"Completed Tasks":((U=n.find(me=>me.id===i))==null?void 0:U.name)||"Unknown Board"},ye=L.useRef(null),$=L.useRef(!1),ne=U=>{w.current=b,I(!0),ye.current={x:U.clientX,y:U.clientY},$.current=!1,U.currentTarget.setPointerCapture(U.pointerId)},de=U=>{if(!ye.current)return;const me=U.clientX-ye.current.x,fe=U.clientY-ye.current.y;if(!$.current&&Math.hypot(me,fe)>10&&($.current=!0),$.current){const Ce=document.elementsFromPoint(U.clientX,U.clientY).find(qe=>qe.dataset.boardId);y(Ce&&Ce.dataset.boardId||null)}},ae=U=>{$.current&&P&&(s(P),I(!1)),ye.current=null,$.current=!1,y(null);try{U.currentTarget.releasePointerCapture(U.pointerId)}catch{}},ge=U=>{$.current||w.current&&I(!1)},Me=L.useMemo(()=>t.find(U=>U.id===o)||null,[t,o]);return v.jsxs("div",{className:"w-screen h-[100dvh] relative bg-[#f1f5f9] dark:bg-[#020617] overflow-hidden select-none font-sans text-slate-900 dark:text-slate-200 transition-colors duration-500",children:[v.jsx(j5,{isOpen:m,setIsOpen:g,boards:n,currentBoardId:i,onSelectBoard:U=>{s(U),c(!1)},onCreateBoard:W,onDeleteBoard:X,isHidden:!!o,theme:k,onToggleTheme:S,user:_,onSignIn:R,onSignOut:N}),v.jsx(MC,{tasks:O,activeTask:Me,boards:n,onEditTask:U=>{a(U?U.id:null),U&&H(U)},onAddTask:Z,onToggleComplete:K,onDeleteTask:B,selectedTaskId:o,showCompleted:i==="COMPLETED"||u,onToggleShowCompleted:()=>c(!u),isShowingCompleted:u,theme:k,hideTrash:i==="COMPLETED"}),v.jsx(z5,{tasks:O,isOpen:h,onClose:()=>f(!1),onUpdateTask:H,onBatchUpdateTasks:ee,onEditTask:U=>{a(U.id)}}),!o&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"absolute top-6 right-6 z-40 animate-in slide-in-from-top-10 fade-in duration-500",children:v.jsx("button",{onClick:()=>{f(!0),g(!1)},className:ah,title:"List View","aria-label":"Open list view",children:v.jsx(EC,{size:22})})}),v.jsx("div",{className:"absolute bottom-[max(3rem,calc(env(safe-area-inset-bottom)+2rem))] left-1/2 -translate-x-1/2 z-40 animate-in slide-in-from-bottom-10 fade-in duration-500",children:v.jsxs("div",{className:"relative",children:[v.jsx("div",{ref:j,role:"menu","aria-label":"Select board",className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-3 w-48 rounded-2xl overflow-hidden transition-all duration-300 origin-bottom pointer-events-none ${xs}
                        ${b?"opacity-100 scale-100 translate-y-0 pointer-events-auto":"opacity-0 scale-90 translate-y-4"}`,children:v.jsxs("div",{className:"p-1.5 flex flex-col gap-0.5",children:[n.map(U=>v.jsx("button",{"data-board-id":U.id,role:"menuitem",onClick:me=>{me.stopPropagation(),s(U.id),I(!1)},className:`${Pr} justify-center ${i===U.id||P===U.id?Es:Cr}`,children:U.name},U.id)),v.jsx("div",{className:"h-px bg-slate-200 dark:bg-white/10 my-1 mx-2"}),v.jsx("button",{"data-board-id":"ALL",role:"menuitem",onClick:U=>{U.stopPropagation(),s("ALL"),I(!1),c(!1)},className:`${Pr} justify-center ${i==="ALL"||P==="ALL"?Es:Cr}`,children:"All Tasks"}),v.jsx("button",{"data-board-id":"COMPLETED",role:"menuitem",onClick:U=>{U.stopPropagation(),s("COMPLETED"),I(!1)},className:`${Pr} justify-center ${i==="COMPLETED"||P==="COMPLETED"?Es:Cr}`,children:"Completed"})]})}),v.jsx("button",{ref:E,onPointerDown:ne,onPointerMove:de,onPointerUp:ae,onClick:ge,"aria-haspopup":"menu","aria-expanded":b,className:`px-6 py-2.5 rounded-full backdrop-blur-xl border shadow-lg flex items-center justify-center gap-2 min-w-[140px] transition-all hover:scale-105 active:scale-95 touch-none
                        ${b?"bg-white/60 dark:bg-slate-800/60 border-white/60 dark:border-white/20":"bg-white/30 dark:bg-slate-900/40 border-white/40 dark:border-white/10 hover:bg-white/50 dark:hover:bg-slate-900/60"}`,children:v.jsx("span",{className:"text-sm font-bold text-slate-800 dark:text-white leading-none whitespace-nowrap shadow-sm",children:se()})})]})})]})]})};If.createRoot(document.getElementById("root")).render(v.jsx(BS.StrictMode,{children:v.jsx(U5,{})}));
